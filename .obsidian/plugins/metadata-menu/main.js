/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __defProps = Object.defineProperties;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropDescs = Object.getOwnPropertyDescriptors;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getOwnPropSymbols = Object.getOwnPropertySymbols;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __propIsEnum = Object.prototype.propertyIsEnumerable;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues = (a, b) => {
  for (var prop in b || (b = {}))
    if (__hasOwnProp.call(b, prop))
      __defNormalProp(a, prop, b[prop]);
  if (__getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(b)) {
      if (__propIsEnum.call(b, prop))
        __defNormalProp(a, prop, b[prop]);
    }
  return a;
};
var __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));
var __objRest = (source, exclude) => {
  var target = {};
  for (var prop in source)
    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)
      target[prop] = source[prop];
  if (source != null && __getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(source)) {
      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))
        target[prop] = source[prop];
    }
  return target;
};
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MetadataMenu
});
module.exports = __toCommonJS(main_exports);
var import_obsidian19 = require("obsidian");

// src/settings/MetadataMenuSettingTab.ts
var import_obsidian3 = require("obsidian");

// src/settings/FieldSettingsModal.ts
var import_obsidian2 = require("obsidian");

// src/Field.ts
var Field = class {
  constructor(name = "", values = {}, id = "", isMulti = false, isCycle = false, isBoolean2 = false, valuesListNotePath = "") {
    this.name = name;
    this.values = values;
    this.id = id;
    this.isBoolean = isBoolean2;
    this.isCycle = isCycle;
    this.isMulti = isMulti;
    this.valuesListNotePath = valuesListNotePath;
    this.insertNewValue.bind(this);
  }
  insertNewValue(value) {
    return __async(this, null, function* () {
      let newKey = 1;
      Object.keys(this.values).forEach((key) => {
        if (parseInt(key) && parseInt(key) >= newKey) {
          newKey = parseInt(key) + 1;
        }
        ;
      });
      this.values[newKey.toString()] = value;
      return newKey.toString();
    });
  }
  static copyProperty(target, source) {
    target.id = source.id;
    target.name = source.name;
    target.isBoolean = source.isBoolean;
    target.isCycle = source.isCycle;
    target.isMulti = source.isMulti;
    target.valuesListNotePath = source.valuesListNotePath;
    Object.keys(source.values).forEach((k) => {
      target.values[k] = source.values[k];
    });
    Object.keys(target.values).forEach((k) => {
      if (!Object.keys(source.values).includes(k)) {
        delete target.values[k];
      }
      ;
    });
  }
};
var Field_default = Field;

// src/settings/FieldSetting.ts
var import_obsidian = require("obsidian");
var FieldSetting = class extends import_obsidian.Setting {
  constructor(containerEl, property, app2, plugin) {
    super(containerEl);
    this.containerEl = containerEl;
    this.property = property;
    this.app = app2;
    this.plugin = plugin;
    this.setTextContentWithname();
    this.addEditButton();
    this.addDeleteButton();
  }
  setTextContentWithname() {
    const values = !this.property.isBoolean ? `[${Object.keys(this.property.values).map((k) => this.property.values[k]).join(", ")}]` : "";
    let type = "single";
    if (this.property.isBoolean)
      type = "boolean";
    if (this.property.isMulti)
      type = "multi";
    if (this.property.isCycle)
      type = "cycle";
    this.infoEl.textContent = `${this.property.name}: ${values}`;
    const typeContainer = this.infoEl.createEl("span", `metadata-menu-setting-item-info-type ${type}`);
    typeContainer.setText(type);
  }
  addEditButton() {
    this.addButton((b) => {
      b.setIcon("pencil").setTooltip("Edit").onClick(() => {
        let modal = new FieldSettingsModal(this.app, this.plugin, this.containerEl, this, this.property);
        modal.open();
      });
    });
  }
  addDeleteButton() {
    this.addButton((b) => {
      b.setIcon("trash").setTooltip("Delete").onClick(() => {
        var _a;
        const currentExistingProperty = this.plugin.initialProperties.filter((p) => p.id == this.property.id)[0];
        if (currentExistingProperty) {
          this.plugin.initialProperties.remove(currentExistingProperty);
        }
        ;
        (_a = this.settingEl.parentElement) == null ? void 0 : _a.removeChild(this.settingEl);
        this.plugin.saveSettings();
      });
    });
  }
  static getValuesListFromNote(notePath, app2) {
    return __async(this, null, function* () {
      let values = [];
      const file = app2.vault.getAbstractFileByPath(notePath);
      if (file instanceof import_obsidian.TFile && file.extension == "md") {
        const result = yield app2.vault.read(file);
        result.split("\n").forEach((line) => {
          if (/^(.*)$/.test(line)) {
            values.push(line.trim());
          }
          ;
        });
        return values;
      } else {
        return [];
      }
      ;
    });
  }
};

// src/settings/FieldSettingsModal.ts
var FieldSettingsModal = class extends import_obsidian2.Modal {
  constructor(app2, plugin, parentSettingContainer, parentSetting, property) {
    super(app2);
    this.valuesPromptComponents = [];
    this.saved = false;
    this.new = true;
    this.plugin = plugin;
    this.parentSetting = parentSetting;
    this.initialProperty = new Field_default();
    this.parentSettingContainer = parentSettingContainer;
    if (property) {
      this.new = false;
      this.property = property;
      this.initialProperty.name = property.name;
      this.initialProperty.id = property.id;
      Object.keys(property.values).forEach((k) => {
        this.initialProperty.values[k] = property.values[k];
      });
    } else {
      let newId = 1;
      this.plugin.initialProperties.forEach((prop) => {
        if (parseInt(prop.id) && parseInt(prop.id) >= newId) {
          newId = parseInt(prop.id) + 1;
        }
        ;
      });
      this.property = new Field_default();
      this.property.id = newId.toString();
      this.initialProperty.id = newId.toString();
    }
    ;
  }
  onOpen() {
    return __async(this, null, function* () {
      if (this.property.name == "") {
        this.titleEl.setText(`Add a property and set predefined`);
      } else {
        this.titleEl.setText(`Manage settings values for ${this.property.name}`);
      }
      ;
      yield this.createForm();
    });
  }
  onClose() {
    Object.assign(this.property, this.initialProperty);
    if (!this.new && this.parentSetting) {
      this.parentSetting.infoEl.textContent = `${this.property.name}: [${Object.keys(this.property.values).map((k) => this.property.values[k]).join(", ")}]`;
    } else if (this.saved) {
      new FieldSetting(this.parentSettingContainer, this.property, this.app, this.plugin);
    }
    ;
  }
  setValueListText(header) {
    header.setText(`Preset values: ${Object.values(this.property.values).join(", ")}`);
  }
  createnameInputContainer(parentNode) {
    const propertyNameContainerLabel = parentNode.createDiv();
    propertyNameContainerLabel.setText(`Property Name:`);
    const input = new import_obsidian2.TextComponent(parentNode);
    const name = this.property.name;
    input.setValue(name);
    input.setPlaceholder("Name of the property");
    input.onChange((value) => {
      this.property.name = value;
      this.titleEl.setText(`Manage predefined values for ${this.property.name}`);
      FieldSettingsModal.removeValidationError(input);
    });
    return input;
  }
  createTogglerContainer(parentNode, label) {
    parentNode.addClass("metadata-menu-toggle");
    const propertyContainerLabel = parentNode.createDiv({ cls: "frontmatter-checkbox-toggler" });
    propertyContainerLabel.setText(label);
    const toggler = new import_obsidian2.ToggleComponent(parentNode);
    return toggler;
  }
  createListNoteContainer(parentNode) {
    const listNoteContainerLabel = parentNode.createDiv({ cls: "metadata-menu-input" });
    listNoteContainerLabel.setText(`Path of the note containing the values:`);
    const input = new import_obsidian2.TextComponent(listNoteContainerLabel);
    const listNotePath = this.property.valuesListNotePath;
    input.setValue(listNotePath);
    input.setPlaceholder("Path/of/the/note.md");
    input.onChange((value) => this.property.valuesListNotePath = value);
    return input;
  }
  removePresetValue(key) {
    let newValues = {};
    for (let _key in this.property.values) {
      if (key !== _key) {
        newValues[_key] = this.property.values[_key];
      }
      ;
    }
    ;
    this.property.values = newValues;
  }
  createValueContainer(parentNode, header, key) {
    const values = this.property.values;
    const presetValue = values[key];
    const valueContainer = parentNode.createDiv({
      cls: "metadata-menu-prompt-container"
    });
    const input = new import_obsidian2.TextComponent(valueContainer);
    input.setValue(presetValue);
    input.onChange((value) => {
      this.property.values[key] = value;
      this.setValueListText(header);
      FieldSettingsModal.removeValidationError(input);
    });
    const valueRemoveButton = new import_obsidian2.ButtonComponent(valueContainer);
    valueRemoveButton.setIcon("trash").onClick((evt) => {
      evt.preventDefault;
      this.removePresetValue(key);
      this.setValueListText(header);
      parentNode.removeChild(valueContainer);
      this.valuesPromptComponents.remove(input);
    });
    if (key != Object.keys(this.property.values)[0]) {
      const valueUpgradeButton = new import_obsidian2.ButtonComponent(valueContainer);
      valueUpgradeButton.setButtonText("\u25B2");
      valueUpgradeButton.onClick((evt) => {
        const thisValue = values[key];
        const inputIndex = this.valuesPromptComponents.indexOf(input);
        const upperComponent = inputIndex !== -1 ? this.valuesPromptComponents[inputIndex - 1] : this.valuesPromptComponents.last();
        if (upperComponent) {
          const upperValue = upperComponent.inputEl.value;
          const upperKey = Object.keys(values).filter((k) => values[k] == upperValue)[0];
          if (upperKey) {
            upperComponent.setValue(thisValue);
            values[upperKey] = thisValue;
            input.setValue(upperValue);
            values[key] = upperValue;
          }
          ;
        }
        ;
      });
    }
    ;
    return input;
  }
  createForm() {
    return __async(this, null, function* () {
      const div = this.contentEl.createDiv({
        cls: "metadata-menu-prompt-div"
      });
      const mainDiv = div.createDiv({
        cls: "metadata-menu-prompt-form"
      });
      const nameContainer = mainDiv.createDiv();
      this.namePromptComponent = this.createnameInputContainer(nameContainer);
      mainDiv.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
      const booleanContainer = mainDiv.createDiv({ cls: "metadata-menu-toggle" });
      this.isBooleanTogglerComponent = this.createTogglerContainer(booleanContainer, "Is Boolean: ");
      this.isBooleanTogglerComponent.setValue(this.property.isBoolean);
      this.isBooleanTogglerComponent.setTooltip("Is this property true or false only?");
      this.isBooleanTogglerComponent.onChange((value) => {
        this.property.isBoolean = value;
        if ((this.property.isMulti || this.property.isCycle) && this.property.isBoolean) {
          this.property.isMulti = false;
          this.isMultiTogglerComponent.setValue(false);
          this.property.isCycle = false;
          this.isCycleTogglerComponent.setValue(false);
        }
      });
      const multiContainer = mainDiv.createDiv({ cls: "metadata-menu-toggle" });
      this.isMultiTogglerComponent = this.createTogglerContainer(multiContainer, "Is Multi: ");
      this.isMultiTogglerComponent.setValue(this.property.isMulti);
      this.isMultiTogglerComponent.setTooltip("Can this property have multiple values?");
      this.isMultiTogglerComponent.onChange((value) => {
        this.property.isMulti = value;
        if (this.property.isCycle && this.property.isMulti) {
          this.property.isCycle = false;
          this.isCycleTogglerComponent.setValue(false);
        }
        ;
      });
      const cycleContainer = mainDiv.createDiv();
      this.isCycleTogglerComponent = this.createTogglerContainer(cycleContainer, "Is Cycle: ");
      this.isCycleTogglerComponent.setValue(this.property.isCycle);
      this.isCycleTogglerComponent.setTooltip("Is this property's values set in cycle mode?");
      this.isCycleTogglerComponent.onChange((value) => {
        this.property.isCycle = value;
        if (this.property.isCycle && this.property.isMulti) {
          this.property.isMulti = false;
          this.isMultiTogglerComponent.setValue(false);
        }
        ;
      });
      mainDiv.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
      const listNotePathContainer = mainDiv.createDiv();
      this.createListNoteContainer(listNotePathContainer);
      mainDiv.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
      const valuesList = mainDiv.createDiv();
      const valuesListHeader = valuesList.createDiv();
      valuesListHeader.createEl("h2");
      valuesListHeader.setText(`Preset values: ${Object.values(this.property.values).join(", ")}`);
      const valuesListBody = valuesList.createDiv();
      Object.keys(this.property.values).forEach((key) => {
        this.valuesPromptComponents.push(this.createValueContainer(valuesListBody, valuesListHeader, key));
      });
      const valuesListFooter = valuesList.createDiv();
      const addValue = valuesListFooter.createEl("button");
      addValue.type = "button";
      addValue.textContent = "Add";
      addValue.onClickEvent((evt) => __async(this, null, function* () {
        evt.preventDefault;
        const newKey = yield this.property.insertNewValue("");
        this.createValueContainer(valuesListBody, valuesListHeader, newKey);
      }));
      mainDiv.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
      const footerEl = this.contentEl.createDiv();
      const footerButtons = new import_obsidian2.Setting(footerEl);
      footerButtons.addButton((b) => this.createSaveButton(b));
      footerButtons.addExtraButton((b) => this.createCancelButton(b));
    });
  }
  createSaveButton(b) {
    b.setTooltip("Save").setIcon("checkmark").onClick(() => __async(this, null, function* () {
      let error = false;
      if (/^[#>-]/.test(this.property.name)) {
        FieldSettingsModal.setValidationError(this.namePromptComponent, this.namePromptComponent.inputEl, "Property name cannot start with #, >, -");
        error = true;
      }
      ;
      if (this.property.name == "") {
        FieldSettingsModal.setValidationError(this.namePromptComponent, this.namePromptComponent.inputEl, "Property name can not be Empty");
        error = true;
      }
      ;
      this.valuesPromptComponents.forEach((input) => {
        var _a, _b, _c;
        if (/^[#>-]/.test(input.inputEl.value) && ((_a = input.inputEl.parentElement) == null ? void 0 : _a.lastElementChild)) {
          FieldSettingsModal.setValidationError(input, input.inputEl.parentElement.lastElementChild, "Values cannot cannot start with #, >, -");
          error = true;
        }
        ;
        if (/[,]/gu.test(input.inputEl.value) && ((_b = input.inputEl.parentElement) == null ? void 0 : _b.lastElementChild)) {
          FieldSettingsModal.setValidationError(input, input.inputEl.parentElement.lastElementChild, "Values cannot contain a comma");
          error = true;
        }
        ;
        if (input.inputEl.value == "" && ((_c = input.inputEl.parentElement) == null ? void 0 : _c.lastElementChild)) {
          FieldSettingsModal.setValidationError(input, input.inputEl.parentElement.lastElementChild, "Values can't be null.");
          error = true;
        }
        ;
      });
      if (error) {
        new import_obsidian2.Notice("Fix errors before saving.");
        return;
      }
      ;
      this.saved = true;
      const currentExistingProperty = this.plugin.initialProperties.filter((p) => p.id == this.property.id)[0];
      if (currentExistingProperty) {
        Field_default.copyProperty(currentExistingProperty, this.property);
      } else {
        this.plugin.initialProperties.push(this.property);
      }
      ;
      this.initialProperty = this.property;
      this.plugin.saveSettings();
      this.close();
    }));
    return b;
  }
  createCancelButton(b) {
    b.setIcon("cross").setTooltip("Cancel").onClick(() => {
      this.saved = false;
      if (this.initialProperty.name != "") {
        Object.assign(this.property, this.initialProperty);
      }
      ;
      this.close();
    });
    return b;
  }
  static setValidationError(textInput, insertAfter, message) {
    var _a;
    textInput.inputEl.addClass("is-invalid");
    if (message && ((_a = textInput.inputEl.parentElement) == null ? void 0 : _a.lastElementChild)) {
      let mDiv = textInput.inputEl.parentElement.querySelector(".invalid-feedback");
      if (!mDiv) {
        mDiv = createDiv({ cls: "invalid-feedback" });
      }
      mDiv.innerText = message;
      mDiv.insertAfter(insertAfter);
    }
  }
  static removeValidationError(textInput) {
    var _a;
    if (textInput.inputEl.hasClass("is-invalid") && ((_a = textInput.inputEl.parentElement) == null ? void 0 : _a.lastElementChild)) {
      textInput.inputEl.removeClass("is-invalid");
      textInput.inputEl.parentElement.removeChild(textInput.inputEl.parentElement.lastElementChild);
    }
    ;
  }
};

// src/settings/MetadataMenuSettingTab.ts
var SettingsMigrationConfirmModal = class extends import_obsidian3.Modal {
  constructor(plugin, tab) {
    super(plugin.app);
    this.plugin = plugin;
    this.tab = tab;
  }
  onOpen() {
    this.titleEl.setText("Confirm");
    const body = this.contentEl.createDiv({
      cls: "modal-text-danger"
    });
    body.setText("This will erase current settings. Are you sure?");
    const confirmButton = new import_obsidian3.ButtonComponent(this.contentEl);
    confirmButton.setIcon("check");
    confirmButton.onClick(() => {
      if (this.app.plugins.plugins.hasOwnProperty("supercharged-links-obsidian")) {
        let settings = this.app.plugins.plugins["supercharged-links-obsidian"].settings;
        let _settings = this.plugin.settings;
        _settings.classFilesPath = settings.classFilesPath;
        _settings.displayFieldsInContextMenu = settings.displayFieldsInContextMenu;
        _settings.getFromInlineField = settings.getFromInlineField;
        _settings.globallyIgnoredFields = settings.globallyIgnoredFields;
        this.plugin.initialProperties = [];
        settings.presetFields.forEach((prop) => {
          const property = new Field_default();
          Object.assign(property, prop);
          this.plugin.initialProperties.push(property);
        });
        this.plugin.saveSettings();
        this.close();
      }
      ;
    });
  }
  onClose() {
    this.tab.display();
  }
};
var MetadataMenuSettingTab = class extends import_obsidian3.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  display() {
    let { containerEl } = this;
    containerEl.empty();
    const globalSettings = containerEl.createEl("div");
    globalSettings.createEl("h4", { text: "Global settings", cls: "metadata-menu-setting-section-header" });
    globalSettings.createEl("div", {
      cls: "setting-item-description metadata-menu-setting-section-desc",
      text: "Global settings to apply to your whole vault"
    });
    new import_obsidian3.Setting(globalSettings).setName("Search for attribute in Inline fields like <field::>").setDesc("Sets the `data-link-<field>`-attribute to the value of inline fields").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.getFromInlineField);
      toggle.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.getFromInlineField = value;
        yield this.plugin.saveSettings();
      }));
    });
    new import_obsidian3.Setting(globalSettings).setName("Display field options in context menu").setDesc("Choose to show or hide fields options in the context menu of a link or a file").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.displayFieldsInContextMenu);
      toggle.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.displayFieldsInContextMenu = value;
        yield this.plugin.saveSettings();
      }));
    });
    new import_obsidian3.Setting(globalSettings).setName("Globally ignored fields").setDesc("Fields to be ignored by the plugin when adding options to the context menu").addTextArea((text) => {
      text.setPlaceholder("Enter fields as string, comma separated").setValue(this.plugin.settings.globallyIgnoredFields.join(", ")).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.globallyIgnoredFields = value.replace(/\s/g, "").split(",");
        yield this.plugin.saveSettings();
      }));
      text.inputEl.rows = 6;
      text.inputEl.cols = 25;
    });
    const presetFieldsSettings = containerEl.createEl("div");
    presetFieldsSettings.createEl("h4", { text: "Preset Fields settings", cls: "metadata-menu-setting-section-header" });
    presetFieldsSettings.createEl("div", {
      cls: "setting-item-description metadata-menu-setting-section-desc",
      text: "Manage globally predefined type and values for a field throughout your whole vault"
    });
    new import_obsidian3.Setting(presetFieldsSettings).setName("Add New Property Manager").setDesc("Add a new Frontmatter property for which you want preset values.").addButton((button) => {
      return button.setTooltip("Add New Property Manager").setButtonText("+").onClick(() => __async(this, null, function* () {
        let modal = new FieldSettingsModal(this.app, this.plugin, presetFieldsSettings);
        modal.open();
      }));
    });
    this.plugin.initialProperties.forEach((prop) => {
      const property = new Field_default();
      Object.assign(property, prop);
      new FieldSetting(presetFieldsSettings, property, this.app, this.plugin);
    });
    const classFilesSettings = containerEl.createEl("div");
    classFilesSettings.createEl("h4", { text: "FileClass settings", cls: "metadata-menu-setting-section-header" });
    classFilesSettings.createEl("div", {
      cls: "setting-item-description metadata-menu-setting-section-desc",
      text: "Manage fileClass folder and alias. When a note has a fielClass defined, fileClass field properties will override global preset fields settings for the same field name"
    });
    new import_obsidian3.Setting(classFilesSettings).setName("class Files path").setDesc("Path to the files containing the authorized fields for a type of note").addText((text) => {
      text.setPlaceholder("Path/").setValue(this.plugin.settings.classFilesPath).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.classFilesPath = value;
        yield this.plugin.saveSettings();
      }));
    });
    new import_obsidian3.Setting(classFilesSettings).setName("fileClass field alias").setDesc("Choose another name for fileClass field in frontmatter (example: Category, type, ...").addText((text) => {
      text.setValue(this.plugin.settings.fileClassAlias).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.fileClassAlias = value;
        yield this.plugin.saveSettings();
      }));
    });
    const migrateSettings = containerEl.createEl("div");
    migrateSettings.createEl("h4", { text: "Migrate" });
    new import_obsidian3.Setting(migrateSettings).setName("Copy settings from supercharged links plugin").setDesc("Copy settings from supercharged links plugin").addButton((button) => {
      return button.setTooltip("Get settings from supercharged links").setButtonText("Copy").onClick(() => __async(this, null, function* () {
        let modal = new SettingsMigrationConfirmModal(this.plugin, this);
        modal.open();
      }));
    });
  }
};

// src/settings/MetadataMenuSettings.ts
var DEFAULT_SETTINGS = {
  presetFields: [],
  displayFieldsInContextMenu: true,
  globallyIgnoredFields: [],
  classFilesPath: "",
  getFromInlineField: true,
  isAutosuggestEnabled: true,
  fileClassAlias: "fileClass"
};

// src/utils/parser.ts
var fieldComponents = ["startStyle", "attribute", "endStyle", "beforeSeparatorSpacer", "afterSeparatorSpacer", "values"];
var genericFieldRegex = "(?<startStyle>[_\\*~`]*)(?<attribute>[0-9\\w\\p{Letter}\\p{Emoji_Presentation}][-0-9\\w\\p{Letter}\\p{Emoji_Presentation}\\s]*)(?<endStyle>[_\\*~`]*)(?<beforeSeparatorSpacer>\\s*)";
var inlineFieldRegex = (attribute) => new RegExp(`(?<startStyle>[_*~\`]*)(?<attribute>${attribute})(?<endStyle>[_*~\`]*)(?<beforeSeparatorSpacer>\\s*)::(?<afterSeparatorSpacer>\\s*)(?<values>.*)`, "u");

// src/commands/getValues.ts
function getValues(app2, file, attribute) {
  return __async(this, null, function* () {
    var _a;
    const content = yield (yield app2.vault.cachedRead(file)).split("\n");
    const frontmatter = (_a = this.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    const { position: { start, end } } = frontmatter || null;
    const result = [];
    content.map((line, i) => {
      if (frontmatter && i >= start.line && i <= end.line) {
        const regex = new RegExp(`${attribute}:(.*)`, "u");
        const r = line.match(regex);
        if (r && r.length > 0)
          result.push(r[1]);
      } else {
        const regex = inlineFieldRegex(attribute);
        const r = line.match(regex);
        if (r == null ? void 0 : r.groups)
          result.push(r.groups.values);
      }
    });
    return result;
  });
}

// src/commands/replaceValues.ts
function replaceValues(app2, file, attribute, input) {
  return __async(this, null, function* () {
    var _a;
    const content = yield (yield app2.vault.cachedRead(file)).split("\n");
    const frontmatter = (_a = this.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    const start = frontmatter ? frontmatter.position.start : null;
    const end = frontmatter ? frontmatter.position.end : null;
    const newContent = content.map((line, i) => {
      if (frontmatter && i >= start.line && i <= end.line) {
        const regex = new RegExp(`${attribute}:`, "u");
        const r = line.match(regex);
        if (r && r.length > 0) {
          const inputArray = input ? input.replace(/(\,\s+)/g, ",").split(",") : [""];
          const newValue = inputArray.length == 1 ? inputArray[0] : `[${inputArray.join(", ")}]`;
          return `${attribute}: ${newValue}`;
        } else {
          return line;
        }
      } else {
        const regex = inlineFieldRegex(attribute);
        const r = line.match(regex);
        if ((r == null ? void 0 : r.groups) && Object.keys(r.groups).every((i2) => fieldComponents.includes(i2))) {
          const { startStyle, endStyle, beforeSeparatorSpacer, afterSeparatorSpacer, values } = r.groups;
          const inputArray = input ? input.replace(/(\,\s+)/g, ",").split(",") : [""];
          const newValue = inputArray.length == 1 ? inputArray[0] : `${inputArray.join(", ")}`;
          return `${startStyle}${attribute}${endStyle}${beforeSeparatorSpacer}::${afterSeparatorSpacer}${newValue}`;
        } else {
          return line;
        }
      }
    });
    app2.vault.modify(file, newContent.join("\n"));
  });
}

// src/commands/fieldModifier.ts
var import_obsidian5 = require("obsidian");

// src/fileClass/fileClassAttribute.ts
var types = {
  "input": "Accept any value",
  "select": "Accept a single value from a list",
  "multi": "Accept multiple values from a list",
  "cycle": "Cycle through values from a list",
  "boolean": "Accept true of false"
};
var FileClassAttribute = class {
  constructor(raw) {
    var _a, _b;
    const completeRegex = new RegExp(`^${genericFieldRegex}::(?<fieldSettings>.+)?`, "u");
    const nameRegex = new RegExp(`^${genericFieldRegex}$`, "u");
    let fieldName;
    let { attribute, fieldSettings } = ((_a = raw.match(completeRegex)) == null ? void 0 : _a.groups) || {};
    if (attribute) {
      fieldName = attribute;
    } else {
      let { attribute: attribute2 } = ((_b = raw.match(nameRegex)) == null ? void 0 : _b.groups) || {};
      fieldName = attribute2;
    }
    if (fieldName) {
      this.name = fieldName.trim();
      if (fieldSettings) {
        const settings = JSON.parse(`${fieldSettings.trim()}`);
        this.type = settings["type"];
        switch (this.type) {
          case "multi":
            this.isMulti = true;
            break;
          case "cycle":
            this.isCycle = true;
            break;
          case "boolean":
            this.isBoolean = true;
          default:
            break;
        }
        this.options = settings["options"];
      }
    } else {
      const error = new Error("Improper value");
      throw error;
    }
  }
  getField() {
    var _a;
    let values = {};
    (_a = this.options) == null ? void 0 : _a.forEach((option, index) => {
      values[index] = option;
    });
    return new Field_default(this.name, values, this.name, this.isMulti, this.isCycle, this.isBoolean);
  }
};

// src/fileClass/fileClass.ts
var import_obsidian4 = require("obsidian");
var FileClassManager = class {
  constructor(instance) {
    this.instance = instance;
  }
  all() {
    const filesWithFileClassName = this.instance.plugin.app.vault.getMarkdownFiles().filter((file) => {
      const cache = this.instance.plugin.app.metadataCache.getFileCache(file);
      const fileClassAlias = this.instance.plugin.settings.fileClassAlias;
      return (cache == null ? void 0 : cache.frontmatter) && Object.keys(cache.frontmatter).includes(fileClassAlias) && cache.frontmatter[fileClassAlias] == this.instance.name;
    });
    return filesWithFileClassName;
  }
  get(name) {
    const filesWithName = this.all().filter((file) => file.basename == name);
    if (filesWithName.length > 1) {
      const error = new Error("More than one value found");
      throw error;
    }
    if (filesWithName.length == 0) {
      const error = new Error("No file value found");
      throw error;
    }
    return filesWithName[0];
  }
  getPath(path) {
    const filesWithName = this.all().filter((file) => file.path == path);
    if (filesWithName.length > 1) {
      const error = new Error("More than one value found");
      throw error;
    }
    if (filesWithName.length == 0) {
      const error = new Error("No file value found");
      throw error;
    }
    return filesWithName[0];
  }
};
var FileClass = class {
  constructor(plugin, name) {
    this.plugin = plugin;
    this.name = name;
    this.objects = new FileClassManager(this);
    this.attributes = [];
  }
  getClassFile() {
    const filesClassPath = this.plugin.settings.classFilesPath;
    const file = this.plugin.app.vault.getAbstractFileByPath(`${filesClassPath}${this.name}.md`);
    if (file instanceof import_obsidian4.TFile && file.extension == "md") {
      return file;
    } else {
      const error = new Error("no such fileClass in fileClass folder");
      throw error;
    }
  }
  getAttributes() {
    return __async(this, null, function* () {
      try {
        const file = this.getClassFile();
        let attributes = [];
        let errors = [];
        const result = yield this.plugin.app.vault.cachedRead(file);
        result.split("\n").forEach((line) => {
          try {
            const attribute = new FileClassAttribute(line);
            attributes.push(attribute);
          } catch (error) {
            errors.push(error);
          }
        });
        this.attributes = attributes;
        this.errors = errors;
      } catch (error) {
        throw error;
      }
    });
  }
  updateAttribute(newType, newOptions, newName, attr) {
    return __async(this, null, function* () {
      const file = this.getClassFile();
      let result = yield this.plugin.app.vault.read(file);
      if (attr) {
        let newContent = [];
        result.split("\n").forEach((line) => {
          if (line.startsWith(attr.name)) {
            if (newType == "input") {
              newContent.push(newName);
            } else {
              let settings = {};
              settings["type"] = newType;
              settings["options"] = newOptions;
              newContent.push(`${newName}:: ${JSON.stringify(settings)}`);
            }
          } else {
            newContent.push(line);
          }
        });
        this.plugin.app.vault.modify(file, newContent.join("\n"));
      } else {
        let settings = {};
        settings["type"] = newType;
        settings["options"] = newOptions;
        result += `
${newName}:: ${JSON.stringify(settings)}`;
        yield this.plugin.app.vault.modify(file, result);
      }
    });
  }
  removeAttribute(attr) {
    return __async(this, null, function* () {
      const file = this.getClassFile();
      const result = yield this.plugin.app.vault.read(file);
      let newContent = [];
      result.split("\n").forEach((line) => {
        if (!line.startsWith(attr.name)) {
          newContent.push(line);
        }
      });
      yield this.plugin.app.vault.modify(file, newContent.join("\n"));
    });
  }
};
function createFileClass(plugin, name) {
  return __async(this, null, function* () {
    return new Promise((resolve, reject) => {
      const fileClass = new FileClass(plugin, name);
      fileClass.getAttributes().then(() => {
        resolve(fileClass);
      }).catch((error) => {
        reject(error);
      });
    });
  });
}

// src/commands/getPropertySettings.ts
function getPropertySettings(plugin, propertyName, fileClass) {
  const matchingSettings = plugin.settings.presetFields.filter((p) => p.name == propertyName);
  if (fileClass) {
    const fileClassAttributesWithName = fileClass.attributes.filter((attr) => attr.name == propertyName);
    if (fileClassAttributesWithName.length > 0) {
      const fileClassAttribute = fileClassAttributesWithName[0];
      if (fileClassAttribute.type) {
        return fileClassAttribute.getField();
      } else if (matchingSettings.length > 0) {
        return matchingSettings[0];
      }
      ;
    }
  } else if (matchingSettings.length > 0) {
    return matchingSettings[0];
  }
  ;
}

// src/commands/fieldModifier.ts
function createInputField(plugin, dv, p, fieldName, fieldContainer, attrs) {
  const fieldValue = dv.el("span", p[fieldName], attrs);
  const inputContainer = document.createElement("div");
  const input = document.createElement("input");
  input.setAttr("class", "metadata-menu-dv-input");
  inputContainer.appendChild(input);
  input.value = p[fieldName];
  const spacer = document.createElement("div");
  spacer.setAttr("class", "metadata-menu-dv-field-spacer");
  const button = document.createElement("button");
  button.setText("\u{1F58D}");
  button.setAttr("class", "metadata-menu-dv-field-button");
  button.hide();
  spacer.show();
  fieldContainer.onmouseover = () => {
    button.show();
    spacer.hide();
  };
  fieldContainer.onmouseout = () => {
    button.hide();
    spacer.show();
  };
  const validateIcon = document.createElement("a");
  validateIcon.textContent = "\u2705";
  validateIcon.setAttr("class", "metadata-menu-dv-field-button");
  validateIcon.onclick = (e) => {
    const file = plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
    if (file instanceof import_obsidian5.TFile && file.extension == "md") {
      replaceValues(plugin.app, file, fieldName, input.value);
    }
    fieldContainer.removeChild(inputContainer);
  };
  inputContainer == null ? void 0 : inputContainer.appendChild(validateIcon);
  const cancelIcon = document.createElement("a");
  cancelIcon.setAttr("class", "metadata-menu-dv-field-button");
  cancelIcon.textContent = "\u274C";
  cancelIcon.onclick = (e) => {
    fieldContainer.removeChild(inputContainer);
    fieldContainer.appendChild(button);
    fieldContainer.appendChild(fieldValue);
    fieldContainer.appendChild(spacer);
  };
  inputContainer.appendChild(cancelIcon);
  input.focus();
  input.onkeydown = (e) => {
    if (e.key === "Enter") {
      const file = plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
      if (file instanceof import_obsidian5.TFile && file.extension == "md") {
        replaceValues(plugin.app, file, fieldName, input.value);
      }
      fieldContainer.removeChild(inputContainer);
    }
    if (e.key === "Escape") {
      fieldContainer.removeChild(inputContainer);
      fieldContainer.appendChild(button);
      fieldContainer.appendChild(fieldValue);
      fieldContainer.appendChild(spacer);
    }
  };
  button.onclick = (e) => {
    fieldContainer.removeChild(fieldValue);
    fieldContainer.removeChild(button);
    fieldContainer.removeChild(spacer);
    fieldContainer.appendChild(inputContainer);
    input.focus();
  };
  fieldContainer.appendChild(button);
  fieldContainer.appendChild(fieldValue);
  fieldContainer.appendChild(spacer);
}
function createBooleanField(plugin, dv, p, fieldName, fieldContainer, attrs) {
  const checkbox = dv.el("input", "", __spreadProps(__spreadValues({}, attrs), { "type": "checkbox" }));
  checkbox.checked = p[fieldName];
  fieldContainer.appendChild(checkbox);
  checkbox.onchange = (value) => {
    const file = plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
    if (file instanceof import_obsidian5.TFile && file.extension == "md") {
      replaceValues(plugin.app, file, fieldName, checkbox.checked.toString());
    }
  };
}
function fieldModifier(plugin, dv, p, fieldName, attrs) {
  return __async(this, null, function* () {
    const fieldContainer = dv.el("div", "");
    fieldContainer.setAttr("class", "metadata-menu-dv-field-container");
    if (p[fieldName] === void 0) {
      const emptyField = dv.el("span", null, attrs);
      fieldContainer.appendChild(emptyField);
    } else {
      const fileClassAlias = plugin.settings.fileClassAlias;
      if (p[fileClassAlias]) {
        const fileClass = yield createFileClass(plugin, p[fileClassAlias]);
        const field = getPropertySettings(plugin, fieldName, fileClass);
        if (field == null ? void 0 : field.isBoolean) {
          createBooleanField(plugin, dv, p, fieldName, fieldContainer, attrs);
        } else {
          createInputField(plugin, dv, p, fieldName, fieldContainer, attrs);
        }
      } else if (plugin.settings.presetFields.filter((attr) => attr.name == fieldName)) {
        const field = getPropertySettings(plugin, fieldName);
        if (field == null ? void 0 : field.isBoolean) {
          createBooleanField(plugin, dv, p, fieldName, fieldContainer, attrs);
        } else {
          createInputField(plugin, dv, p, fieldName, fieldContainer, attrs);
        }
      } else {
        createInputField(plugin, dv, p, fieldName, fieldContainer, attrs);
      }
    }
    return fieldContainer;
  });
}

// src/MetadataMenuApi.ts
var MetadataMenuApi = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  make() {
    return {
      getValues: this.getValues(),
      replaceValues: this.replaceValues(),
      fieldModifier: this.fieldModifier()
    };
  }
  getValues() {
    return (app2, file, attribute) => __async(this, null, function* () {
      return getValues(app2, file, attribute);
    });
  }
  replaceValues() {
    return (app2, file, attribute, input) => __async(this, null, function* () {
      return replaceValues(app2, file, attribute, input);
    });
  }
  fieldModifier() {
    return (dv, p, fieldName, attrs) => fieldModifier(this.plugin, dv, p, fieldName, attrs);
  }
};

// src/options/linkContextMenu.ts
var import_obsidian17 = require("obsidian");

// src/optionModals/valueMultiSelectModal.ts
var import_obsidian6 = require("obsidian");
var valueMultiSelectModal = class extends import_obsidian6.Modal {
  constructor(app2, file, name, initialValues, settings, lineNumber = -1, inFrontMatter = false, top = false) {
    super(app2);
    this.app = app2;
    this.file = file;
    this.name = name;
    this.settings = settings;
    if (initialValues) {
      if (initialValues.toString().startsWith("[[")) {
        this.values = initialValues.split(",").map((item) => item.trim());
      } else {
        this.values = initialValues.toString().replace(/^\[(.*)\]$/, "$1").split(",").map((item) => item.trim());
      }
      ;
    } else {
      this.values = [];
    }
    ;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontMatter;
    this.top = top;
  }
  onOpen() {
    return __async(this, null, function* () {
      this.containerEl.addClass("metadata-menu");
      const valueGrid = this.contentEl.createDiv({
        cls: "metadata-menu-value-grid"
      });
      const listNoteValues = yield FieldSetting.getValuesListFromNote(this.settings.valuesListNotePath, this.app);
      yield this.populateValuesGrid(valueGrid, listNoteValues);
    });
  }
  populateValuesGrid(valueGrid, listNoteValues) {
    return __async(this, null, function* () {
      if (listNoteValues.length === 0) {
        Object.keys(this.settings.values).forEach((key) => {
          const presetValue = this.settings.values[key];
          this.buildValueToggler(valueGrid, presetValue);
        });
      }
      ;
      listNoteValues.forEach((value) => {
        this.buildValueToggler(valueGrid, value);
      });
      const footer = this.contentEl.createDiv({ cls: "metadata-menu-value-grid-footer" });
      const saveButton = new import_obsidian6.ButtonComponent(footer);
      saveButton.setIcon("checkmark");
      saveButton.onClick(() => __async(this, null, function* () {
        if (this.lineNumber == -1) {
          replaceValues(this.app, this.file, this.name, this.values.join(","));
        } else {
          const result = yield this.app.vault.read(this.file);
          let newContent = [];
          const renderedValues = !this.inFrontmatter ? this.values.join(",") : this.values.length > 1 ? `[${this.values.join(",")}]` : this.values;
          if (this.top) {
            newContent.push(`${this.name}${this.inFrontmatter ? ":" : "::"} ${renderedValues}`);
            result.split("\n").forEach((line, _lineNumber) => newContent.push(line));
          } else {
            result.split("\n").forEach((line, _lineNumber) => {
              newContent.push(line);
              if (_lineNumber == this.lineNumber) {
                newContent.push(`${this.name}${this.inFrontmatter ? ":" : "::"} ${renderedValues}`);
              }
              ;
            });
          }
          ;
          this.app.vault.modify(this.file, newContent.join("\n"));
          this.close();
        }
        ;
        this.close();
      }));
      const cancelButton = new import_obsidian6.ExtraButtonComponent(footer);
      cancelButton.setIcon("cross");
      cancelButton.onClick(() => this.close());
    });
  }
  buildValueToggler(valueGrid, presetValue) {
    const valueSelectorContainer = valueGrid.createDiv({
      cls: "metadata-menu-value-selector-container"
    });
    const valueTogglerContainer = valueSelectorContainer.createDiv({
      cls: "metadata-menu-value-selector-toggler"
    });
    const valueToggler = new import_obsidian6.ToggleComponent(valueTogglerContainer);
    this.values.forEach((value) => {
      if (value == presetValue) {
        valueToggler.setValue(true);
      }
      ;
    });
    valueToggler.onChange((value) => {
      if (value && !this.values.includes(presetValue)) {
        this.values.push(presetValue);
      }
      ;
      if (!value) {
        this.values.remove(presetValue);
      }
      ;
    });
    const valueLabel = valueSelectorContainer.createDiv({ cls: "metadata-menu-value-selector-label" });
    valueLabel.setText(presetValue);
  }
};

// src/optionModals/valueTextInputModal.ts
var import_obsidian7 = require("obsidian");
var valueTextInputModal = class extends import_obsidian7.Modal {
  constructor(app2, file, name, value, lineNumber = -1, inFrontMatter = false, top = false) {
    super(app2);
    this.parseDate = false;
    this.app = app2;
    this.file = file;
    this.name = name;
    this.value = value;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontMatter;
    this.top = top;
  }
  onOpen() {
    const inputDiv = this.contentEl.createDiv({ cls: "metadata-menu-modal-value" });
    this.buildInputEl(inputDiv);
  }
  buildDateParseToggler(container) {
    if (app.plugins.plugins.hasOwnProperty("nldates-obsidian")) {
      const nldates = app.plugins.plugins["nldates-obsidian"];
      const dateParserLabel = container.createDiv({
        cls: "metadata-menu-date-parser-label"
      });
      dateParserLabel.setText("\u{1F4C6}");
      const dateParserToggler = new import_obsidian7.ToggleComponent(container);
      dateParserToggler.onChange((value) => {
        this.parseDate = value;
      });
      dateParserLabel.onclick = () => dateParserToggler.setValue(!this.parseDate);
    }
    ;
  }
  buildInputEl(inputDiv) {
    this.buildDateParseToggler(inputDiv);
    const form = inputDiv.createEl("form");
    form.type = "submit";
    const inputEl = new import_obsidian7.TextComponent(form);
    inputEl.inputEl.focus();
    inputEl.setValue(this.value);
    inputEl.inputEl.addClass("metadata-menu-prompt-input");
    form.onsubmit = (e) => __async(this, null, function* () {
      e.preventDefault();
      let inputValue = inputEl.getValue();
      if (app.plugins.plugins.hasOwnProperty("nldates-obsidian") && this.parseDate) {
        const nldates = app.plugins.plugins["nldates-obsidian"];
        const format = nldates.settings.format;
        let textStart = "";
        let textEnd = "";
        let date = "";
        const selectionStart = inputEl.inputEl.selectionStart;
        const selectionEnd = inputEl.inputEl.selectionEnd;
        if (selectionEnd == selectionStart) {
          date = nldates.parseDate(inputEl.getValue()).moment.format(format);
        } else {
          textStart = inputEl.getValue().slice(0, selectionStart);
          date = nldates.parseDate(inputEl.getValue().slice(selectionStart, selectionEnd)).moment.format(format);
          textEnd = inputEl.getValue().slice(selectionEnd);
        }
        ;
        inputValue = textStart + "[[" + date + "]]" + textEnd;
      }
      if (this.lineNumber == -1) {
        replaceValues(this.app, this.file, this.name, inputValue);
      } else {
        const result = yield this.app.vault.read(this.file);
        let newContent = [];
        if (this.top) {
          newContent.push(`${this.name}${this.inFrontmatter ? ":" : "::"} ${inputValue}`);
          result.split("\n").forEach((line, _lineNumber) => newContent.push(line));
        } else {
          result.split("\n").forEach((line, _lineNumber) => {
            newContent.push(line);
            if (_lineNumber == this.lineNumber) {
              newContent.push(`${this.name}${this.inFrontmatter ? ":" : "::"} ${inputValue}`);
            }
            ;
          });
        }
        ;
        this.app.vault.modify(this.file, newContent.join("\n"));
        this.close();
      }
      ;
      this.close();
    });
  }
};

// src/optionModals/valueSelectModal.ts
var import_obsidian8 = require("obsidian");
var valueSelectModal = class extends import_obsidian8.Modal {
  constructor(app2, file, name, value, settings, lineNumber = -1, inFrontMatter = false, top = false) {
    super(app2);
    this.app = app2;
    this.file = file;
    this.name = name;
    this.value = value;
    this.settings = settings;
    this.newValue = null;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontMatter;
    this.top = top;
  }
  onOpen() {
    return __async(this, null, function* () {
      this.containerEl.addClass("metadata-menu");
      const inputDiv = this.contentEl.createDiv({ cls: "metadata-menu-modal-value" });
      yield this.buildInputEl(inputDiv);
    });
  }
  buildInputEl(inputDiv) {
    return __async(this, null, function* () {
      const selectEl = new import_obsidian8.DropdownComponent(inputDiv);
      selectEl.selectEl.addClass("metadata-menu-select");
      const values = this.settings.values;
      selectEl.addOption("", "--Empty--");
      const listNoteValues = yield FieldSetting.getValuesListFromNote(this.settings.valuesListNotePath, this.app);
      listNoteValues.forEach((value) => selectEl.addOption(value, value));
      if (listNoteValues.includes(this.value)) {
        selectEl.setValue(this.value);
      }
      ;
      if (listNoteValues.length === 0) {
        Object.keys(values).forEach((key) => {
          selectEl.addOption(values[key], values[key]);
        });
        if (Object.values(values).includes(this.value)) {
          selectEl.setValue(this.value);
        }
        ;
      }
      selectEl.onChange((value) => this.newValue = value != "--Empty--" ? value : "");
      const submitButton = new import_obsidian8.ButtonComponent(inputDiv);
      submitButton.setTooltip("Save").setIcon("checkmark").onClick(() => __async(this, null, function* () {
        if (this.lineNumber == -1) {
          if (this.newValue || this.newValue == "") {
            replaceValues(this.app, this.file, this.name, this.newValue);
          }
          ;
        } else {
          const result = yield this.app.vault.read(this.file);
          let newContent = [];
          if (this.top) {
            newContent.push(`${this.name}${this.inFrontmatter ? ":" : "::"} ${selectEl.getValue()}`);
            result.split("\n").forEach((line, _lineNumber) => newContent.push(line));
          } else {
            result.split("\n").forEach((line, _lineNumber) => {
              newContent.push(line);
              if (_lineNumber == this.lineNumber) {
                newContent.push(`${this.name}${this.inFrontmatter ? ":" : "::"} ${selectEl.getValue()}`);
              }
              ;
            });
          }
          ;
          this.app.vault.modify(this.file, newContent.join("\n"));
          this.close();
        }
        ;
        this.close();
      }));
    });
  }
};

// src/optionModals/chooseSectionModal.ts
var import_obsidian12 = require("obsidian");

// src/optionModals/fieldSelectModal.ts
var import_obsidian11 = require("obsidian");

// src/optionModals/addNewFieldModal.ts
var import_obsidian9 = require("obsidian");
var addNewFieldModal = class extends import_obsidian9.Modal {
  constructor(plugin, lineNumber, file, inFrontmatter, top) {
    super(plugin.app);
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.file = file;
    this.top = top;
  }
  onOpen() {
    this.titleEl.setText("Insert new field");
    const addNewFieldContainer = this.contentEl.createDiv();
    const nameInputContainer = addNewFieldContainer.createDiv();
    nameInputContainer.setText("Field Name: ");
    const nameInputEl = new import_obsidian9.TextComponent(nameInputContainer);
    nameInputEl.setPlaceholder("Field name");
    const valueInputContainer = addNewFieldContainer.createDiv();
    valueInputContainer.setText("Field value: ");
    const valueInputEl = new import_obsidian9.TextComponent(valueInputContainer);
    valueInputEl.setPlaceholder("Field value");
    const footerButtons = this.contentEl.createDiv({
      cls: "metadata-menu-textarea-buttons"
    });
    const saveButton = new import_obsidian9.ButtonComponent(footerButtons);
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => __async(this, null, function* () {
      const result = yield this.app.vault.read(this.file);
      let newContent = [];
      if (this.top) {
        newContent.push(`${nameInputEl.getValue()}${this.inFrontmatter ? ":" : "::"} ${valueInputEl.getValue()}`);
        result.split("\n").forEach((line, _lineNumber) => newContent.push(line));
      } else {
        result.split("\n").forEach((line, _lineNumber) => {
          newContent.push(line);
          if (_lineNumber == this.lineNumber) {
            newContent.push(`${nameInputEl.getValue()}${this.inFrontmatter ? ":" : "::"} ${valueInputEl.getValue()}`);
          }
        });
      }
      this.app.vault.modify(this.file, newContent.join("\n"));
      this.close();
    }));
    const cancelButton = new import_obsidian9.ExtraButtonComponent(footerButtons);
    cancelButton.setIcon("cross");
    cancelButton.onClick(() => {
      this.close();
    });
  }
};

// src/optionModals/valueToggleModal.ts
var import_obsidian10 = require("obsidian");
var valueToggleModal = class extends import_obsidian10.Modal {
  constructor(app2, file, name, value, lineNumber = -1, inFrontMatter = false, top = false) {
    super(app2);
    this.app = app2;
    this.file = file;
    this.name = name;
    this.value = value;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontMatter;
    this.top = top;
  }
  onOpen() {
    const inputDiv = this.contentEl.createDiv({
      cls: "metadata-menu-toggler"
    });
    this.buildToggleEl(inputDiv);
  }
  buildToggleEl(inputDiv) {
    const toggleEl = new import_obsidian10.ToggleComponent(inputDiv);
    toggleEl.setValue(this.value);
    toggleEl.onChange((value) => {
      this.value = value;
    });
    const footer = this.contentEl.createDiv({ cls: "metadata-menu-value-grid-footer" });
    const saveButton = new import_obsidian10.ButtonComponent(footer);
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => __async(this, null, function* () {
      const value = this.value.toString();
      if (this.lineNumber == -1) {
        replaceValues(this.app, this.file, this.name, value);
      } else {
        const result = yield this.app.vault.read(this.file);
        let newContent = [];
        if (this.top) {
          newContent.push(`${this.name}${this.inFrontmatter ? ":" : "::"} ${value}`);
          result.split("\n").forEach((line, _lineNumber) => newContent.push(line));
        } else {
          result.split("\n").forEach((line, _lineNumber) => {
            newContent.push(line);
            if (_lineNumber == this.lineNumber) {
              newContent.push(`${this.name}${this.inFrontmatter ? ":" : "::"} ${value}`);
            }
            ;
          });
        }
        ;
        this.app.vault.modify(this.file, newContent.join("\n"));
        this.close();
      }
      ;
      this.close();
    }));
  }
};

// src/optionModals/fieldSelectModal.ts
var fieldSelectModal = class extends import_obsidian11.Modal {
  constructor(plugin, file, lineNumber, line, inFrontmatter, top, fileClass) {
    super(plugin.app);
    this.line = line;
    this.lineNumber = lineNumber;
    this.plugin = plugin;
    this.file = file;
    this.inFrontmatter = inFrontmatter;
    this.top = top;
    this.fileClass = fileClass;
  }
  onOpen() {
    this.titleEl.setText(`Insert field after > ${this.line.substring(0, 20)}${this.line.length > 20 ? "..." : ""}`);
    const container = this.contentEl.createDiv({ cls: "metadata-menu-field-select" });
    const settingsDropdownContainer = container.createDiv();
    const settingsSelector = new import_obsidian11.DropdownComponent(settingsDropdownContainer);
    settingsSelector.addOption("---", "Choose Field");
    settingsSelector.addOption("++New", "New");
    if (this.fileClass) {
      this.fileClass.attributes.forEach((attr) => {
        settingsSelector.addOption(attr.name, attr.name);
      });
    } else {
      this.plugin.settings.presetFields.forEach((setting) => {
        settingsSelector.addOption(setting.name, setting.name);
      });
    }
    ;
    settingsSelector.onChange((value) => {
      if (value == "++New") {
        const newFieldModal = new addNewFieldModal(this.plugin, this.lineNumber, this.file, this.inFrontmatter, this.top);
        newFieldModal.open();
        this.close();
      } else if (this.fileClass) {
        const fileClassAttributesWithName = this.fileClass.attributes.filter((attr) => attr.name == value);
        let field;
        let type;
        if (fileClassAttributesWithName.length > 0) {
          const fileClassAttribute = fileClassAttributesWithName[0];
          field = fileClassAttribute.getField();
          type = fileClassAttribute.type;
        }
        if (field) {
          switch (type) {
            case "cycle":
            case "select": {
              const fieldModal = new valueSelectModal(this.app, this.file, field.name, "", field, this.lineNumber, this.inFrontmatter, this.top);
              fieldModal.titleEl.setText(`Select value for ${value}`);
              fieldModal.open();
              break;
            }
            case "multi": {
              const fieldModal = new valueMultiSelectModal(this.app, this.file, field.name, "", field, this.lineNumber, this.inFrontmatter, this.top);
              fieldModal.titleEl.setText(`Select values for ${value}`);
              fieldModal.open();
              break;
            }
            case "boolean": {
              const fieldModal = new valueToggleModal(this.app, this.file, field.name, false, this.lineNumber, this.inFrontmatter, this.top);
              fieldModal.titleEl.setText(`Set value for ${value}`);
              fieldModal.open();
              break;
            }
            default:
              {
                const fieldModal = new valueTextInputModal(this.app, this.file, value, "", this.lineNumber, this.inFrontmatter, this.top);
                fieldModal.titleEl.setText(`Enter value for ${value}`);
                fieldModal.open();
                "break";
              }
              ;
          }
        }
        this.close();
      } else {
        const field = this.plugin.settings.presetFields.filter((_field) => _field.name == value)[0];
        if (field.valuesListNotePath || field.values && Object.keys(field.values).length > 0) {
          if (field.isMulti) {
            const fieldModal = new valueMultiSelectModal(this.app, this.file, field.name, "", field, this.lineNumber, this.inFrontmatter, this.top);
            fieldModal.titleEl.setText(`Select values for ${value}`);
            fieldModal.open();
          } else {
            const fieldModal = new valueSelectModal(this.app, this.file, field.name, "", field, this.lineNumber, this.inFrontmatter, this.top);
            fieldModal.titleEl.setText(`Select value for ${value}`);
            fieldModal.open();
          }
          ;
        } else if (field.isBoolean) {
          const fieldModal = new valueToggleModal(this.app, this.file, field.name, false, this.lineNumber, this.inFrontmatter, this.top);
          fieldModal.titleEl.setText(`Set value for ${value}`);
          fieldModal.open();
        } else {
          const fieldModal = new valueTextInputModal(this.app, this.file, value, "", this.lineNumber, this.inFrontmatter, this.top);
          fieldModal.titleEl.setText(`Enter value for ${value}`);
          fieldModal.open();
        }
        ;
        this.close();
      }
      ;
    });
  }
};

// src/optionModals/chooseSectionModal.ts
var chooseSectionModal = class extends import_obsidian12.Modal {
  constructor(plugin, file, fileClass) {
    super(plugin.app);
    this.file = file;
    this.plugin = plugin;
    this.fileClass = fileClass;
  }
  onOpen() {
    return __async(this, null, function* () {
      this.titleEl.setText("Add a field in this note after:");
      const inputDiv = this.contentEl.createDiv({ cls: "metadata-menu-modal-value" });
      const selectEl = new import_obsidian12.DropdownComponent(inputDiv);
      selectEl.selectEl.addClass("metadata-menu-select");
      selectEl.addOption("", "Select line");
      selectEl.addOption("top_0", "top");
      const result = yield this.app.vault.read(this.file);
      let foreHeadText = false;
      let frontmatterStart = false;
      let frontmatterEnd = false;
      let inFrontmatter = false;
      result.split("\n").forEach((line, lineNumber) => {
        if (line != "---" && !foreHeadText && !frontmatterStart) {
          foreHeadText = true;
        }
        ;
        if (line == "---" && !foreHeadText) {
          if (!frontmatterStart) {
            frontmatterStart = true;
            inFrontmatter = true;
          } else if (!frontmatterEnd) {
            frontmatterEnd = true;
            inFrontmatter = false;
          }
          ;
        }
        if (inFrontmatter) {
          selectEl.addOption(`frontmatter_${lineNumber}`, `${line.substring(0, 30)}${line.length > 30 ? "..." : ""}`);
        } else {
          selectEl.addOption(`body_${lineNumber}`, `${line.substring(0, 30)}${line.length > 30 ? "..." : ""}`);
        }
        ;
      });
      selectEl.onChange(() => {
        const valueArray = selectEl.getValue().match(/(\w+)_(\d+)/);
        const position = valueArray && valueArray.length > 0 ? valueArray[1] : 0;
        const lineNumber = Number(valueArray && valueArray.length > 1 ? valueArray[2] : 0);
        const inFrontmatter2 = position == "frontmatter" ? true : false;
        const top = position == "top" ? true : false;
        const modal = new fieldSelectModal(this.plugin, this.file, lineNumber, result.split("\n")[lineNumber], inFrontmatter2, top, this.fileClass);
        this.close();
        modal.open();
      });
    });
  }
};

// src/fileClass/FileClassAttributeSelectModal.ts
var import_obsidian14 = require("obsidian");

// src/fileClass/FileClassAttributeModal.ts
var import_obsidian13 = require("obsidian");
var FileClassAttributeModal = class extends import_obsidian13.Modal {
  constructor(plugin, fileClass, attr) {
    super(plugin.app);
    this.plugin = plugin;
    this.attr = attr;
    this.fileClass = fileClass;
    if (this.attr) {
      this.type = this.attr.type || "input";
      this.options = this.attr.options;
      this.name = this.attr.name;
    }
  }
  onOpen() {
    this.titleEl.setText(this.attr ? `Manage ${this.attr.name}` : `Create a new attribute for ${this.fileClass.name}`);
    const nameInputContainer = this.contentEl.createDiv();
    nameInputContainer.setText("name");
    const nameInput = new import_obsidian13.TextComponent(nameInputContainer);
    this.attr ? nameInput.setValue(this.attr.name) : nameInput.setPlaceholder("Type a name for this attribute");
    const typeSelectHeader = this.contentEl.createDiv();
    const attrLine = typeSelectHeader.createEl("div");
    const attrName = attrLine.createEl("strong");
    attrName.setText(`<${this.name}>`);
    attrLine.append(" fields in files with:");
    String(`---
${this.plugin.settings.fileClassAlias}: ${this.fileClass.name}
...
---`).split("\n").forEach((line) => {
      typeSelectHeader.createEl("div", "yaml-metadata-menu-red").setText(line);
    });
    const typeSelectContainer = this.contentEl.createDiv({ cls: "metadata-menu-value-selector-container" });
    const typeSelectLabel = typeSelectContainer.createDiv({ cls: "metadata-menu-value-selector-inline-label" });
    typeSelectLabel.setText("will: ");
    const typeSelectDropDown = typeSelectContainer.createDiv({ cls: "metadata-menu-value-selector-toggler" });
    const typeSelect = new import_obsidian13.DropdownComponent(typeSelectDropDown);
    Object.keys(types).forEach((key) => {
      typeSelect.addOption(key, types[key]);
    });
    if (this.attr) {
      typeSelect.setValue(this.type);
    }
    const optionsInputContainer = this.contentEl.createDiv({ cls: "metadata-menu-value-selector-container" });
    const optionsInputLabel = optionsInputContainer.createDiv({ cls: "metadata-menu-value-selector-inline-label-top" });
    optionsInputLabel.setText("Values");
    const optionsInput = new import_obsidian13.TextAreaComponent(optionsInputContainer);
    optionsInput.inputEl.rows = 3;
    optionsInput.inputEl.cols = 26;
    this.attr ? optionsInput.setValue(this.type == "input" || this.type == "boolean" ? "" : this.options.join(", ")) : optionsInput.setPlaceholder("insert values, comma separated");
    !this.attr || this.type == "input" || this.type == "boolean" ? optionsInputContainer.hide() : optionsInputContainer.show();
    typeSelect.onChange((type) => {
      type == "input" || type == "boolean" ? optionsInputContainer.hide() : optionsInputContainer.show();
      this.type = type;
    });
    optionsInput.onChange((value) => this.options = value.split(",").map((item) => item.trim()));
    nameInput.onChange((value) => {
      this.name = value;
      attrName.setText(`<${value}>`);
    });
    const footer = this.contentEl.createDiv({ cls: "metadata-menu-value-grid-footer" });
    const saveButton = new import_obsidian13.ButtonComponent(footer);
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => {
      this.fileClass.updateAttribute(this.type, this.options, this.name, this.attr);
      this.close();
    });
    if (this.attr) {
      const removeButton = new import_obsidian13.ButtonComponent(footer);
      removeButton.setIcon("trash");
      removeButton.onClick(() => {
        var _a;
        const confirmModal = new import_obsidian13.Modal(this.plugin.app);
        confirmModal.titleEl.setText("Please confirm");
        confirmModal.contentEl.createDiv().setText(`Do you really want to remove ${(_a = this.attr) == null ? void 0 : _a.name} attribute from ${this.fileClass.name}?`);
        const confirmFooter = confirmModal.contentEl.createDiv({ cls: "metadata-menu-value-grid-footer" });
        const confirmButton = new import_obsidian13.ButtonComponent(confirmFooter);
        confirmButton.setIcon("checkmark");
        confirmButton.onClick(() => {
          if (this.attr)
            this.fileClass.removeAttribute(this.attr);
          confirmModal.close();
          this.close();
        });
        const dismissButton = new import_obsidian13.ExtraButtonComponent(confirmFooter);
        dismissButton.setIcon("cross");
        dismissButton.onClick(() => this.close());
        confirmModal.open();
      });
    }
    const cancelButton = new import_obsidian13.ExtraButtonComponent(footer);
    cancelButton.setIcon("cross");
    cancelButton.onClick(() => this.close());
  }
};

// src/fileClass/FileClassAttributeSelectModal.ts
var FileClassAttributeSelectModal = class extends import_obsidian14.Modal {
  constructor(plugin, file) {
    super(plugin.app);
    this.file = file;
    this.plugin = plugin;
  }
  onOpen() {
    return __async(this, null, function* () {
      this.titleEl.setText(`Select the field to update`);
      const fileClass = yield createFileClass(this.plugin, this.file.basename);
      this.titleEl.setText(`Select the field to update in ${fileClass.name}`);
      const selectContainer = this.contentEl.createDiv();
      const select = new import_obsidian14.DropdownComponent(selectContainer);
      select.addOption("select an attribute", "--select an attribute--");
      fileClass.attributes.forEach((attr) => {
        select.addOption(attr.name, attr.name);
      });
      select.addOption("++newAttr++", "++Add a new attribute++");
      select.onChange((attrName) => {
        if (attrName == "++newAttr") {
          const modal = new FileClassAttributeModal(this.plugin, fileClass);
          modal.open();
          this.close();
        } else {
          const modal = new FileClassAttributeModal(this.plugin, fileClass, fileClass.attributes.filter((attr) => attr.name == attrName)[0]);
          modal.open();
          this.close();
        }
      });
    });
  }
};

// src/options/OptionsList.ts
function isMenu(category) {
  return category.addItem !== void 0;
}
function isSelect(category) {
  return category.modals !== void 0;
}
var OptionsList = class {
  constructor(plugin, file, category) {
    this.file = file;
    this.plugin = plugin;
    this.category = category;
  }
  createExtraOptionList() {
    return __async(this, null, function* () {
      var _a;
      const frontmatter = (_a = this.plugin.app.metadataCache.getCache(this.file.path)) == null ? void 0 : _a.frontmatter;
      if (frontmatter) {
        const _b = frontmatter, { position } = _b, attributes = __objRest(_b, ["position"]);
        Object.keys(attributes).forEach((key) => {
          if (this.plugin.settings.globallyIgnoredFields.includes(key)) {
            delete attributes[key];
          }
          ;
        });
        if (isMenu(this.category)) {
          this.category.addSeparator();
        }
        ;
        let fileClassForFields = false;
        let fileClassFields = [];
        const fileClassAlias = this.plugin.settings.fileClassAlias;
        if (Object.keys(attributes).includes(fileClassAlias)) {
          const fileClass = attributes[fileClassAlias];
          try {
            const _fileClass = yield createFileClass(this.plugin, fileClass);
            this.fileClass = _fileClass;
            fileClassFields = _fileClass.attributes.map((attr) => attr.name);
            fileClassForFields = true;
            Object.keys(attributes).forEach((key) => {
              if (!fileClassFields.includes(key) && key != fileClassAlias) {
                delete attributes[key];
              }
              ;
            });
            const fileClassAttributeSelectModal = new FileClassAttributeSelectModal(this.plugin, this.fileClass.getClassFile());
            if (isMenu(this.category)) {
              this.category.addSeparator();
              this.category.addItem((item) => {
                item.setIcon("gear");
                item.setTitle(`Manage <${this.fileClass.name}> fields`);
                item.onClick((evt) => {
                  fileClassAttributeSelectModal.open();
                });
              });
            } else {
              this.category.addOption("manage_fileClass_attributes", `Manage <${this.fileClass.name}> fields`);
              this.category.modals["manage_fileClass_attributes"] = () => fileClassAttributeSelectModal.open();
            }
            ;
            yield this.createExtraOptionsListForFrontmatter(attributes);
            yield this.createExtraOptionsListForInlineFields(this.file, fileClassForFields, fileClassFields);
            if (isMenu(this.category)) {
              this.category.addSeparator();
            }
            ;
            this.addSectionSelectModalOption();
          } catch (error) {
            yield this.createExtraOptionsListForFrontmatter(attributes);
            yield this.createExtraOptionsListForInlineFields(this.file);
            if (isMenu(this.category)) {
              this.category.addSeparator();
            }
            ;
            this.addSectionSelectModalOption();
          }
          ;
        } else {
          yield this.createExtraOptionsListForFrontmatter(attributes);
          yield this.createExtraOptionsListForInlineFields(this.file);
          if (isMenu(this.category)) {
            this.category.addSeparator();
          }
          ;
          this.addSectionSelectModalOption();
        }
        ;
      } else {
        yield this.createExtraOptionsListForInlineFields(this.file);
        if (isMenu(this.category)) {
          this.category.addSeparator();
        }
        ;
        this.addSectionSelectModalOption();
      }
      ;
    });
  }
  createExtraOptionsListForInlineFields(_0) {
    return __async(this, arguments, function* (file, fileClassForFields = false, fileClassFields = []) {
      let attributes = {};
      const regex = new RegExp(`^${genericFieldRegex}::s*(?<values>.+)?`, "u");
      const result = yield this.plugin.app.vault.read(file);
      result.split("\n").map((line) => {
        const regexResult = line.match(regex);
        const { attribute, values } = (regexResult == null ? void 0 : regexResult.groups) || {};
        if (attribute && !this.plugin.settings.globallyIgnoredFields.includes(attribute.trim())) {
          if (fileClassForFields) {
            if (fileClassFields.includes(attribute.trim())) {
              attributes[attribute.trim()] = values ? values.trim() : "";
            }
            ;
          } else {
            attributes[attribute.trim()] = values ? values.trim() : "";
          }
          ;
        }
        ;
      });
      if (Object.keys(attributes).length > 0) {
        if (isMenu(this.category)) {
          this.category.addSeparator();
        }
        ;
        this.buildExtraOptionsList(attributes);
      }
      ;
    });
  }
  createExtraOptionsListForFrontmatter(attributes) {
    return __async(this, null, function* () {
      this.buildExtraOptionsList(attributes);
    });
  }
  buildExtraOptionsList(attributes) {
    Object.keys(attributes).forEach((key) => {
      const value = attributes[key];
      const propertySettings = getPropertySettings(this.plugin, key, this.fileClass);
      if ((propertySettings == null ? void 0 : propertySettings.values) && !(propertySettings == null ? void 0 : propertySettings.isBoolean)) {
        if (propertySettings.isCycle) {
          this.addCycleMenuOption(key, value, propertySettings);
        } else if (propertySettings.isMulti) {
          this.addMultiMenuOption(key, value, propertySettings);
        } else {
          this.addSelectMenuOption(key, value, propertySettings);
        }
        ;
      } else if (propertySettings == null ? void 0 : propertySettings.isBoolean) {
        let toBooleanValue = false;
        if (isBoolean(value)) {
          toBooleanValue = value;
        } else if (/true/i.test(value)) {
          toBooleanValue = true;
        } else if (/false/i.test(value)) {
          toBooleanValue = false;
        }
        ;
        this.addToggleMenuOption(key, toBooleanValue);
      } else {
        this.addTextInputMenuOption(key, value ? value.toString() : "");
      }
      ;
    });
  }
  addSectionSelectModalOption() {
    const modal = new chooseSectionModal(this.plugin, this.file, this.fileClass);
    if (isMenu(this.category)) {
      this.category.addItem((item) => {
        item.setIcon("pencil");
        item.setTitle("Add field at section...");
        item.onClick((evt) => {
          modal.open();
        });
        item.setSection("target-metadata");
      });
    } else if (isSelect(this.category)) {
      this.category.addOption("add_field_at_section", "Add field at section...");
      this.category.modals["add_field_at_section"] = () => modal.open();
    }
    ;
  }
  addCycleMenuOption(name, value, propertySettings) {
    const values = propertySettings.values;
    const keys = Object.keys(values);
    const keyForValue = keys.find((key) => values[key] === value);
    let nextValue;
    if (keyForValue) {
      const nextKey = keys[(keys.indexOf(keyForValue) + 1) % keys.length];
      nextValue = values[nextKey];
    } else {
      nextValue = values[Object.keys(values)[0]];
    }
    ;
    if (isMenu(this.category)) {
      this.category.addItem((item) => {
        item.setTitle(`${name} : ${value} \u25B7 ${nextValue}`);
        item.setIcon("switch");
        item.onClick((evt) => {
          replaceValues(this.plugin.app, this.file, name, nextValue);
        });
        item.setSection("target-metadata");
      });
    } else if (isSelect(this.category)) {
      this.category.addOption(`${name}_${value}_${nextValue}`, `${name} : ${value} \u25B7 ${nextValue}`);
      this.category.modals[`${name}_${value}_${nextValue}`] = () => replaceValues(this.plugin.app, this.file, name, nextValue);
    }
    ;
  }
  addMultiMenuOption(name, value, propertySettings) {
    const modal = new valueMultiSelectModal(this.plugin.app, this.file, name, value, propertySettings);
    modal.titleEl.setText("Select values");
    if (isMenu(this.category)) {
      this.category.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon("bullet-list");
        item.onClick((evt) => {
          modal.open();
        });
        item.setSection("target-metadata");
      });
    } else if (isSelect(this.category)) {
      this.category.addOption(`update_${name}`, `Update <${name}>`);
      this.category.modals[`update_${name}`] = () => modal.open();
    }
    ;
  }
  addSelectMenuOption(name, value, propertySettings) {
    const modal = new valueSelectModal(this.plugin.app, this.file, name, value, propertySettings);
    modal.titleEl.setText("Select value");
    if (isMenu(this.category)) {
      this.category.addItem((item) => {
        item.setTitle(`Update ${name}`);
        item.setIcon("right-triangle");
        item.onClick((evt) => modal.open());
        item.setSection("target-metadata");
      });
    } else if (isSelect(this.category)) {
      this.category.addOption(`update_${name}`, `Update <${name}>`);
      this.category.modals[`update_${name}`] = () => modal.open();
    }
    ;
  }
  addToggleMenuOption(name, value) {
    if (isMenu(this.category)) {
      this.category.addItem((item) => {
        item.setTitle(`<${name}> ${value ? "\u2705 \u25B7 \u274C" : "\u274C \u25B7 \u2705"}`);
        item.setIcon("checkmark");
        item.onClick((evt) => {
          replaceValues(this.plugin.app, this.file, name, (!value).toString());
        });
        item.setSection("target-metadata");
      });
    } else if (isSelect(this.category)) {
      this.category.addOption(`update_${name}`, `<${name}> ${value ? "\u2705 \u25B7 \u274C" : "\u274C \u25B7 \u2705"}`);
      this.category.modals[`update_${name}`] = () => replaceValues(this.plugin.app, this.file, name, (!value).toString());
      ;
    }
    ;
  }
  addTextInputMenuOption(name, value) {
    const modal = new valueTextInputModal(this.plugin.app, this.file, name, value);
    modal.titleEl.setText(`Change Value for <${name}>`);
    if (isMenu(this.category)) {
      this.category.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon("pencil");
        item.onClick((evt) => modal.open());
        item.setSection("target-metadata");
      });
    } else if (isSelect(this.category)) {
      this.category.addOption(`update_${name}`, `Update <${name}>`);
      this.category.modals[`update_${name}`] = () => modal.open();
    }
    ;
  }
};

// src/options/NoteFieldsCommandsModal.ts
var import_obsidian16 = require("obsidian");

// src/optionModals/SelectModal.ts
var import_obsidian15 = require("obsidian");
var SelectModal = class extends import_obsidian15.DropdownComponent {
  constructor(containerEl) {
    super(containerEl);
    this.modals = {};
  }
};

// src/options/NoteFieldsCommandsModal.ts
var NoteFieldsCommandsModal = class extends import_obsidian16.Modal {
  constructor(app2, plugin, file) {
    super(app2);
    this.app = app2;
    this.plugin = plugin;
    this.file = file;
  }
  onOpen() {
    return __async(this, null, function* () {
      this.titleEl.setText(`Select the field to manage`);
      this.containerEl.addClass("metadata-menu");
      const optionsListContainer = this.contentEl.createDiv({ cls: "field-options" });
      this.select = new SelectModal(optionsListContainer);
      this.select.addOption("---", "Choose Field");
      this.optionsList = new OptionsList(this.plugin, this.file, this.select);
      yield this.optionsList.createExtraOptionList();
      this.select.onChange((value) => {
        this.select.modals[value]();
        this.close();
      });
      this.select.selectEl.focus();
    });
  }
};

// src/options/linkContextMenu.ts
var linkContextMenu = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.createContextMenu();
  }
  createContextMenu() {
    this.plugin.registerEvent(this.plugin.app.workspace.on("file-menu", (menu, abstractFile, source) => {
      const file = this.plugin.app.vault.getAbstractFileByPath(abstractFile.path);
      if (file instanceof import_obsidian17.TFile && file.extension === "md") {
        this.file = file;
        if (file.parent.path + "/" == this.plugin.settings.classFilesPath) {
          menu.addSeparator();
          menu.addItem((item) => {
            item.setIcon("gear");
            item.setTitle(`Manage <${file.basename}> fields`);
            item.onClick((evt) => {
              const fileClassAttributeSelectModal = new FileClassAttributeSelectModal(this.plugin, file);
              fileClassAttributeSelectModal.open();
            });
          });
        } else {
          if (this.plugin.settings.displayFieldsInContextMenu) {
            this.optionsList = new OptionsList(this.plugin, this.file, menu);
            this.optionsList.createExtraOptionList();
          } else {
            this.optionsList = new OptionsList(this.plugin, this.file, menu);
            menu.addItem((item) => {
              item.setIcon("bullet-list"), item.setTitle(`Field Options`), item.onClick((evt) => {
                const fieldOptions = new NoteFieldsCommandsModal(app, this.plugin, file);
                fieldOptions.open();
              });
              item.setSection("target-metadata");
            });
          }
        }
        ;
      }
      ;
    }));
  }
};

// src/suggester/MetadataSuggester.ts
var import_obsidian18 = require("obsidian");
var ValueSuggest = class extends import_obsidian18.EditorSuggest {
  constructor(app2, plugin) {
    super(app2);
    this.inFrontmatter = false;
    this.didSelect = false;
    this.filterOption = (firstValues, lastValue, option) => {
      return !firstValues || !(firstValues == null ? void 0 : firstValues.contains(option)) && (!lastValue || !!lastValue && option.contains(lastValue));
    };
    this.app = app2;
    this.plugin = plugin;
    this.setInstructions([{ command: "Shift", purpose: "put a space after::" }]);
    this.scope.register(["Shift"], "Enter", (evt) => {
      this.suggestions.useSelectedItem(evt);
      return false;
    });
  }
  onTrigger(cursor, editor, file) {
    if (this.didSelect) {
      this.didSelect = false;
      return null;
    }
    if (!this.plugin.settings.isAutosuggestEnabled) {
      return null;
    }
    ;
    const frontmatter = this.plugin.app.metadataCache.getFileCache(file).frontmatter;
    this.inFrontmatter = frontmatter !== void 0 && frontmatter.position.start.line < cursor.line && cursor.line < frontmatter.position.end.line;
    const regex = this.inFrontmatter ? new RegExp(`^${genericFieldRegex}:(?<values>.*)`, "u") : new RegExp(`^${genericFieldRegex}::(?<values>.*)`, "u");
    const fullLine = editor.getLine(editor.getCursor().line);
    if (!regex.test(fullLine)) {
      return null;
    }
    return {
      start: cursor,
      end: cursor,
      query: editor.getLine(cursor.line)
    };
  }
  getSuggestions(context) {
    return __async(this, null, function* () {
      const suggestions = yield this.getValueSuggestions(context);
      if (suggestions.length) {
        return suggestions;
      }
      return [];
    });
  }
  getValueSuggestions(context) {
    return __async(this, null, function* () {
      var _a, _b;
      const line = context.start.line;
      let regex;
      if (!this.inFrontmatter) {
        regex = new RegExp(`^${genericFieldRegex}::(?<values>.+)?`, "u");
      } else {
        regex = new RegExp(`^${genericFieldRegex}:(?<values>.+)?`, "u");
      }
      ;
      const regexResult = context.editor.getRange({ line, ch: 0 }, context.end).match(regex);
      if (regexResult && ((_a = regexResult.groups) == null ? void 0 : _a.attribute)) {
        const fieldName = regexResult.groups.attribute;
        const valuesList = (_b = regexResult.groups.values) == null ? void 0 : _b.replace(/^\[|^\s\[/, "").replace(/\]$/, "").split(",").map((o) => o.trim());
        const lastValue = valuesList == null ? void 0 : valuesList.last();
        const firstValues = valuesList == null ? void 0 : valuesList.slice(0, -1);
        if (fieldName === "tags" && this.inFrontmatter) {
          return Object.keys(this.app.metadataCache.getTags()).filter((t) => lastValue ? t.contains(lastValue) : t).sort().map((tag) => Object({ value: tag.replace(/^#/, "") }));
        }
        const cache = this.plugin.app.metadataCache.getCache(context.file.path);
        let tryWithPresetField = !(cache == null ? void 0 : cache.frontmatter);
        if (cache == null ? void 0 : cache.frontmatter) {
          const _c = cache.frontmatter, { position } = _c, attributes = __objRest(_c, ["position"]);
          const fileClassAlias = this.plugin.settings.fileClassAlias;
          if (Object.keys(attributes).contains(fileClassAlias)) {
            const fileClassValue = attributes[fileClassAlias];
            try {
              const fileClass = yield createFileClass(this.plugin, fileClassValue);
              this.fileClass = fileClass;
              const fileClassAttributes = this.fileClass.attributes;
              if (fileClassAttributes.map((attr) => attr.name).contains(fieldName)) {
                const options = fileClassAttributes.filter((attr) => attr.name == fieldName)[0].options.filter((option) => this.filterOption(firstValues, lastValue, option));
                return options.map((option) => Object({ value: option }));
              }
            } catch (error) {
              tryWithPresetField = true;
            }
            ;
          } else {
            tryWithPresetField = true;
          }
          ;
        }
        ;
        if (tryWithPresetField) {
          const presetFieldMatch = this.plugin.settings.presetFields.filter((field) => field.name == fieldName);
          if (presetFieldMatch.length > 0) {
            const presetField = presetFieldMatch[0];
            if (presetField.valuesListNotePath) {
              const valuesFile = this.plugin.app.vault.getAbstractFileByPath(presetField.valuesListNotePath);
              if (valuesFile instanceof import_obsidian18.TFile && valuesFile.extension == "md") {
                const values2 = yield (yield this.plugin.app.vault.read(valuesFile)).split("\n").filter((option) => this.filterOption(firstValues, lastValue, option)).map((_value) => Object({ value: _value }));
                return values2;
              }
              ;
            }
            ;
            const values = Object.entries(presetFieldMatch[0].values).map((option) => option[1]).filter((option) => this.filterOption(firstValues, lastValue, option));
            return values.map((_value) => Object({ value: _value }));
          }
          ;
        }
        ;
      }
      ;
      return [];
    });
  }
  renderSuggestion(suggestion, el) {
    el.setText(suggestion.value);
  }
  selectSuggestion(suggestion, event) {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian18.MarkdownView);
    if (!activeView) {
      return;
    }
    ;
    const editor = activeView.editor;
    const activeLine = editor.getLine(this.context.start.line);
    if (this.inFrontmatter) {
      try {
        let parsedField = (0, import_obsidian18.parseYaml)(activeLine);
        let [attr, pastValues] = Object.entries(parsedField)[0];
        let newField;
        if (!pastValues) {
          newField = attr + ": " + suggestion.value;
        } else if (typeof pastValues == "string") {
          if (!pastValues.contains(",")) {
            newField = attr + ": " + suggestion.value;
          } else {
            newField = attr + ": [" + pastValues.split(",").map((o) => o.trim()).slice(0, -1).join(", ") + ", " + suggestion.value + "]";
          }
        } else if (Array.isArray(pastValues)) {
          if (activeLine.endsWith(",]") || activeLine.endsWith(", ]")) {
            newField = attr + ": [" + [...pastValues, suggestion.value].join(", ") + "]";
          } else {
            newField = attr + ": [" + [...pastValues.slice(0, -1), suggestion.value].join(", ") + "]";
          }
        } else {
          newField = attr + ": [" + [...pastValues].join(", ") + "]";
        }
        editor.replaceRange(newField, { line: this.context.start.line, ch: 0 }, { line: this.context.start.line, ch: activeLine.length });
        if (Array.isArray(pastValues) || typeof pastValues === "string" && pastValues.contains(",")) {
          editor.setCursor({ line: this.context.start.line, ch: newField.length - 1 });
        } else {
          editor.setCursor({ line: this.context.start.line, ch: newField.length });
        }
      } catch (error) {
        new import_obsidian18.Notice("Frontmatter wrongly formatted", 2e3);
        this.close();
        return;
      }
    } else {
      let cleanedLine = activeLine;
      while (![",", ":"].contains(cleanedLine.charAt(cleanedLine.length - 1))) {
        cleanedLine = cleanedLine.slice(0, -1);
      }
      editor.replaceRange(`${cleanedLine}${event.shiftKey ? " " : ""}` + suggestion.value, { line: this.context.start.line, ch: 0 }, this.context.end);
    }
    this.didSelect = true;
    this.close();
  }
};

// main.ts
var MetadataMenu = class extends import_obsidian19.Plugin {
  constructor() {
    super(...arguments);
    this.initialProperties = [];
  }
  onload() {
    return __async(this, null, function* () {
      console.log("Metadata Menu loaded");
      yield this.loadSettings();
      this.registerEditorSuggest(new ValueSuggest(this.app, this));
      this.settings.presetFields.forEach((prop) => {
        const property = new Field_default();
        Object.assign(property, prop);
        this.initialProperties.push(property);
      });
      this.addSettingTab(new MetadataMenuSettingTab(this.app, this));
      this.api = new MetadataMenuApi(this).make();
      this.addCommand({
        id: "field_options",
        name: "field options",
        checkCallback: (checking) => {
          const view = this.app.workspace.getActiveViewOfType(import_obsidian19.MarkdownView);
          if (checking) {
            return !!(view == null ? void 0 : view.file);
          }
          const fieldsOptionsModal = new NoteFieldsCommandsModal(this.app, this, view.file);
          fieldsOptionsModal.open();
        }
      });
      this.addCommand({
        id: "fileClassAttr_options",
        name: "fileClass attributes options",
        checkCallback: (checking) => {
          const view = this.app.workspace.getActiveViewOfType(import_obsidian19.MarkdownView);
          if (checking) {
            return !!(view == null ? void 0 : view.file) && `${view.file.parent.path}/` == this.settings.classFilesPath;
          }
          const modal = new FileClassAttributeSelectModal(this, view.file);
          modal.open();
        }
      });
      new linkContextMenu(this);
    });
  }
  onunload() {
    console.log("Metadata Menu unloaded");
  }
  loadSettings() {
    return __async(this, null, function* () {
      this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      this.settings.presetFields = this.initialProperties;
      yield this.saveData(this.settings);
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3MvTWV0YWRhdGFNZW51U2V0dGluZ1RhYi50cyIsICJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsLnRzIiwgInNyYy9GaWVsZC50cyIsICJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nLnRzIiwgInNyYy9zZXR0aW5ncy9NZXRhZGF0YU1lbnVTZXR0aW5ncy50cyIsICJzcmMvdXRpbHMvcGFyc2VyLnRzIiwgInNyYy9jb21tYW5kcy9nZXRWYWx1ZXMudHMiLCAic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXMudHMiLCAic3JjL2NvbW1hbmRzL2ZpZWxkTW9kaWZpZXIudHMiLCAic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NBdHRyaWJ1dGUudHMiLCAic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3MudHMiLCAic3JjL2NvbW1hbmRzL2dldFByb3BlcnR5U2V0dGluZ3MudHMiLCAic3JjL01ldGFkYXRhTWVudUFwaS50cyIsICJzcmMvb3B0aW9ucy9saW5rQ29udGV4dE1lbnUudHMiLCAic3JjL29wdGlvbk1vZGFscy92YWx1ZU11bHRpU2VsZWN0TW9kYWwudHMiLCAic3JjL29wdGlvbk1vZGFscy92YWx1ZVRleHRJbnB1dE1vZGFsLnRzIiwgInNyYy9vcHRpb25Nb2RhbHMvdmFsdWVTZWxlY3RNb2RhbC50cyIsICJzcmMvb3B0aW9uTW9kYWxzL2Nob29zZVNlY3Rpb25Nb2RhbC50cyIsICJzcmMvb3B0aW9uTW9kYWxzL2ZpZWxkU2VsZWN0TW9kYWwudHMiLCAic3JjL29wdGlvbk1vZGFscy9hZGROZXdGaWVsZE1vZGFsLnRzIiwgInNyYy9vcHRpb25Nb2RhbHMvdmFsdWVUb2dnbGVNb2RhbC50cyIsICJzcmMvZmlsZUNsYXNzL0ZpbGVDbGFzc0F0dHJpYnV0ZVNlbGVjdE1vZGFsLnRzIiwgInNyYy9maWxlQ2xhc3MvRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwudHMiLCAic3JjL29wdGlvbnMvT3B0aW9uc0xpc3QudHMiLCAic3JjL29wdGlvbnMvTm90ZUZpZWxkc0NvbW1hbmRzTW9kYWwudHMiLCAic3JjL29wdGlvbk1vZGFscy9TZWxlY3RNb2RhbC50cyIsICJzcmMvc3VnZ2VzdGVyL01ldGFkYXRhU3VnZ2VzdGVyLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4sIE1hcmtkb3duVmlldyB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBNZXRhZGF0YU1lbnVTZXR0aW5nVGFiIGZyb20gXCJzcmMvc2V0dGluZ3MvTWV0YWRhdGFNZW51U2V0dGluZ1RhYlwiO1xuaW1wb3J0IHsgTWV0YWRhdGFNZW51U2V0dGluZ3MsIERFRkFVTFRfU0VUVElOR1MgfSBmcm9tIFwic3JjL3NldHRpbmdzL01ldGFkYXRhTWVudVNldHRpbmdzXCI7XG5pbXBvcnQgdHlwZSB7IElNZXRhZGF0YU1lbnVBcGkgfSBmcm9tICdzcmMvTWV0YWRhdGFNZW51QXBpJztcbmltcG9ydCB7IE1ldGFkYXRhTWVudUFwaSB9IGZyb20gJ3NyYy9NZXRhZGF0YU1lbnVBcGknO1xuaW1wb3J0IEZpZWxkIGZyb20gJ3NyYy9GaWVsZCc7XG5pbXBvcnQgbGlua0NvbnRleHRNZW51IGZyb20gXCJzcmMvb3B0aW9ucy9saW5rQ29udGV4dE1lbnVcIjtcbmltcG9ydCBOb3RlRmllbGRzQ29tbWFuZHNNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvTm90ZUZpZWxkc0NvbW1hbmRzTW9kYWxcIjtcbmltcG9ydCBGaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbCBmcm9tICdzcmMvZmlsZUNsYXNzL0ZpbGVDbGFzc0F0dHJpYnV0ZVNlbGVjdE1vZGFsJztcbmltcG9ydCBWYWx1ZVN1Z2dlc3QgZnJvbSBcInNyYy9zdWdnZXN0ZXIvTWV0YWRhdGFTdWdnZXN0ZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWV0YWRhdGFNZW51IGV4dGVuZHMgUGx1Z2luIHtcblx0cHVibGljIGFwaTogSU1ldGFkYXRhTWVudUFwaTtcblx0cHVibGljIHNldHRpbmdzOiBNZXRhZGF0YU1lbnVTZXR0aW5ncztcblx0cHVibGljIGluaXRpYWxQcm9wZXJ0aWVzOiBBcnJheTxGaWVsZD4gPSBbXTtcblx0cHVibGljIHNldHRpbmdUYWI6IE1ldGFkYXRhTWVudVNldHRpbmdUYWI7XG5cblx0YXN5bmMgb25sb2FkKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnNvbGUubG9nKCdNZXRhZGF0YSBNZW51IGxvYWRlZCcpO1xuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cdFx0dGhpcy5yZWdpc3RlckVkaXRvclN1Z2dlc3QobmV3IFZhbHVlU3VnZ2VzdCh0aGlzLmFwcCwgdGhpcykpO1xuXG5cdFx0dGhpcy5zZXR0aW5ncy5wcmVzZXRGaWVsZHMuZm9yRWFjaChwcm9wID0+IHtcblx0XHRcdGNvbnN0IHByb3BlcnR5ID0gbmV3IEZpZWxkKCk7XG5cdFx0XHRPYmplY3QuYXNzaWduKHByb3BlcnR5LCBwcm9wKTtcblx0XHRcdHRoaXMuaW5pdGlhbFByb3BlcnRpZXMucHVzaChwcm9wZXJ0eSk7XG5cdFx0fSk7XG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBNZXRhZGF0YU1lbnVTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cdFx0dGhpcy5hcGkgPSBuZXcgTWV0YWRhdGFNZW51QXBpKHRoaXMpLm1ha2UoKTtcblxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRpZDogXCJmaWVsZF9vcHRpb25zXCIsXG5cdFx0XHRuYW1lOiBcImZpZWxkIG9wdGlvbnNcIixcblx0XHRcdGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KVxuXHRcdFx0XHRpZiAoY2hlY2tpbmcpIHtcblx0XHRcdFx0XHRyZXR1cm4gISEodmlldz8uZmlsZSlcblx0XHRcdFx0fVxuXHRcdFx0XHRjb25zdCBmaWVsZHNPcHRpb25zTW9kYWwgPSBuZXcgTm90ZUZpZWxkc0NvbW1hbmRzTW9kYWwodGhpcy5hcHAsIHRoaXMsIHZpZXchLmZpbGUpXG5cdFx0XHRcdGZpZWxkc09wdGlvbnNNb2RhbC5vcGVuKClcblx0XHRcdH0sXG5cdFx0fSk7XG5cblx0XHQvKiBUT0RPIDogYWRkIGEgY29udGV4dCBtZW51IGZvciBmaWxlQ2xhc3MgZmlsZXMgdG8gc2hvdyB0aGUgc2FtZSBvcHRpb25zIGFzIGluIEZpbGVDbGFzc0F0dHJpYnV0ZVNlbGVjdE1vZGFsKi9cblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6IFwiZmlsZUNsYXNzQXR0cl9vcHRpb25zXCIsXG5cdFx0XHRuYW1lOiBcImZpbGVDbGFzcyBhdHRyaWJ1dGVzIG9wdGlvbnNcIixcblx0XHRcdGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KVxuXHRcdFx0XHRpZiAoY2hlY2tpbmcpIHtcblx0XHRcdFx0XHRyZXR1cm4gISEodmlldz8uZmlsZSkgJiYgYCR7dmlldy5maWxlLnBhcmVudC5wYXRofS9gID09IHRoaXMuc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGhcblx0XHRcdFx0fVxuXHRcdFx0XHRjb25zdCBtb2RhbCA9IG5ldyBGaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbCh0aGlzLCB2aWV3IS5maWxlKVxuXHRcdFx0XHRtb2RhbC5vcGVuKClcblx0XHRcdH0sXG5cdFx0fSk7XG5cblx0XHRuZXcgbGlua0NvbnRleHRNZW51KHRoaXMpO1xuXHR9O1xuXG5cdG9udW5sb2FkKCkge1xuXHRcdGNvbnNvbGUubG9nKCdNZXRhZGF0YSBNZW51IHVubG9hZGVkJyk7XG5cdH07XG5cblx0YXN5bmMgbG9hZFNldHRpbmdzKCkge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuXHR9O1xuXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzLnByZXNldEZpZWxkcyA9IHRoaXMuaW5pdGlhbFByb3BlcnRpZXM7XG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcblx0fTtcbn1cbiIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIEJ1dHRvbkNvbXBvbmVudCwgVG9nZ2xlQ29tcG9uZW50LCBNb2RhbCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IEZpZWxkU2V0dGluZ3NNb2RhbCBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ3NNb2RhbFwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvRmllbGRcIjtcbmltcG9ydCBGaWVsZFNldHRpbmcgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdcIjtcbmltcG9ydCB7IGNvcHlGaWxlU3luYyB9IGZyb20gXCJmc1wiO1xuXG5jbGFzcyBTZXR0aW5nc01pZ3JhdGlvbkNvbmZpcm1Nb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuXHRwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51O1xuXHRwcml2YXRlIHRhYjogTWV0YWRhdGFNZW51U2V0dGluZ1RhYjtcblxuXHRjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgdGFiOiBNZXRhZGF0YU1lbnVTZXR0aW5nVGFiKSB7XG5cdFx0c3VwZXIocGx1Z2luLmFwcCk7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdFx0dGhpcy50YWIgPSB0YWI7XG5cdH07XG5cblx0b25PcGVuKCk6IHZvaWQge1xuXG5cdFx0dGhpcy50aXRsZUVsLnNldFRleHQoXCJDb25maXJtXCIpO1xuXHRcdGNvbnN0IGJvZHkgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoe1xuXHRcdFx0Y2xzOiBcIm1vZGFsLXRleHQtZGFuZ2VyXCJcblx0XHR9KTtcblx0XHRib2R5LnNldFRleHQoXCJUaGlzIHdpbGwgZXJhc2UgY3VycmVudCBzZXR0aW5ncy4gQXJlIHlvdSBzdXJlP1wiKTtcblx0XHRjb25zdCBjb25maXJtQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudCh0aGlzLmNvbnRlbnRFbCk7XG5cdFx0Y29uZmlybUJ1dHRvbi5zZXRJY29uKFwiY2hlY2tcIik7XG5cdFx0Y29uZmlybUJ1dHRvbi5vbkNsaWNrKCgpID0+IHtcblx0XHRcdC8vQHRzLWlnbm9yZVxuXHRcdFx0aWYgKHRoaXMuYXBwLnBsdWdpbnMucGx1Z2lucy5oYXNPd25Qcm9wZXJ0eShcInN1cGVyY2hhcmdlZC1saW5rcy1vYnNpZGlhblwiKSkge1xuXHRcdFx0XHQvL0B0cy1pZ25vcmVcblx0XHRcdFx0bGV0IHNldHRpbmdzID0gdGhpcy5hcHAucGx1Z2lucy5wbHVnaW5zW1wic3VwZXJjaGFyZ2VkLWxpbmtzLW9ic2lkaWFuXCJdLnNldHRpbmdzO1xuXHRcdFx0XHRsZXQgX3NldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XG5cdFx0XHRcdC8vY29weWluZyBzaW1wbGUgc2V0dGluZ3Ncblx0XHRcdFx0X3NldHRpbmdzLmNsYXNzRmlsZXNQYXRoID0gc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGg7XG5cdFx0XHRcdF9zZXR0aW5ncy5kaXNwbGF5RmllbGRzSW5Db250ZXh0TWVudSA9IHNldHRpbmdzLmRpc3BsYXlGaWVsZHNJbkNvbnRleHRNZW51O1xuXHRcdFx0XHRfc2V0dGluZ3MuZ2V0RnJvbUlubGluZUZpZWxkID0gc2V0dGluZ3MuZ2V0RnJvbUlubGluZUZpZWxkO1xuXHRcdFx0XHRfc2V0dGluZ3MuZ2xvYmFsbHlJZ25vcmVkRmllbGRzID0gc2V0dGluZ3MuZ2xvYmFsbHlJZ25vcmVkRmllbGRzO1xuXHRcdFx0XHQvL2RlZXAgY29weWluZyBwcmVzZXRGaWVsZHMgaW4gaW5pdGlhbFByb3BlcnR5XG5cdFx0XHRcdHRoaXMucGx1Z2luLmluaXRpYWxQcm9wZXJ0aWVzID0gW107XG5cdFx0XHRcdHNldHRpbmdzLnByZXNldEZpZWxkcy5mb3JFYWNoKChwcm9wOiBGaWVsZCkgPT4ge1xuXHRcdFx0XHRcdGNvbnN0IHByb3BlcnR5ID0gbmV3IEZpZWxkKCk7XG5cdFx0XHRcdFx0T2JqZWN0LmFzc2lnbihwcm9wZXJ0eSwgcHJvcCk7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMucHVzaChwcm9wZXJ0eSk7XG5cdFx0XHRcdH0pXG5cblx0XHRcdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdHRoaXMuY2xvc2UoKTtcblx0XHRcdH07XG5cdFx0fSk7XG5cdH07XG5cblx0b25DbG9zZSgpOiB2b2lkIHtcblx0XHR0aGlzLnRhYi5kaXNwbGF5KCk7XG5cdH07XG59O1xuXG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWV0YWRhdGFNZW51U2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuXHRwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51O1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IE1ldGFkYXRhTWVudSkge1xuXHRcdHN1cGVyKGFwcCwgcGx1Z2luKTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0fTtcblxuXHRkaXNwbGF5KCk6IHZvaWQge1xuXHRcdGxldCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cblx0XHQvKiBcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdEdsb2JhbCBTZXR0aW5ncyBcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdCovXG5cdFx0Y29uc3QgZ2xvYmFsU2V0dGluZ3MgPSBjb250YWluZXJFbC5jcmVhdGVFbCgnZGl2Jylcblx0XHRnbG9iYWxTZXR0aW5ncy5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdHbG9iYWwgc2V0dGluZ3MnLCBjbHM6IFwibWV0YWRhdGEtbWVudS1zZXR0aW5nLXNlY3Rpb24taGVhZGVyXCIgfSk7XG5cdFx0Z2xvYmFsU2V0dGluZ3MuY3JlYXRlRWwoJ2RpdicsIHtcblx0XHRcdGNsczogXCJzZXR0aW5nLWl0ZW0tZGVzY3JpcHRpb24gbWV0YWRhdGEtbWVudS1zZXR0aW5nLXNlY3Rpb24tZGVzY1wiLFxuXHRcdFx0dGV4dDogXCJHbG9iYWwgc2V0dGluZ3MgdG8gYXBwbHkgdG8geW91ciB3aG9sZSB2YXVsdFwiXG5cdFx0fSlcblx0XHQvLyBNYW5hZ2luZyBjaG9pY2Ugd2hldGhlciB5b3UgZ2V0IGF0dHJpYnV0ZXMgZnJvbSBpbmxpbmUgZmllbGRzIGFuZCBmcm9udG1hdHRlciBvciBvbmx5IGZyb250bWF0ZXJcblx0XHRuZXcgU2V0dGluZyhnbG9iYWxTZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKCdTZWFyY2ggZm9yIGF0dHJpYnV0ZSBpbiBJbmxpbmUgZmllbGRzIGxpa2UgPGZpZWxkOjo+Jylcblx0XHRcdC5zZXREZXNjKCdTZXRzIHRoZSBgZGF0YS1saW5rLTxmaWVsZD5gLWF0dHJpYnV0ZSB0byB0aGUgdmFsdWUgb2YgaW5saW5lIGZpZWxkcycpXG5cdFx0XHQuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB7XG5cdFx0XHRcdHRvZ2dsZS5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZXRGcm9tSW5saW5lRmllbGQpXG5cdFx0XHRcdHRvZ2dsZS5vbkNoYW5nZShhc3luYyB2YWx1ZSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2V0RnJvbUlubGluZUZpZWxkID0gdmFsdWVcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKVxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0LyogTWFuYWdlIG1lbnUgb3B0aW9ucyBkaXNwbGF5Ki9cblx0XHRuZXcgU2V0dGluZyhnbG9iYWxTZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKFwiRGlzcGxheSBmaWVsZCBvcHRpb25zIGluIGNvbnRleHQgbWVudVwiKVxuXHRcdFx0LnNldERlc2MoXCJDaG9vc2UgdG8gc2hvdyBvciBoaWRlIGZpZWxkcyBvcHRpb25zIGluIHRoZSBjb250ZXh0IG1lbnUgb2YgYSBsaW5rIG9yIGEgZmlsZVwiKVxuXHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlOiBUb2dnbGVDb21wb25lbnQpID0+IHtcblx0XHRcdFx0dG9nZ2xlLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRpc3BsYXlGaWVsZHNJbkNvbnRleHRNZW51KVxuXHRcdFx0XHR0b2dnbGUub25DaGFuZ2UoYXN5bmMgdmFsdWUgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmRpc3BsYXlGaWVsZHNJbkNvbnRleHRNZW51ID0gdmFsdWVcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKVxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdC8qIEV4Y2x1ZGUgRmllbGRzIGZyb20gY29udGV4dCBtZW51Ki9cblx0XHRuZXcgU2V0dGluZyhnbG9iYWxTZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKCdHbG9iYWxseSBpZ25vcmVkIGZpZWxkcycpXG5cdFx0XHQuc2V0RGVzYygnRmllbGRzIHRvIGJlIGlnbm9yZWQgYnkgdGhlIHBsdWdpbiB3aGVuIGFkZGluZyBvcHRpb25zIHRvIHRoZSBjb250ZXh0IG1lbnUnKVxuXHRcdFx0LmFkZFRleHRBcmVhKCh0ZXh0KSA9PiB7XG5cdFx0XHRcdHRleHRcblx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ0VudGVyIGZpZWxkcyBhcyBzdHJpbmcsIGNvbW1hIHNlcGFyYXRlZCcpXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbGx5SWdub3JlZEZpZWxkcy5qb2luKCcsICcpKVxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbGx5SWdub3JlZEZpZWxkcyA9IHZhbHVlLnJlcGxhY2UoL1xccy9nLCAnJykuc3BsaXQoJywnKTtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR0ZXh0LmlucHV0RWwucm93cyA9IDY7XG5cdFx0XHRcdHRleHQuaW5wdXRFbC5jb2xzID0gMjU7XG5cdFx0XHR9KTtcblxuXHRcdC8qIFxuXHRcdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0TWFuYWdpbmcgcHJlZGVmaW5lZCB2YWx1ZXMgZm9yIHByb3BlcnRpZXMgXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQqL1xuXHRcdC8qIEFkZCBuZXcgcHJvcGVydHkgZm9yIHdoaWNoIHdlIHdhbnQgdG8gcHJlc2V0IHZhbHVlcyovXG5cdFx0Y29uc3QgcHJlc2V0RmllbGRzU2V0dGluZ3MgPSBjb250YWluZXJFbC5jcmVhdGVFbChcImRpdlwiKVxuXHRcdHByZXNldEZpZWxkc1NldHRpbmdzLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ1ByZXNldCBGaWVsZHMgc2V0dGluZ3MnLCBjbHM6IFwibWV0YWRhdGEtbWVudS1zZXR0aW5nLXNlY3Rpb24taGVhZGVyXCIgfSk7XG5cdFx0cHJlc2V0RmllbGRzU2V0dGluZ3MuY3JlYXRlRWwoJ2RpdicsIHtcblx0XHRcdGNsczogXCJzZXR0aW5nLWl0ZW0tZGVzY3JpcHRpb24gbWV0YWRhdGEtbWVudS1zZXR0aW5nLXNlY3Rpb24tZGVzY1wiLFxuXHRcdFx0dGV4dDogXCJNYW5hZ2UgZ2xvYmFsbHkgcHJlZGVmaW5lZCB0eXBlIGFuZCB2YWx1ZXMgZm9yIGEgZmllbGQgdGhyb3VnaG91dCB5b3VyIHdob2xlIHZhdWx0XCJcblx0XHR9KVxuXHRcdG5ldyBTZXR0aW5nKHByZXNldEZpZWxkc1NldHRpbmdzKVxuXHRcdFx0LnNldE5hbWUoXCJBZGQgTmV3IFByb3BlcnR5IE1hbmFnZXJcIilcblx0XHRcdC5zZXREZXNjKFwiQWRkIGEgbmV3IEZyb250bWF0dGVyIHByb3BlcnR5IGZvciB3aGljaCB5b3Ugd2FudCBwcmVzZXQgdmFsdWVzLlwiKVxuXHRcdFx0LmFkZEJ1dHRvbigoYnV0dG9uOiBCdXR0b25Db21wb25lbnQpOiBCdXR0b25Db21wb25lbnQgPT4ge1xuXHRcdFx0XHRyZXR1cm4gYnV0dG9uXG5cdFx0XHRcdFx0LnNldFRvb2x0aXAoXCJBZGQgTmV3IFByb3BlcnR5IE1hbmFnZXJcIilcblx0XHRcdFx0XHQuc2V0QnV0dG9uVGV4dChcIitcIilcblx0XHRcdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XG5cdFx0XHRcdFx0XHRsZXQgbW9kYWwgPSBuZXcgRmllbGRTZXR0aW5nc01vZGFsKHRoaXMuYXBwLCB0aGlzLnBsdWdpbiwgcHJlc2V0RmllbGRzU2V0dGluZ3MpO1xuXHRcdFx0XHRcdFx0bW9kYWwub3BlbigpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cblx0XHQvKiBNYW5hZ2VkIHByb3BlcnRpZXMgdGhhdCBjdXJyZW50bHkgaGF2ZSBwcmVzZXQgdmFsdWVzICovXG5cdFx0dGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMuZm9yRWFjaChwcm9wID0+IHtcblx0XHRcdGNvbnN0IHByb3BlcnR5ID0gbmV3IEZpZWxkKCk7XG5cdFx0XHRPYmplY3QuYXNzaWduKHByb3BlcnR5LCBwcm9wKTtcblx0XHRcdG5ldyBGaWVsZFNldHRpbmcocHJlc2V0RmllbGRzU2V0dGluZ3MsIHByb3BlcnR5LCB0aGlzLmFwcCwgdGhpcy5wbHVnaW4pO1xuXHRcdH0pO1xuXG5cdFx0LyogXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRNYW5hZ2luZyBmaWxlQ2xhc3MgXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQqL1xuXHRcdC8qIFNldCBjbGFzc0ZpbGVzIFBhdGgqL1xuXHRcdGNvbnN0IGNsYXNzRmlsZXNTZXR0aW5ncyA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiZGl2XCIpXG5cdFx0Y2xhc3NGaWxlc1NldHRpbmdzLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0ZpbGVDbGFzcyBzZXR0aW5ncycsIGNsczogXCJtZXRhZGF0YS1tZW51LXNldHRpbmctc2VjdGlvbi1oZWFkZXJcIiB9KTtcblx0XHRjbGFzc0ZpbGVzU2V0dGluZ3MuY3JlYXRlRWwoJ2RpdicsIHtcblx0XHRcdGNsczogXCJzZXR0aW5nLWl0ZW0tZGVzY3JpcHRpb24gbWV0YWRhdGEtbWVudS1zZXR0aW5nLXNlY3Rpb24tZGVzY1wiLFxuXHRcdFx0dGV4dDogXCJNYW5hZ2UgZmlsZUNsYXNzIGZvbGRlciBhbmQgYWxpYXMuIFwiICtcblx0XHRcdFx0XCJXaGVuIGEgbm90ZSBoYXMgYSBmaWVsQ2xhc3MgZGVmaW5lZCwgZmlsZUNsYXNzIGZpZWxkIHByb3BlcnRpZXMgd2lsbCBvdmVycmlkZSBnbG9iYWwgcHJlc2V0IGZpZWxkcyBzZXR0aW5ncyBmb3IgdGhlIHNhbWUgZmllbGQgbmFtZVwiXG5cdFx0fSlcblx0XHRuZXcgU2V0dGluZyhjbGFzc0ZpbGVzU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZSgnY2xhc3MgRmlsZXMgcGF0aCcpXG5cdFx0XHQuc2V0RGVzYygnUGF0aCB0byB0aGUgZmlsZXMgY29udGFpbmluZyB0aGUgYXV0aG9yaXplZCBmaWVsZHMgZm9yIGEgdHlwZSBvZiBub3RlJylcblx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PiB7XG5cdFx0XHRcdHRleHRcblx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ1BhdGgvJylcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGgpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGggPSB2YWx1ZVxuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdC8qIFNldCBmaWxlQ2xhc3MgYWxpYXMqL1xuXHRcdG5ldyBTZXR0aW5nKGNsYXNzRmlsZXNTZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKCdmaWxlQ2xhc3MgZmllbGQgYWxpYXMnKVxuXHRcdFx0LnNldERlc2MoJ0Nob29zZSBhbm90aGVyIG5hbWUgZm9yIGZpbGVDbGFzcyBmaWVsZCBpbiBmcm9udG1hdHRlciAoZXhhbXBsZTogQ2F0ZWdvcnksIHR5cGUsIC4uLicpXG5cdFx0XHQuYWRkVGV4dCgodGV4dCkgPT4ge1xuXHRcdFx0XHR0ZXh0XG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzKVxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzID0gdmFsdWU7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0LyogXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRNaWdyYXRpb24gc2V0dGluZ3MgXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQqL1xuXHRcdGNvbnN0IG1pZ3JhdGVTZXR0aW5ncyA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiZGl2XCIpXG5cdFx0bWlncmF0ZVNldHRpbmdzLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ01pZ3JhdGUnIH0pO1xuXG5cdFx0LyogQWRkIG5ldyBwcm9wZXJ0eSBmb3Igd2hpY2ggd2Ugd2FudCB0byBwcmVzZXQgdmFsdWVzKi9cblx0XHRuZXcgU2V0dGluZyhtaWdyYXRlU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZShcIkNvcHkgc2V0dGluZ3MgZnJvbSBzdXBlcmNoYXJnZWQgbGlua3MgcGx1Z2luXCIpXG5cdFx0XHQuc2V0RGVzYyhcIkNvcHkgc2V0dGluZ3MgZnJvbSBzdXBlcmNoYXJnZWQgbGlua3MgcGx1Z2luXCIpXG5cdFx0XHQuYWRkQnV0dG9uKChidXR0b246IEJ1dHRvbkNvbXBvbmVudCk6IEJ1dHRvbkNvbXBvbmVudCA9PiB7XG5cdFx0XHRcdHJldHVybiBidXR0b25cblx0XHRcdFx0XHQuc2V0VG9vbHRpcChcIkdldCBzZXR0aW5ncyBmcm9tIHN1cGVyY2hhcmdlZCBsaW5rc1wiKVxuXHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KFwiQ29weVwiKVxuXHRcdFx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRcdGxldCBtb2RhbCA9IG5ldyBTZXR0aW5nc01pZ3JhdGlvbkNvbmZpcm1Nb2RhbCh0aGlzLnBsdWdpbiwgdGhpcyk7XG5cdFx0XHRcdFx0XHRtb2RhbC5vcGVuKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0fTtcbn07XG4iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgU2V0dGluZywgVGV4dENvbXBvbmVudCwgTm90aWNlLCBCdXR0b25Db21wb25lbnQsIEV4dHJhQnV0dG9uQ29tcG9uZW50LCBUb2dnbGVDb21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL0ZpZWxkXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZpZWxkU2V0dGluZ3NNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBwcml2YXRlIG5hbWVQcm9tcHRDb21wb25lbnQ6IFRleHRDb21wb25lbnQ7XG4gICAgcHJpdmF0ZSB2YWx1ZXNQcm9tcHRDb21wb25lbnRzOiBBcnJheTxUZXh0Q29tcG9uZW50PiA9IFtdO1xuICAgIHByaXZhdGUgaXNCb29sZWFuVG9nZ2xlckNvbXBvbmVudDogVG9nZ2xlQ29tcG9uZW50O1xuICAgIHByaXZhdGUgaXNNdWx0aVRvZ2dsZXJDb21wb25lbnQ6IFRvZ2dsZUNvbXBvbmVudDtcbiAgICBwcml2YXRlIGlzQ3ljbGVUb2dnbGVyQ29tcG9uZW50OiBUb2dnbGVDb21wb25lbnQ7XG4gICAgcHJpdmF0ZSBzYXZlZDogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgcHJvcGVydHk6IEZpZWxkO1xuICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnU7XG4gICAgcHJpdmF0ZSBpbml0aWFsUHJvcGVydHk6IEZpZWxkO1xuICAgIHByaXZhdGUgcGFyZW50U2V0dGluZz86IFNldHRpbmc7XG4gICAgcHJpdmF0ZSBuZXc6IGJvb2xlYW4gPSB0cnVlO1xuICAgIHByaXZhdGUgcGFyZW50U2V0dGluZ0NvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XG5cblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IE1ldGFkYXRhTWVudSwgcGFyZW50U2V0dGluZ0NvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHBhcmVudFNldHRpbmc/OiBTZXR0aW5nLCBwcm9wZXJ0eT86IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLnBhcmVudFNldHRpbmcgPSBwYXJlbnRTZXR0aW5nO1xuICAgICAgICB0aGlzLmluaXRpYWxQcm9wZXJ0eSA9IG5ldyBGaWVsZCgpO1xuICAgICAgICB0aGlzLnBhcmVudFNldHRpbmdDb250YWluZXIgPSBwYXJlbnRTZXR0aW5nQ29udGFpbmVyO1xuICAgICAgICBpZiAocHJvcGVydHkpIHtcbiAgICAgICAgICAgIHRoaXMubmV3ID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnByb3BlcnR5ID0gcHJvcGVydHk7XG4gICAgICAgICAgICB0aGlzLmluaXRpYWxQcm9wZXJ0eS5uYW1lID0gcHJvcGVydHkubmFtZTtcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbFByb3BlcnR5LmlkID0gcHJvcGVydHkuaWQ7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhwcm9wZXJ0eS52YWx1ZXMpLmZvckVhY2goayA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsUHJvcGVydHkudmFsdWVzW2tdID0gcHJvcGVydHkudmFsdWVzW2tdO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgbmV3SWQgPSAxO1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMuZm9yRWFjaChwcm9wID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocGFyc2VJbnQocHJvcC5pZCkgJiYgcGFyc2VJbnQocHJvcC5pZCkgPj0gbmV3SWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3SWQgPSBwYXJzZUludChwcm9wLmlkKSArIDE7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eSA9IG5ldyBGaWVsZCgpO1xuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eS5pZCA9IG5ld0lkLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB0aGlzLmluaXRpYWxQcm9wZXJ0eS5pZCA9IG5ld0lkLnRvU3RyaW5nKCk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIGFzeW5jIG9uT3BlbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKHRoaXMucHJvcGVydHkubmFtZSA9PSBcIlwiKSB7XG4gICAgICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgQWRkIGEgcHJvcGVydHkgYW5kIHNldCBwcmVkZWZpbmVkYCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgTWFuYWdlIHNldHRpbmdzIHZhbHVlcyBmb3IgJHt0aGlzLnByb3BlcnR5Lm5hbWV9YCk7XG4gICAgICAgIH07XG4gICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlRm9ybSgpO1xuICAgIH07XG5cbiAgICBvbkNsb3NlKCk6IHZvaWQge1xuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMucHJvcGVydHksIHRoaXMuaW5pdGlhbFByb3BlcnR5KTtcbiAgICAgICAgaWYgKCF0aGlzLm5ldyAmJiB0aGlzLnBhcmVudFNldHRpbmcpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50U2V0dGluZy5pbmZvRWwudGV4dENvbnRlbnQgPVxuICAgICAgICAgICAgICAgIGAke3RoaXMucHJvcGVydHkubmFtZX06IFske09iamVjdC5rZXlzKHRoaXMucHJvcGVydHkudmFsdWVzKS5tYXAoayA9PiB0aGlzLnByb3BlcnR5LnZhbHVlc1trXSkuam9pbignLCAnKX1dYDtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNhdmVkKSB7XG4gICAgICAgICAgICBuZXcgRmllbGRTZXR0aW5nKHRoaXMucGFyZW50U2V0dGluZ0NvbnRhaW5lciwgdGhpcy5wcm9wZXJ0eSwgdGhpcy5hcHAsIHRoaXMucGx1Z2luKTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBzZXRWYWx1ZUxpc3RUZXh0KGhlYWRlcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgaGVhZGVyLnNldFRleHQoYFByZXNldCB2YWx1ZXM6ICR7T2JqZWN0LnZhbHVlcyh0aGlzLnByb3BlcnR5LnZhbHVlcykuam9pbignLCAnKX1gKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVuYW1lSW5wdXRDb250YWluZXIocGFyZW50Tm9kZTogSFRNTERpdkVsZW1lbnQpOiBUZXh0Q29tcG9uZW50IHtcbiAgICAgICAgY29uc3QgcHJvcGVydHlOYW1lQ29udGFpbmVyTGFiZWwgPSBwYXJlbnROb2RlLmNyZWF0ZURpdigpO1xuICAgICAgICBwcm9wZXJ0eU5hbWVDb250YWluZXJMYWJlbC5zZXRUZXh0KGBQcm9wZXJ0eSBOYW1lOmApO1xuICAgICAgICBjb25zdCBpbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KHBhcmVudE5vZGUpO1xuICAgICAgICBjb25zdCBuYW1lID0gdGhpcy5wcm9wZXJ0eS5uYW1lO1xuICAgICAgICBpbnB1dC5zZXRWYWx1ZShuYW1lKTtcbiAgICAgICAgaW5wdXQuc2V0UGxhY2Vob2xkZXIoXCJOYW1lIG9mIHRoZSBwcm9wZXJ0eVwiKTtcbiAgICAgICAgaW5wdXQub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eS5uYW1lID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgTWFuYWdlIHByZWRlZmluZWQgdmFsdWVzIGZvciAke3RoaXMucHJvcGVydHkubmFtZX1gKTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IoaW5wdXQpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGlucHV0O1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZVRvZ2dsZXJDb250YWluZXIocGFyZW50Tm9kZTogSFRNTERpdkVsZW1lbnQsIGxhYmVsOiBzdHJpbmcpOiBUb2dnbGVDb21wb25lbnQge1xuICAgICAgICBwYXJlbnROb2RlLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS10b2dnbGVcIilcbiAgICAgICAgY29uc3QgcHJvcGVydHlDb250YWluZXJMYWJlbCA9IHBhcmVudE5vZGUuY3JlYXRlRGl2KHsgY2xzOiAnZnJvbnRtYXR0ZXItY2hlY2tib3gtdG9nZ2xlcicgfSk7XG5cbiAgICAgICAgcHJvcGVydHlDb250YWluZXJMYWJlbC5zZXRUZXh0KGxhYmVsKTtcbiAgICAgICAgY29uc3QgdG9nZ2xlciA9IG5ldyBUb2dnbGVDb21wb25lbnQocGFyZW50Tm9kZSk7XG4gICAgICAgIHJldHVybiB0b2dnbGVyO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZUxpc3ROb3RlQ29udGFpbmVyKHBhcmVudE5vZGU6IEhUTUxEaXZFbGVtZW50KTogVGV4dENvbXBvbmVudCB7XG4gICAgICAgIGNvbnN0IGxpc3ROb3RlQ29udGFpbmVyTGFiZWwgPSBwYXJlbnROb2RlLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LWlucHV0XCIgfSk7XG4gICAgICAgIGxpc3ROb3RlQ29udGFpbmVyTGFiZWwuc2V0VGV4dChgUGF0aCBvZiB0aGUgbm90ZSBjb250YWluaW5nIHRoZSB2YWx1ZXM6YCk7XG5cbiAgICAgICAgY29uc3QgaW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudChsaXN0Tm90ZUNvbnRhaW5lckxhYmVsKTtcbiAgICAgICAgY29uc3QgbGlzdE5vdGVQYXRoID0gdGhpcy5wcm9wZXJ0eS52YWx1ZXNMaXN0Tm90ZVBhdGg7XG4gICAgICAgIGlucHV0LnNldFZhbHVlKGxpc3ROb3RlUGF0aCk7XG4gICAgICAgIGlucHV0LnNldFBsYWNlaG9sZGVyKFwiUGF0aC9vZi90aGUvbm90ZS5tZFwiKTtcbiAgICAgICAgaW5wdXQub25DaGFuZ2UodmFsdWUgPT4gdGhpcy5wcm9wZXJ0eS52YWx1ZXNMaXN0Tm90ZVBhdGggPSB2YWx1ZSk7XG4gICAgICAgIHJldHVybiBpbnB1dDtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSByZW1vdmVQcmVzZXRWYWx1ZShrZXk6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBsZXQgbmV3VmFsdWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gICAgICAgIGZvciAobGV0IF9rZXkgaW4gdGhpcy5wcm9wZXJ0eS52YWx1ZXMpIHtcbiAgICAgICAgICAgIGlmIChrZXkgIT09IF9rZXkpIHtcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZXNbX2tleV0gPSB0aGlzLnByb3BlcnR5LnZhbHVlc1tfa2V5XTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucHJvcGVydHkudmFsdWVzID0gbmV3VmFsdWVzO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZVZhbHVlQ29udGFpbmVyKHBhcmVudE5vZGU6IEhUTUxEaXZFbGVtZW50LCBoZWFkZXI6IEhUTUxEaXZFbGVtZW50LCBrZXk6IHN0cmluZyk6IFRleHRDb21wb25lbnQge1xuICAgICAgICBjb25zdCB2YWx1ZXMgPSB0aGlzLnByb3BlcnR5LnZhbHVlcztcbiAgICAgICAgY29uc3QgcHJlc2V0VmFsdWUgPSB2YWx1ZXNba2V5XTtcbiAgICAgICAgY29uc3QgdmFsdWVDb250YWluZXIgPSBwYXJlbnROb2RlLmNyZWF0ZURpdih7XG4gICAgICAgICAgICBjbHM6ICdtZXRhZGF0YS1tZW51LXByb21wdC1jb250YWluZXInLFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgaW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgICAgIGlucHV0LnNldFZhbHVlKHByZXNldFZhbHVlKTtcbiAgICAgICAgaW5wdXQub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eS52YWx1ZXNba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5zZXRWYWx1ZUxpc3RUZXh0KGhlYWRlcik7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKGlucHV0KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHZhbHVlUmVtb3ZlQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgICAgIHZhbHVlUmVtb3ZlQnV0dG9uLnNldEljb24oXCJ0cmFzaFwiKVxuICAgICAgICAgICAgLm9uQ2xpY2soKGV2dDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdDtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVByZXNldFZhbHVlKGtleSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRWYWx1ZUxpc3RUZXh0KGhlYWRlcik7XG4gICAgICAgICAgICAgICAgcGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZXNQcm9tcHRDb21wb25lbnRzLnJlbW92ZShpbnB1dCk7XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICBpZiAoa2V5ICE9IE9iamVjdC5rZXlzKHRoaXMucHJvcGVydHkudmFsdWVzKVswXSkge1xuICAgICAgICAgICAgY29uc3QgdmFsdWVVcGdyYWRlQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgICAgICAgICB2YWx1ZVVwZ3JhZGVCdXR0b24uc2V0QnV0dG9uVGV4dChcIlx1MjVCMlwiKTtcbiAgICAgICAgICAgIHZhbHVlVXBncmFkZUJ1dHRvbi5vbkNsaWNrKChldnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB0aGlzVmFsdWUgPSB2YWx1ZXNba2V5XTtcbiAgICAgICAgICAgICAgICBjb25zdCBpbnB1dEluZGV4ID0gdGhpcy52YWx1ZXNQcm9tcHRDb21wb25lbnRzLmluZGV4T2YoaW5wdXQpXG4gICAgICAgICAgICAgICAgY29uc3QgdXBwZXJDb21wb25lbnQgPSBpbnB1dEluZGV4ICE9PSAtMSA/IHRoaXMudmFsdWVzUHJvbXB0Q29tcG9uZW50c1tpbnB1dEluZGV4IC0gMV0gOiB0aGlzLnZhbHVlc1Byb21wdENvbXBvbmVudHMubGFzdCgpO1xuICAgICAgICAgICAgICAgIGlmICh1cHBlckNvbXBvbmVudCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB1cHBlclZhbHVlID0gdXBwZXJDb21wb25lbnQuaW5wdXRFbC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXBwZXJLZXkgPSBPYmplY3Qua2V5cyh2YWx1ZXMpLmZpbHRlcihrID0+IHZhbHVlc1trXSA9PSB1cHBlclZhbHVlKVswXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVwcGVyS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cHBlckNvbXBvbmVudC5zZXRWYWx1ZSh0aGlzVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzW3VwcGVyS2V5XSA9IHRoaXNWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LnNldFZhbHVlKHVwcGVyVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSB1cHBlclZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gaW5wdXQ7XG4gICAgfTtcblxuICAgIHByaXZhdGUgYXN5bmMgY3JlYXRlRm9ybSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZGl2ID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHtcbiAgICAgICAgICAgIGNsczogXCJtZXRhZGF0YS1tZW51LXByb21wdC1kaXZcIlxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgbWFpbkRpdiA9IGRpdi5jcmVhdGVEaXYoe1xuICAgICAgICAgICAgY2xzOiBcIm1ldGFkYXRhLW1lbnUtcHJvbXB0LWZvcm1cIlxuICAgICAgICB9KTtcbiAgICAgICAgLyogUHJvcGVydHkgTmFtZSBTZWN0aW9uICovXG4gICAgICAgIGNvbnN0IG5hbWVDb250YWluZXIgPSBtYWluRGl2LmNyZWF0ZURpdigpO1xuICAgICAgICB0aGlzLm5hbWVQcm9tcHRDb21wb25lbnQgPSB0aGlzLmNyZWF0ZW5hbWVJbnB1dENvbnRhaW5lcihuYW1lQ29udGFpbmVyKTtcblxuICAgICAgICBtYWluRGl2LmNyZWF0ZURpdih7IGNsczogJ21ldGFkYXRhLW1lbnUtc2VwYXJhdG9yJyB9KS5jcmVhdGVFbChcImhyXCIpO1xuXG4gICAgICAgIC8qIFByb3BlcnR5IGlzIEJvb2xlYW4gc2VjdGlvbiAqL1xuICAgICAgICBjb25zdCBib29sZWFuQ29udGFpbmVyID0gbWFpbkRpdi5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS10b2dnbGVcIiB9KTtcbiAgICAgICAgdGhpcy5pc0Jvb2xlYW5Ub2dnbGVyQ29tcG9uZW50ID0gdGhpcy5jcmVhdGVUb2dnbGVyQ29udGFpbmVyKGJvb2xlYW5Db250YWluZXIsIFwiSXMgQm9vbGVhbjogXCIpO1xuICAgICAgICB0aGlzLmlzQm9vbGVhblRvZ2dsZXJDb21wb25lbnQuc2V0VmFsdWUodGhpcy5wcm9wZXJ0eS5pc0Jvb2xlYW4pO1xuICAgICAgICB0aGlzLmlzQm9vbGVhblRvZ2dsZXJDb21wb25lbnQuc2V0VG9vbHRpcChcIklzIHRoaXMgcHJvcGVydHkgdHJ1ZSBvciBmYWxzZSBvbmx5P1wiKVxuICAgICAgICB0aGlzLmlzQm9vbGVhblRvZ2dsZXJDb21wb25lbnQub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eS5pc0Jvb2xlYW4gPSB2YWx1ZTtcbiAgICAgICAgICAgIGlmICgodGhpcy5wcm9wZXJ0eS5pc011bHRpIHx8IHRoaXMucHJvcGVydHkuaXNDeWNsZSkgJiYgdGhpcy5wcm9wZXJ0eS5pc0Jvb2xlYW4pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BlcnR5LmlzTXVsdGkgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLmlzTXVsdGlUb2dnbGVyQ29tcG9uZW50LnNldFZhbHVlKGZhbHNlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BlcnR5LmlzQ3ljbGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLmlzQ3ljbGVUb2dnbGVyQ29tcG9uZW50LnNldFZhbHVlKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgICAvKiBQcm9wZXJ0eSBpcyBNdWx0aSBzZWN0aW9uKi9cblxuICAgICAgICBjb25zdCBtdWx0aUNvbnRhaW5lciA9IG1haW5EaXYuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdG9nZ2xlXCIgfSk7XG4gICAgICAgIHRoaXMuaXNNdWx0aVRvZ2dsZXJDb21wb25lbnQgPSB0aGlzLmNyZWF0ZVRvZ2dsZXJDb250YWluZXIobXVsdGlDb250YWluZXIsIFwiSXMgTXVsdGk6IFwiKTtcbiAgICAgICAgdGhpcy5pc011bHRpVG9nZ2xlckNvbXBvbmVudC5zZXRWYWx1ZSh0aGlzLnByb3BlcnR5LmlzTXVsdGkpO1xuICAgICAgICB0aGlzLmlzTXVsdGlUb2dnbGVyQ29tcG9uZW50LnNldFRvb2x0aXAoXCJDYW4gdGhpcyBwcm9wZXJ0eSBoYXZlIG11bHRpcGxlIHZhbHVlcz9cIik7XG4gICAgICAgIHRoaXMuaXNNdWx0aVRvZ2dsZXJDb21wb25lbnQub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eS5pc011bHRpID0gdmFsdWU7XG4gICAgICAgICAgICBpZiAodGhpcy5wcm9wZXJ0eS5pc0N5Y2xlICYmIHRoaXMucHJvcGVydHkuaXNNdWx0aSkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJvcGVydHkuaXNDeWNsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuaXNDeWNsZVRvZ2dsZXJDb21wb25lbnQuc2V0VmFsdWUoZmFsc2UpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLyogUHJvcGVydHkgaXMgQ3ljbGUgc2VjdGlvbiovXG5cbiAgICAgICAgY29uc3QgY3ljbGVDb250YWluZXIgPSBtYWluRGl2LmNyZWF0ZURpdigpO1xuICAgICAgICB0aGlzLmlzQ3ljbGVUb2dnbGVyQ29tcG9uZW50ID0gdGhpcy5jcmVhdGVUb2dnbGVyQ29udGFpbmVyKGN5Y2xlQ29udGFpbmVyLCBcIklzIEN5Y2xlOiBcIik7XG4gICAgICAgIHRoaXMuaXNDeWNsZVRvZ2dsZXJDb21wb25lbnQuc2V0VmFsdWUodGhpcy5wcm9wZXJ0eS5pc0N5Y2xlKTtcbiAgICAgICAgdGhpcy5pc0N5Y2xlVG9nZ2xlckNvbXBvbmVudC5zZXRUb29sdGlwKFwiSXMgdGhpcyBwcm9wZXJ0eSdzIHZhbHVlcyBzZXQgaW4gY3ljbGUgbW9kZT9cIik7XG4gICAgICAgIHRoaXMuaXNDeWNsZVRvZ2dsZXJDb21wb25lbnQub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eS5pc0N5Y2xlID0gdmFsdWU7XG4gICAgICAgICAgICBpZiAodGhpcy5wcm9wZXJ0eS5pc0N5Y2xlICYmIHRoaXMucHJvcGVydHkuaXNNdWx0aSkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJvcGVydHkuaXNNdWx0aSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuaXNNdWx0aVRvZ2dsZXJDb21wb25lbnQuc2V0VmFsdWUoZmFsc2UpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbWFpbkRpdi5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXNlcGFyYXRvcicgfSkuY3JlYXRlRWwoXCJoclwiKTtcblxuICAgICAgICAvKiBQcm9wZXJ0eSdzIG5vdGUgZm9yIGxpc3Qgb2YgVmFsdWVzICovXG5cbiAgICAgICAgY29uc3QgbGlzdE5vdGVQYXRoQ29udGFpbmVyID0gbWFpbkRpdi5jcmVhdGVEaXYoKTtcbiAgICAgICAgdGhpcy5jcmVhdGVMaXN0Tm90ZUNvbnRhaW5lcihsaXN0Tm90ZVBhdGhDb250YWluZXIpO1xuXG4gICAgICAgIG1haW5EaXYuY3JlYXRlRGl2KHsgY2xzOiAnbWV0YWRhdGEtbWVudS1zZXBhcmF0b3InIH0pLmNyZWF0ZUVsKFwiaHJcIik7XG5cbiAgICAgICAgLyogUHJvcGVydHkgVmFsdWVzICovXG4gICAgICAgIGNvbnN0IHZhbHVlc0xpc3QgPSBtYWluRGl2LmNyZWF0ZURpdigpO1xuICAgICAgICBjb25zdCB2YWx1ZXNMaXN0SGVhZGVyID0gdmFsdWVzTGlzdC5jcmVhdGVEaXYoKTtcbiAgICAgICAgdmFsdWVzTGlzdEhlYWRlci5jcmVhdGVFbChcImgyXCIpO1xuICAgICAgICB2YWx1ZXNMaXN0SGVhZGVyLnNldFRleHQoYFByZXNldCB2YWx1ZXM6ICR7T2JqZWN0LnZhbHVlcyh0aGlzLnByb3BlcnR5LnZhbHVlcykuam9pbignLCAnKX1gKTtcbiAgICAgICAgY29uc3QgdmFsdWVzTGlzdEJvZHkgPSB2YWx1ZXNMaXN0LmNyZWF0ZURpdigpO1xuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLnByb3BlcnR5LnZhbHVlcykuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgICAgdGhpcy52YWx1ZXNQcm9tcHRDb21wb25lbnRzLnB1c2godGhpcy5jcmVhdGVWYWx1ZUNvbnRhaW5lcih2YWx1ZXNMaXN0Qm9keSwgdmFsdWVzTGlzdEhlYWRlciwga2V5KSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8qIEFkZCBhIG5ldyBWYWx1ZXMgKi9cbiAgICAgICAgY29uc3QgdmFsdWVzTGlzdEZvb3RlciA9IHZhbHVlc0xpc3QuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnN0IGFkZFZhbHVlID0gdmFsdWVzTGlzdEZvb3Rlci5jcmVhdGVFbCgnYnV0dG9uJyk7XG4gICAgICAgIGFkZFZhbHVlLnR5cGUgPSAnYnV0dG9uJztcbiAgICAgICAgYWRkVmFsdWUudGV4dENvbnRlbnQgPSAnQWRkJztcbiAgICAgICAgYWRkVmFsdWUub25DbGlja0V2ZW50KGFzeW5jIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdDtcbiAgICAgICAgICAgIGNvbnN0IG5ld0tleSA9IGF3YWl0IHRoaXMucHJvcGVydHkuaW5zZXJ0TmV3VmFsdWUoXCJcIilcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlVmFsdWVDb250YWluZXIodmFsdWVzTGlzdEJvZHksIHZhbHVlc0xpc3RIZWFkZXIsIG5ld0tleSlcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbWFpbkRpdi5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXNlcGFyYXRvcicgfSkuY3JlYXRlRWwoXCJoclwiKTtcblxuICAgICAgICAvKiBmb290ZXIgYnV0dG9ucyovXG4gICAgICAgIGNvbnN0IGZvb3RlckVsID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnN0IGZvb3RlckJ1dHRvbnMgPSBuZXcgU2V0dGluZyhmb290ZXJFbCk7XG4gICAgICAgIGZvb3RlckJ1dHRvbnMuYWRkQnV0dG9uKChiKSA9PiB0aGlzLmNyZWF0ZVNhdmVCdXR0b24oYikpO1xuICAgICAgICBmb290ZXJCdXR0b25zLmFkZEV4dHJhQnV0dG9uKChiKSA9PiB0aGlzLmNyZWF0ZUNhbmNlbEJ1dHRvbihiKSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgY3JlYXRlU2F2ZUJ1dHRvbihiOiBCdXR0b25Db21wb25lbnQpOiBCdXR0b25Db21wb25lbnQge1xuICAgICAgICBiLnNldFRvb2x0aXAoXCJTYXZlXCIpXG4gICAgICAgICAgICAuc2V0SWNvbihcImNoZWNrbWFya1wiKVxuICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBlcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmICgvXlsjPi1dLy50ZXN0KHRoaXMucHJvcGVydHkubmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnNldFZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubmFtZVByb21wdENvbXBvbmVudCwgdGhpcy5uYW1lUHJvbXB0Q29tcG9uZW50LmlucHV0RWwsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlByb3BlcnR5IG5hbWUgY2Fubm90IHN0YXJ0IHdpdGggIywgPiwgLVwiXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnByb3BlcnR5Lm5hbWUgPT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwuc2V0VmFsaWRhdGlvbkVycm9yKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uYW1lUHJvbXB0Q29tcG9uZW50LCB0aGlzLm5hbWVQcm9tcHRDb21wb25lbnQuaW5wdXRFbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiUHJvcGVydHkgbmFtZSBjYW4gbm90IGJlIEVtcHR5XCJcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZXNQcm9tcHRDb21wb25lbnRzLmZvckVhY2goaW5wdXQgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoL15bIz4tXS8udGVzdChpbnB1dC5pbnB1dEVsLnZhbHVlKSAmJiBpbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQ/Lmxhc3RFbGVtZW50Q2hpbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5zZXRWYWxpZGF0aW9uRXJyb3IoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQsIGlucHV0LmlucHV0RWwucGFyZW50RWxlbWVudC5sYXN0RWxlbWVudENoaWxkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiVmFsdWVzIGNhbm5vdCBjYW5ub3Qgc3RhcnQgd2l0aCAjLCA+LCAtXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGlmICgvWyxdL2d1LnRlc3QoaW5wdXQuaW5wdXRFbC52YWx1ZSkgJiYgaW5wdXQuaW5wdXRFbC5wYXJlbnRFbGVtZW50Py5sYXN0RWxlbWVudENoaWxkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwuc2V0VmFsaWRhdGlvbkVycm9yKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LCBpbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQubGFzdEVsZW1lbnRDaGlsZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlZhbHVlcyBjYW5ub3QgY29udGFpbiBhIGNvbW1hXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbnB1dC5pbnB1dEVsLnZhbHVlID09IFwiXCIgJiYgaW5wdXQuaW5wdXRFbC5wYXJlbnRFbGVtZW50Py5sYXN0RWxlbWVudENoaWxkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwuc2V0VmFsaWRhdGlvbkVycm9yKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LCBpbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQubGFzdEVsZW1lbnRDaGlsZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlZhbHVlcyBjYW4ndCBiZSBudWxsLlwiXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiRml4IGVycm9ycyBiZWZvcmUgc2F2aW5nLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEV4aXN0aW5nUHJvcGVydHkgPSB0aGlzLnBsdWdpbi5pbml0aWFsUHJvcGVydGllcy5maWx0ZXIocCA9PiBwLmlkID09IHRoaXMucHJvcGVydHkuaWQpWzBdO1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50RXhpc3RpbmdQcm9wZXJ0eSkge1xuICAgICAgICAgICAgICAgICAgICBGaWVsZC5jb3B5UHJvcGVydHkoY3VycmVudEV4aXN0aW5nUHJvcGVydHksIHRoaXMucHJvcGVydHkpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmluaXRpYWxQcm9wZXJ0aWVzLnB1c2godGhpcy5wcm9wZXJ0eSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRpYWxQcm9wZXJ0eSA9IHRoaXMucHJvcGVydHk7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBiO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZUNhbmNlbEJ1dHRvbihiOiBFeHRyYUJ1dHRvbkNvbXBvbmVudCk6IEV4dHJhQnV0dG9uQ29tcG9uZW50IHtcbiAgICAgICAgYi5zZXRJY29uKFwiY3Jvc3NcIilcbiAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiQ2FuY2VsXCIpXG4gICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIC8qIHJlc2V0IHZhbHVlcyBmcm9tIHNldHRpbmdzICovXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbFByb3BlcnR5Lm5hbWUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMucHJvcGVydHksIHRoaXMuaW5pdGlhbFByb3BlcnR5KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gYjtcbiAgICB9O1xuXG4gICAgLyogdXRpbHMgZnVuY3Rpb25zICovXG5cbiAgICBwcml2YXRlIHN0YXRpYyBzZXRWYWxpZGF0aW9uRXJyb3IodGV4dElucHV0OiBUZXh0Q29tcG9uZW50LCBpbnNlcnRBZnRlcjogRWxlbWVudCwgbWVzc2FnZT86IHN0cmluZykge1xuICAgICAgICB0ZXh0SW5wdXQuaW5wdXRFbC5hZGRDbGFzcyhcImlzLWludmFsaWRcIik7XG4gICAgICAgIGlmIChtZXNzYWdlICYmIHRleHRJbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQ/Lmxhc3RFbGVtZW50Q2hpbGQpIHtcblxuICAgICAgICAgICAgbGV0IG1EaXYgPSB0ZXh0SW5wdXQuaW5wdXRFbC5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICAgICAgXCIuaW52YWxpZC1mZWVkYmFja1wiXG4gICAgICAgICAgICApIGFzIEhUTUxEaXZFbGVtZW50O1xuXG4gICAgICAgICAgICBpZiAoIW1EaXYpIHtcbiAgICAgICAgICAgICAgICBtRGl2ID0gY3JlYXRlRGl2KHsgY2xzOiBcImludmFsaWQtZmVlZGJhY2tcIiB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1EaXYuaW5uZXJUZXh0ID0gbWVzc2FnZTtcbiAgICAgICAgICAgIG1EaXYuaW5zZXJ0QWZ0ZXIoaW5zZXJ0QWZ0ZXIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHByaXZhdGUgc3RhdGljIHJlbW92ZVZhbGlkYXRpb25FcnJvcih0ZXh0SW5wdXQ6IFRleHRDb21wb25lbnQpIHtcbiAgICAgICAgaWYgKHRleHRJbnB1dC5pbnB1dEVsLmhhc0NsYXNzKFwiaXMtaW52YWxpZFwiKSAmJiB0ZXh0SW5wdXQuaW5wdXRFbC5wYXJlbnRFbGVtZW50Py5sYXN0RWxlbWVudENoaWxkKSB7XG4gICAgICAgICAgICB0ZXh0SW5wdXQuaW5wdXRFbC5yZW1vdmVDbGFzcyhcImlzLWludmFsaWRcIilcbiAgICAgICAgICAgIHRleHRJbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQoXG4gICAgICAgICAgICAgICAgdGV4dElucHV0LmlucHV0RWwucGFyZW50RWxlbWVudC5sYXN0RWxlbWVudENoaWxkXG4gICAgICAgICAgICApO1xuICAgICAgICB9O1xuICAgIH07XG59OyIsICJpbnRlcmZhY2UgRmllbGQge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHZhbHVlczogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgICBpc0N5Y2xlOiBib29sZWFuO1xuICAgIGlzTXVsdGk6IGJvb2xlYW47XG4gICAgaXNCb29sZWFuOiBib29sZWFuO1xuICAgIHZhbHVlc0xpc3ROb3RlUGF0aDogc3RyaW5nO1xufVxuXG5jbGFzcyBGaWVsZCB7XG5cbiAgICBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcgPSBcIlwiLFxuICAgICAgICB2YWx1ZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fSxcbiAgICAgICAgaWQ6IHN0cmluZyA9IFwiXCIsXG4gICAgICAgIGlzTXVsdGk6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgaXNDeWNsZTogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBpc0Jvb2xlYW46IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgdmFsdWVzTGlzdE5vdGVQYXRoOiBzdHJpbmcgPSBcIlwiKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMudmFsdWVzID0gdmFsdWVzO1xuICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgIHRoaXMuaXNCb29sZWFuID0gaXNCb29sZWFuXG4gICAgICAgIHRoaXMuaXNDeWNsZSA9IGlzQ3ljbGU7XG4gICAgICAgIHRoaXMuaXNNdWx0aSA9IGlzTXVsdGk7XG4gICAgICAgIHRoaXMudmFsdWVzTGlzdE5vdGVQYXRoID0gdmFsdWVzTGlzdE5vdGVQYXRoO1xuICAgICAgICB0aGlzLmluc2VydE5ld1ZhbHVlLmJpbmQodGhpcyk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBhc3luYyBpbnNlcnROZXdWYWx1ZSh2YWx1ZTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgbGV0IG5ld0tleSA9IDE7XG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMudmFsdWVzKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICBpZiAocGFyc2VJbnQoa2V5KSAmJiBwYXJzZUludChrZXkpID49IG5ld0tleSkge1xuICAgICAgICAgICAgICAgIG5ld0tleSA9IHBhcnNlSW50KGtleSkgKyAxO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMudmFsdWVzW25ld0tleS50b1N0cmluZygpXSA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gbmV3S2V5LnRvU3RyaW5nKCk7XG4gICAgfTtcblxuICAgIHN0YXRpYyBjb3B5UHJvcGVydHkodGFyZ2V0OiBGaWVsZCwgc291cmNlOiBGaWVsZCkge1xuICAgICAgICB0YXJnZXQuaWQgPSBzb3VyY2UuaWQ7XG4gICAgICAgIHRhcmdldC5uYW1lID0gc291cmNlLm5hbWU7XG4gICAgICAgIHRhcmdldC5pc0Jvb2xlYW4gPSBzb3VyY2UuaXNCb29sZWFuXG4gICAgICAgIHRhcmdldC5pc0N5Y2xlID0gc291cmNlLmlzQ3ljbGU7XG4gICAgICAgIHRhcmdldC5pc011bHRpID0gc291cmNlLmlzTXVsdGk7XG4gICAgICAgIHRhcmdldC52YWx1ZXNMaXN0Tm90ZVBhdGggPSBzb3VyY2UudmFsdWVzTGlzdE5vdGVQYXRoO1xuICAgICAgICBPYmplY3Qua2V5cyhzb3VyY2UudmFsdWVzKS5mb3JFYWNoKGsgPT4ge1xuICAgICAgICAgICAgdGFyZ2V0LnZhbHVlc1trXSA9IHNvdXJjZS52YWx1ZXNba107XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3Qua2V5cyh0YXJnZXQudmFsdWVzKS5mb3JFYWNoKGsgPT4ge1xuICAgICAgICAgICAgaWYgKCFPYmplY3Qua2V5cyhzb3VyY2UudmFsdWVzKS5pbmNsdWRlcyhrKSkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0YXJnZXQudmFsdWVzW2tdO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IEZpZWxkOyIsICJpbXBvcnQgeyBBcHAsIFNldHRpbmcsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9GaWVsZFwiO1xuaW1wb3J0IEZpZWxkU2V0dGluZ3NNb2RhbCBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ3NNb2RhbFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWVsZFNldHRpbmcgZXh0ZW5kcyBTZXR0aW5nIHtcbiAgICBwcml2YXRlIHByb3BlcnR5OiBGaWVsZDtcbiAgICBwcml2YXRlIGFwcDogQXBwO1xuICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnU7XG4gICAgcHJpdmF0ZSBjb250YWluZXJFbDogSFRNTEVsZW1lbnQ7XG4gICAgY29uc3RydWN0b3IoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBwcm9wZXJ0eTogRmllbGQsIGFwcDogQXBwLCBwbHVnaW46IE1ldGFkYXRhTWVudSkge1xuICAgICAgICBzdXBlcihjb250YWluZXJFbCk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwgPSBjb250YWluZXJFbDtcbiAgICAgICAgdGhpcy5wcm9wZXJ0eSA9IHByb3BlcnR5O1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIHRoaXMuc2V0VGV4dENvbnRlbnRXaXRobmFtZSgpO1xuICAgICAgICB0aGlzLmFkZEVkaXRCdXR0b24oKTtcbiAgICAgICAgdGhpcy5hZGREZWxldGVCdXR0b24oKTtcblxuICAgIH07XG5cbiAgICBwcml2YXRlIHNldFRleHRDb250ZW50V2l0aG5hbWUoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHZhbHVlcyA9ICF0aGlzLnByb3BlcnR5LmlzQm9vbGVhbiA/IGBbJHtPYmplY3Qua2V5cyh0aGlzLnByb3BlcnR5LnZhbHVlcykubWFwKGsgPT4gdGhpcy5wcm9wZXJ0eS52YWx1ZXNba10pLmpvaW4oJywgJyl9XWAgOiBcIlwiXG4gICAgICAgIGxldCB0eXBlID0gXCJzaW5nbGVcIlxuICAgICAgICBpZiAodGhpcy5wcm9wZXJ0eS5pc0Jvb2xlYW4pIHR5cGUgPSBcImJvb2xlYW5cIlxuICAgICAgICBpZiAodGhpcy5wcm9wZXJ0eS5pc011bHRpKSB0eXBlID0gXCJtdWx0aVwiXG4gICAgICAgIGlmICh0aGlzLnByb3BlcnR5LmlzQ3ljbGUpIHR5cGUgPSBcImN5Y2xlXCJcbiAgICAgICAgdGhpcy5pbmZvRWwudGV4dENvbnRlbnQgPVxuICAgICAgICAgICAgYCR7dGhpcy5wcm9wZXJ0eS5uYW1lfTogJHt2YWx1ZXN9YDtcbiAgICAgICAgY29uc3QgdHlwZUNvbnRhaW5lciA9IHRoaXMuaW5mb0VsLmNyZWF0ZUVsKFwic3BhblwiLCBgbWV0YWRhdGEtbWVudS1zZXR0aW5nLWl0ZW0taW5mby10eXBlICR7dHlwZX1gKVxuICAgICAgICB0eXBlQ29udGFpbmVyLnNldFRleHQodHlwZSlcblxuICAgIH07XG5cblxuICAgIHByaXZhdGUgYWRkRWRpdEJ1dHRvbigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5hZGRCdXR0b24oKGIpID0+IHtcbiAgICAgICAgICAgIGIuc2V0SWNvbihcInBlbmNpbFwiKVxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiRWRpdFwiKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IG1vZGFsID0gbmV3IEZpZWxkU2V0dGluZ3NNb2RhbCh0aGlzLmFwcCwgdGhpcy5wbHVnaW4sIHRoaXMuY29udGFpbmVyRWwsIHRoaXMsIHRoaXMucHJvcGVydHkpO1xuICAgICAgICAgICAgICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGFkZERlbGV0ZUJ1dHRvbigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5hZGRCdXR0b24oKGIpID0+IHtcbiAgICAgICAgICAgIGIuc2V0SWNvbihcInRyYXNoXCIpXG4gICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoXCJEZWxldGVcIilcbiAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRFeGlzdGluZ1Byb3BlcnR5ID0gdGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMuZmlsdGVyKHAgPT4gcC5pZCA9PSB0aGlzLnByb3BlcnR5LmlkKVswXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRFeGlzdGluZ1Byb3BlcnR5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5pbml0aWFsUHJvcGVydGllcy5yZW1vdmUoY3VycmVudEV4aXN0aW5nUHJvcGVydHkpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdFbC5wYXJlbnRFbGVtZW50Py5yZW1vdmVDaGlsZCh0aGlzLnNldHRpbmdFbCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBnZXRWYWx1ZXNMaXN0RnJvbU5vdGUobm90ZVBhdGg6IHN0cmluZywgYXBwOiBBcHApOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgICAgIGxldCB2YWx1ZXM6IEFycmF5PHN0cmluZz4gPSBbXTtcbiAgICAgICAgY29uc3QgZmlsZSA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobm90ZVBhdGgpO1xuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYXBwLnZhdWx0LnJlYWQoZmlsZSlcbiAgICAgICAgICAgIHJlc3VsdC5zcGxpdCgnXFxuJykuZm9yRWFjaChsaW5lID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoL14oLiopJC8udGVzdChsaW5lKSkge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZXMucHVzaChsaW5lLnRyaW0oKSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlcztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfTtcbiAgICB9O1xufTsiLCAiaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvRmllbGRcIjtcblxuZXhwb3J0IGludGVyZmFjZSBNZXRhZGF0YU1lbnVTZXR0aW5ncyB7XG5cdHByZXNldEZpZWxkczogQXJyYXk8RmllbGQ+O1xuXHRkaXNwbGF5RmllbGRzSW5Db250ZXh0TWVudTogYm9vbGVhbjtcblx0Z2xvYmFsbHlJZ25vcmVkRmllbGRzOiBBcnJheTxzdHJpbmc+O1xuXHRnZXRGcm9tSW5saW5lRmllbGQ6IGJvb2xlYW47XG5cdGNsYXNzRmlsZXNQYXRoOiBzdHJpbmc7XG5cdGlzQXV0b3N1Z2dlc3RFbmFibGVkOiBib29sZWFuO1xuXHRmaWxlQ2xhc3NBbGlhczogc3RyaW5nO1xufVxuXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogTWV0YWRhdGFNZW51U2V0dGluZ3MgPSB7XG5cdHByZXNldEZpZWxkczogW10sXG5cdGRpc3BsYXlGaWVsZHNJbkNvbnRleHRNZW51OiB0cnVlLFxuXHRnbG9iYWxseUlnbm9yZWRGaWVsZHM6IFtdLFxuXHRjbGFzc0ZpbGVzUGF0aDogXCJcIixcblx0Z2V0RnJvbUlubGluZUZpZWxkOiB0cnVlLFxuXHRpc0F1dG9zdWdnZXN0RW5hYmxlZDogdHJ1ZSxcblx0ZmlsZUNsYXNzQWxpYXM6IFwiZmlsZUNsYXNzXCJcbn07IiwgImV4cG9ydCBjb25zdCBmaWVsZENvbXBvbmVudHMgPSBbJ3N0YXJ0U3R5bGUnLCAnYXR0cmlidXRlJywgJ2VuZFN0eWxlJywgJ2JlZm9yZVNlcGFyYXRvclNwYWNlcicsICdhZnRlclNlcGFyYXRvclNwYWNlcicsICd2YWx1ZXMnXVxuXG5leHBvcnQgY29uc3QgZ2VuZXJpY0ZpZWxkUmVnZXggPSBcIig/PHN0YXJ0U3R5bGU+W19cXFxcKn5gXSopKD88YXR0cmlidXRlPlswLTlcXFxcd1xcXFxwe0xldHRlcn1cXFxccHtFbW9qaV9QcmVzZW50YXRpb259XVstMC05XFxcXHdcXFxccHtMZXR0ZXJ9XFxcXHB7RW1vamlfUHJlc2VudGF0aW9ufVxcXFxzXSopKD88ZW5kU3R5bGU+W19cXFxcKn5gXSopKD88YmVmb3JlU2VwYXJhdG9yU3BhY2VyPlxcXFxzKilcIjtcblxuZXhwb3J0IGNvbnN0IGlubGluZUZpZWxkUmVnZXggPSAoYXR0cmlidXRlOiBzdHJpbmcpID0+IG5ldyBSZWdFeHAoYCg/PHN0YXJ0U3R5bGU+W19cXCp+XFxgXSopKD88YXR0cmlidXRlPiR7YXR0cmlidXRlfSkoPzxlbmRTdHlsZT5bX1xcKn5cXGBdKikoPzxiZWZvcmVTZXBhcmF0b3JTcGFjZXI+XFxcXHMqKTo6KD88YWZ0ZXJTZXBhcmF0b3JTcGFjZXI+XFxcXHMqKSg/PHZhbHVlcz4uKilgLCAndScpOyIsICJpbXBvcnQgeyBBcHAsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCJcbmltcG9ydCB7IGlubGluZUZpZWxkUmVnZXggfSBmcm9tIFwic3JjL3V0aWxzL3BhcnNlclwiO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VmFsdWVzKGFwcDogQXBwLCBmaWxlOiBURmlsZSwgYXR0cmlidXRlOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgY29uc3QgY29udGVudCA9IGF3YWl0IChhd2FpdCBhcHAudmF1bHQuY2FjaGVkUmVhZChmaWxlKSkuc3BsaXQoJ1xcbicpO1xuICAgIGNvbnN0IGZyb250bWF0dGVyID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk/LmZyb250bWF0dGVyO1xuICAgIGNvbnN0IHsgcG9zaXRpb246IHsgc3RhcnQsIGVuZCB9IH0gPSBmcm9udG1hdHRlciB8fCBudWxsO1xuICAgIGNvbnN0IHJlc3VsdDogc3RyaW5nW10gPSBbXTtcbiAgICBjb250ZW50Lm1hcCgobGluZSwgaSkgPT4ge1xuICAgICAgICBpZiAoZnJvbnRtYXR0ZXIgJiYgaSA+PSBzdGFydC5saW5lICYmIGkgPD0gZW5kLmxpbmUpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgJHthdHRyaWJ1dGV9OiguKilgLCAndScpO1xuICAgICAgICAgICAgY29uc3QgciA9IGxpbmUubWF0Y2gocmVnZXgpO1xuICAgICAgICAgICAgaWYgKHIgJiYgci5sZW5ndGggPiAwKSByZXN1bHQucHVzaChyWzFdKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHJlZ2V4ID0gaW5saW5lRmllbGRSZWdleChhdHRyaWJ1dGUpO1xuICAgICAgICAgICAgY29uc3QgciA9IGxpbmUubWF0Y2gocmVnZXgpO1xuICAgICAgICAgICAgaWYgKHI/Lmdyb3VwcykgcmVzdWx0LnB1c2goci5ncm91cHMudmFsdWVzKTtcbiAgICAgICAgfVxuICAgIH0pXG4gICAgcmV0dXJuIHJlc3VsdDtcbn0iLCAiaW1wb3J0IHsgQXBwLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgZmllbGRDb21wb25lbnRzLCBpbmxpbmVGaWVsZFJlZ2V4IH0gZnJvbSBcInNyYy91dGlscy9wYXJzZXJcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcGxhY2VWYWx1ZXMoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBhdHRyaWJ1dGU6IHN0cmluZywgaW5wdXQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCAoYXdhaXQgYXBwLnZhdWx0LmNhY2hlZFJlYWQoZmlsZSkpLnNwbGl0KCdcXG4nKTtcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpPy5mcm9udG1hdHRlcjtcbiAgICBjb25zdCBzdGFydCA9IGZyb250bWF0dGVyID8gZnJvbnRtYXR0ZXIucG9zaXRpb24uc3RhcnQgOiBudWxsXG4gICAgY29uc3QgZW5kID0gZnJvbnRtYXR0ZXIgPyBmcm9udG1hdHRlci5wb3NpdGlvbi5lbmQgOiBudWxsXG4gICAgY29uc3QgbmV3Q29udGVudCA9IGNvbnRlbnQubWFwKChsaW5lLCBpKSA9PiB7XG4gICAgICAgIGlmIChmcm9udG1hdHRlciAmJiBpID49IHN0YXJ0LmxpbmUgJiYgaSA8PSBlbmQubGluZSkge1xuICAgICAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGAke2F0dHJpYnV0ZX06YCwgJ3UnKTtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBsaW5lLm1hdGNoKHJlZ2V4KTtcbiAgICAgICAgICAgIGlmIChyICYmIHIubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0QXJyYXkgPSBpbnB1dCA/IGlucHV0LnJlcGxhY2UoLyhcXCxcXHMrKS9nLCAnLCcpLnNwbGl0KCcsJykgOiBbXCJcIl07XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSBpbnB1dEFycmF5Lmxlbmd0aCA9PSAxID8gaW5wdXRBcnJheVswXSA6IGBbJHtpbnB1dEFycmF5LmpvaW4oJywgJyl9XWA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGAke2F0dHJpYnV0ZX06ICR7bmV3VmFsdWV9YDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxpbmU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCByZWdleCA9IGlubGluZUZpZWxkUmVnZXgoYXR0cmlidXRlKTtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBsaW5lLm1hdGNoKHJlZ2V4KTtcbiAgICAgICAgICAgIGlmIChyPy5ncm91cHMgJiYgT2JqZWN0LmtleXMoci5ncm91cHMpLmV2ZXJ5KGkgPT4gZmllbGRDb21wb25lbnRzLmluY2x1ZGVzKGkpKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgc3RhcnRTdHlsZSwgZW5kU3R5bGUsIGJlZm9yZVNlcGFyYXRvclNwYWNlciwgYWZ0ZXJTZXBhcmF0b3JTcGFjZXIsIHZhbHVlcyB9ID0gci5ncm91cHNcbiAgICAgICAgICAgICAgICBjb25zdCBpbnB1dEFycmF5ID0gaW5wdXQgPyBpbnB1dC5yZXBsYWNlKC8oXFwsXFxzKykvZywgJywnKS5zcGxpdCgnLCcpIDogW1wiXCJdO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gaW5wdXRBcnJheS5sZW5ndGggPT0gMSA/IGlucHV0QXJyYXlbMF0gOiBgJHtpbnB1dEFycmF5LmpvaW4oJywgJyl9YDtcbiAgICAgICAgICAgICAgICByZXR1cm4gYCR7c3RhcnRTdHlsZX0ke2F0dHJpYnV0ZX0ke2VuZFN0eWxlfSR7YmVmb3JlU2VwYXJhdG9yU3BhY2VyfTo6JHthZnRlclNlcGFyYXRvclNwYWNlcn0ke25ld1ZhbHVlfWA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBsaW5lO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcbiAgICBhcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQuam9pbignXFxuJykpO1xufSIsICJpbXBvcnQgeyBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiXG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcIi4vcmVwbGFjZVZhbHVlc1wiXG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCJcbmltcG9ydCB7IGNyZWF0ZUZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IHsgZ2V0UHJvcGVydHlTZXR0aW5ncyB9IGZyb20gXCJzcmMvY29tbWFuZHMvZ2V0UHJvcGVydHlTZXR0aW5nc1wiO1xuXG5mdW5jdGlvbiBjcmVhdGVJbnB1dEZpZWxkKFxuICAgIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgIGR2OiBhbnksXG4gICAgcDogYW55LFxuICAgIGZpZWxkTmFtZTogc3RyaW5nLFxuICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICBhdHRycz86IHsgY2xzOiBzdHJpbmcsIGF0dHI6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfVxuKTogdm9pZCB7XG5cbiAgICBjb25zdCBmaWVsZFZhbHVlID0gZHYuZWwoJ3NwYW4nLCBwW2ZpZWxkTmFtZV0sIGF0dHJzKVxuICAgIGNvbnN0IGlucHV0Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKVxuICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpXG4gICAgaW5wdXQuc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1pbnB1dFwiKVxuICAgIGlucHV0Q29udGFpbmVyLmFwcGVuZENoaWxkKGlucHV0KVxuICAgIGlucHV0LnZhbHVlID0gcFtmaWVsZE5hbWVdXG4gICAgLyogZW5kIHNwYWNlciAqL1xuICAgIGNvbnN0IHNwYWNlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcbiAgICBzcGFjZXIuc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1zcGFjZXJcIilcbiAgICAvKiBidXR0b24gdG8gZGlzcGxheSBpbnB1dCAqL1xuICAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIilcbiAgICBidXR0b24uc2V0VGV4dChcIlx1RDgzRFx1REQ4RFwiKVxuICAgIGJ1dHRvbi5zZXRBdHRyKCdjbGFzcycsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIilcbiAgICBidXR0b24uaGlkZSgpXG4gICAgc3BhY2VyLnNob3coKVxuICAgIGZpZWxkQ29udGFpbmVyLm9ubW91c2VvdmVyID0gKCkgPT4ge1xuICAgICAgICBidXR0b24uc2hvdygpXG4gICAgICAgIHNwYWNlci5oaWRlKClcbiAgICB9XG4gICAgZmllbGRDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgYnV0dG9uLmhpZGUoKVxuICAgICAgICBzcGFjZXIuc2hvdygpXG4gICAgfVxuXG4gICAgY29uc3QgdmFsaWRhdGVJY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIilcbiAgICB2YWxpZGF0ZUljb24udGV4dENvbnRlbnQgPSBcIlx1MjcwNVwiXG4gICAgdmFsaWRhdGVJY29uLnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtYnV0dG9uXCIpXG4gICAgdmFsaWRhdGVJY29uLm9uY2xpY2sgPSAoZSkgPT4ge1xuICAgICAgICBjb25zdCBmaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocFtcImZpbGVcIl1bXCJwYXRoXCJdKVxuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgcmVwbGFjZVZhbHVlcyhwbHVnaW4uYXBwLCBmaWxlLCBmaWVsZE5hbWUsIGlucHV0LnZhbHVlKVxuICAgICAgICB9XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGlucHV0Q29udGFpbmVyKVxuICAgIH1cbiAgICBpbnB1dENvbnRhaW5lcj8uYXBwZW5kQ2hpbGQodmFsaWRhdGVJY29uKVxuICAgIGNvbnN0IGNhbmNlbEljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYVwiKVxuICAgIGNhbmNlbEljb24uc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIilcbiAgICBjYW5jZWxJY29uLnRleHRDb250ZW50ID0gXCJcdTI3NENcIlxuICAgIGNhbmNlbEljb24ub25jbGljayA9IChlKSA9PiB7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGlucHV0Q29udGFpbmVyKVxuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChidXR0b24pXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHNwYWNlcilcbiAgICB9XG4gICAgaW5wdXRDb250YWluZXIuYXBwZW5kQ2hpbGQoY2FuY2VsSWNvbilcbiAgICBpbnB1dC5mb2N1cygpXG5cbiAgICBpbnB1dC5vbmtleWRvd24gPSAoZSkgPT4ge1xuICAgICAgICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xuICAgICAgICAgICAgY29uc3QgZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHBbXCJmaWxlXCJdW1wicGF0aFwiXSlcbiAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgcmVwbGFjZVZhbHVlcyhwbHVnaW4uYXBwLCBmaWxlLCBmaWVsZE5hbWUsIGlucHV0LnZhbHVlKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoaW5wdXRDb250YWluZXIpXG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoaW5wdXRDb250YWluZXIpXG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChidXR0b24pXG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChmaWVsZFZhbHVlKVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoc3BhY2VyKVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qIGJ1dHRvbiBvbiBjbGljayA6IHJlbW92ZSBidXR0b24gYW5kIGZpZWxkIGFuZCBkaXNwbGF5IGlucHV0IGZpZWxkKi9cbiAgICBidXR0b24ub25jbGljayA9IChlKSA9PiB7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGZpZWxkVmFsdWUpXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGJ1dHRvbilcbiAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoc3BhY2VyKVxuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChpbnB1dENvbnRhaW5lcilcbiAgICAgICAgaW5wdXQuZm9jdXMoKVxuICAgIH1cbiAgICAvKiBpbml0aWFsIHN0YXRlICovXG4gICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoYnV0dG9uKVxuICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpXG4gICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoc3BhY2VyKVxufVxuXG5mdW5jdGlvbiBjcmVhdGVCb29sZWFuRmllbGQoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgZHY6IGFueSxcbiAgICBwOiBhbnksXG4gICAgZmllbGROYW1lOiBzdHJpbmcsXG4gICAgZmllbGRDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgIGF0dHJzPzogeyBjbHM6IHN0cmluZywgYXR0cjogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9XG4pOiB2b2lkIHtcbiAgICBjb25zdCBjaGVja2JveDogSFRNTElucHV0RWxlbWVudCA9IGR2LmVsKFwiaW5wdXRcIiwgXCJcIiwgeyAuLi5hdHRycywgXCJ0eXBlXCI6IFwiY2hlY2tib3hcIiB9KVxuICAgIGNoZWNrYm94LmNoZWNrZWQgPSBwW2ZpZWxkTmFtZV1cbiAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChjaGVja2JveClcbiAgICBjaGVja2JveC5vbmNoYW5nZSA9ICh2YWx1ZSkgPT4ge1xuICAgICAgICBjb25zdCBmaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocFtcImZpbGVcIl1bXCJwYXRoXCJdKVxuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgcmVwbGFjZVZhbHVlcyhwbHVnaW4uYXBwLCBmaWxlLCBmaWVsZE5hbWUsIGNoZWNrYm94LmNoZWNrZWQudG9TdHJpbmcoKSlcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpZWxkTW9kaWZpZXIocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGR2OiBhbnksIHA6IGFueSwgZmllbGROYW1lOiBzdHJpbmcsIGF0dHJzPzogeyBjbHM6IHN0cmluZywgYXR0cjogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9KTogUHJvbWlzZTxIVE1MRWxlbWVudD4ge1xuXG4gICAgLyogZmllbGRDb250YWluZXIqL1xuICAgIGNvbnN0IGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCA9IGR2LmVsKFwiZGl2XCIsIFwiXCIpXG4gICAgZmllbGRDb250YWluZXIuc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1jb250YWluZXJcIilcblxuICAgIC8qIGNyZWF0ZSBmaWVsZE1vZGlmaWVyIGRlcGVuZGluZyBvbiBmaWxlQ2xhc3MgdHlwZSBvciBwcmVzZXQgdmFsdWUqL1xuXG4gICAgaWYgKHBbZmllbGROYW1lXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNvbnN0IGVtcHR5RmllbGQgPSBkdi5lbChcInNwYW5cIiwgbnVsbCwgYXR0cnMpXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGVtcHR5RmllbGQpXG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzQWxpYXMgPSBwbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXNcbiAgICAgICAgaWYgKHBbZmlsZUNsYXNzQWxpYXNdKSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSBhd2FpdCBjcmVhdGVGaWxlQ2xhc3MocGx1Z2luLCBwW2ZpbGVDbGFzc0FsaWFzXSlcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gZ2V0UHJvcGVydHlTZXR0aW5ncyhwbHVnaW4sIGZpZWxkTmFtZSwgZmlsZUNsYXNzKVxuICAgICAgICAgICAgaWYgKGZpZWxkPy5pc0Jvb2xlYW4pIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVCb29sZWFuRmllbGQocGx1Z2luLCBkdiwgcCwgZmllbGROYW1lLCBmaWVsZENvbnRhaW5lciwgYXR0cnMpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNyZWF0ZUlucHV0RmllbGQocGx1Z2luLCBkdiwgcCwgZmllbGROYW1lLCBmaWVsZENvbnRhaW5lciwgYXR0cnMpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAocGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkcy5maWx0ZXIoYXR0ciA9PiBhdHRyLm5hbWUgPT0gZmllbGROYW1lKSkge1xuICAgICAgICAgICAgY29uc3QgZmllbGQgPSBnZXRQcm9wZXJ0eVNldHRpbmdzKHBsdWdpbiwgZmllbGROYW1lKVxuICAgICAgICAgICAgaWYgKGZpZWxkPy5pc0Jvb2xlYW4pIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVCb29sZWFuRmllbGQocGx1Z2luLCBkdiwgcCwgZmllbGROYW1lLCBmaWVsZENvbnRhaW5lciwgYXR0cnMpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNyZWF0ZUlucHV0RmllbGQocGx1Z2luLCBkdiwgcCwgZmllbGROYW1lLCBmaWVsZENvbnRhaW5lciwgYXR0cnMpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjcmVhdGVJbnB1dEZpZWxkKHBsdWdpbiwgZHYsIHAsIGZpZWxkTmFtZSwgZmllbGRDb250YWluZXIsIGF0dHJzKVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmaWVsZENvbnRhaW5lclxufTsgIiwgImltcG9ydCBGaWVsZCBmcm9tIFwic3JjL0ZpZWxkXCI7XG5pbXBvcnQgeyBnZW5lcmljRmllbGRSZWdleCB9IGZyb20gXCJzcmMvdXRpbHMvcGFyc2VyXCI7XG5cbmludGVyZmFjZSBGaWxlQ2xhc3NBdHRyaWJ1dGUge1xuICAgIG5hbWU6IHN0cmluZztcbiAgICB0eXBlOiBzdHJpbmc7XG4gICAgb3B0aW9uczogc3RyaW5nW107XG4gICAgaXNNdWx0aTogYm9vbGVhbjtcbiAgICBpc0N5Y2xlOiBib29sZWFuO1xuICAgIGlzQm9vbGVhbjogYm9vbGVhbjtcbn1cblxuY29uc3QgdHlwZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgXCJpbnB1dFwiOiBcIkFjY2VwdCBhbnkgdmFsdWVcIixcbiAgICBcInNlbGVjdFwiOiBcIkFjY2VwdCBhIHNpbmdsZSB2YWx1ZSBmcm9tIGEgbGlzdFwiLFxuICAgIFwibXVsdGlcIjogXCJBY2NlcHQgbXVsdGlwbGUgdmFsdWVzIGZyb20gYSBsaXN0XCIsXG4gICAgXCJjeWNsZVwiOiBcIkN5Y2xlIHRocm91Z2ggdmFsdWVzIGZyb20gYSBsaXN0XCIsXG4gICAgXCJib29sZWFuXCI6IFwiQWNjZXB0IHRydWUgb2YgZmFsc2VcIlxufVxuXG5jbGFzcyBGaWxlQ2xhc3NBdHRyaWJ1dGUge1xuXG4gICAgY29uc3RydWN0b3IocmF3OiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgY29tcGxldGVSZWdleCA9IG5ldyBSZWdFeHAoYF4ke2dlbmVyaWNGaWVsZFJlZ2V4fTo6KD88ZmllbGRTZXR0aW5ncz4uKyk/YCwgXCJ1XCIpO1xuICAgICAgICBjb25zdCBuYW1lUmVnZXggPSBuZXcgUmVnRXhwKGBeJHtnZW5lcmljRmllbGRSZWdleH0kYCwgXCJ1XCIpO1xuICAgICAgICBsZXQgZmllbGROYW1lOiBzdHJpbmdcbiAgICAgICAgbGV0IHsgYXR0cmlidXRlLCBmaWVsZFNldHRpbmdzIH0gPSByYXcubWF0Y2goY29tcGxldGVSZWdleCk/Lmdyb3VwcyB8fCB7fVxuICAgICAgICBpZiAoYXR0cmlidXRlKSB7XG4gICAgICAgICAgICBmaWVsZE5hbWUgPSBhdHRyaWJ1dGVcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCB7IGF0dHJpYnV0ZSB9ID0gcmF3Lm1hdGNoKG5hbWVSZWdleCk/Lmdyb3VwcyB8fCB7fVxuICAgICAgICAgICAgZmllbGROYW1lID0gYXR0cmlidXRlXG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZpZWxkTmFtZSkge1xuICAgICAgICAgICAgdGhpcy5uYW1lID0gZmllbGROYW1lLnRyaW0oKTtcbiAgICAgICAgICAgIGlmIChmaWVsZFNldHRpbmdzKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSBKU09OLnBhcnNlKGAke2ZpZWxkU2V0dGluZ3MudHJpbSgpfWApO1xuICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IHNldHRpbmdzWyd0eXBlJ107XG4gICAgICAgICAgICAgICAgc3dpdGNoICh0aGlzLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIm11bHRpXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlzTXVsdGkgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJjeWNsZVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0N5Y2xlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiYm9vbGVhblwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0Jvb2xlYW4gPSB0cnVlXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gc2V0dGluZ3NbJ29wdGlvbnMnXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiSW1wcm9wZXIgdmFsdWVcIik7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRGaWVsZCgpIHtcbiAgICAgICAgbGV0IHZhbHVlczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9O1xuICAgICAgICB0aGlzLm9wdGlvbnM/LmZvckVhY2goKG9wdGlvbiwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIHZhbHVlc1tpbmRleF0gPSBvcHRpb247XG4gICAgICAgIH0pXG4gICAgICAgIHJldHVybiBuZXcgRmllbGQodGhpcy5uYW1lLCB2YWx1ZXMsIHRoaXMubmFtZSwgdGhpcy5pc011bHRpLCB0aGlzLmlzQ3ljbGUsIHRoaXMuaXNCb29sZWFuKTtcbiAgICB9XG59XG5cbmV4cG9ydCB7IEZpbGVDbGFzc0F0dHJpYnV0ZSwgdHlwZXMgfTsiLCAiaW1wb3J0IHsgRmlsZUNsYXNzQXR0cmlidXRlIH0gZnJvbSBcIi4vZmlsZUNsYXNzQXR0cmlidXRlXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5pbnRlcmZhY2UgRmlsZUNsYXNzIHtcbiAgICBwbHVnaW46IE1ldGFkYXRhTWVudTtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgYXR0cmlidXRlczogQXJyYXk8RmlsZUNsYXNzQXR0cmlidXRlPjtcbiAgICBvYmplY3RzOiBGaWxlQ2xhc3NNYW5hZ2VyO1xuICAgIGVycm9yczogc3RyaW5nW107XG59XG5cbmNsYXNzIEZpbGVDbGFzc01hbmFnZXIge1xuICAgIHB1YmxpYyBpbnN0YW5jZTogRmlsZUNsYXNzO1xuXG4gICAgY29uc3RydWN0b3IoaW5zdGFuY2U6IEZpbGVDbGFzcykge1xuICAgICAgICB0aGlzLmluc3RhbmNlID0gaW5zdGFuY2U7XG4gICAgfVxuXG4gICAgcHVibGljIGFsbCgpIHtcbiAgICAgICAgY29uc3QgZmlsZXNXaXRoRmlsZUNsYXNzTmFtZSA9IHRoaXMuaW5zdGFuY2UucGx1Z2luLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCkuZmlsdGVyKGZpbGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLmluc3RhbmNlLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NBbGlhcyA9IHRoaXMuaW5zdGFuY2UucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzO1xuICAgICAgICAgICAgcmV0dXJuIGNhY2hlPy5mcm9udG1hdHRlclxuICAgICAgICAgICAgICAgICYmIE9iamVjdC5rZXlzKGNhY2hlLmZyb250bWF0dGVyKS5pbmNsdWRlcyhmaWxlQ2xhc3NBbGlhcylcbiAgICAgICAgICAgICAgICAmJiBjYWNoZS5mcm9udG1hdHRlcltmaWxlQ2xhc3NBbGlhc10gPT0gdGhpcy5pbnN0YW5jZS5uYW1lO1xuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gZmlsZXNXaXRoRmlsZUNsYXNzTmFtZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0KG5hbWU6IHN0cmluZykge1xuICAgICAgICBjb25zdCBmaWxlc1dpdGhOYW1lID0gdGhpcy5hbGwoKS5maWx0ZXIoZmlsZSA9PiBmaWxlLmJhc2VuYW1lID09IG5hbWUpO1xuICAgICAgICBpZiAoZmlsZXNXaXRoTmFtZS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihcIk1vcmUgdGhhbiBvbmUgdmFsdWUgZm91bmRcIik7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmlsZXNXaXRoTmFtZS5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoXCJObyBmaWxlIHZhbHVlIGZvdW5kXCIpO1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZpbGVzV2l0aE5hbWVbMF07XG5cbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0UGF0aChwYXRoOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgZmlsZXNXaXRoTmFtZSA9IHRoaXMuYWxsKCkuZmlsdGVyKGZpbGUgPT4gZmlsZS5wYXRoID09IHBhdGgpO1xuICAgICAgICBpZiAoZmlsZXNXaXRoTmFtZS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihcIk1vcmUgdGhhbiBvbmUgdmFsdWUgZm91bmRcIik7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmlsZXNXaXRoTmFtZS5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoXCJObyBmaWxlIHZhbHVlIGZvdW5kXCIpO1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZpbGVzV2l0aE5hbWVbMF07XG5cbiAgICB9XG59XG5cbmNsYXNzIEZpbGVDbGFzcyB7XG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIG5hbWU6IHN0cmluZykge1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5vYmplY3RzID0gbmV3IEZpbGVDbGFzc01hbmFnZXIodGhpcyk7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IFtdO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRDbGFzc0ZpbGUoKTogVEZpbGUge1xuICAgICAgICBjb25zdCBmaWxlc0NsYXNzUGF0aCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoO1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChgJHtmaWxlc0NsYXNzUGF0aH0ke3RoaXMubmFtZX0ubWRgKTtcbiAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBmaWxlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoXCJubyBzdWNoIGZpbGVDbGFzcyBpbiBmaWxlQ2xhc3MgZm9sZGVyXCIpO1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgZ2V0QXR0cmlidXRlcygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldENsYXNzRmlsZSgpO1xuICAgICAgICAgICAgbGV0IGF0dHJpYnV0ZXM6IEFycmF5PEZpbGVDbGFzc0F0dHJpYnV0ZT4gPSBbXTtcbiAgICAgICAgICAgIGxldCBlcnJvcnM6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQuY2FjaGVkUmVhZChmaWxlKVxuICAgICAgICAgICAgcmVzdWx0LnNwbGl0KCdcXG4nKS5mb3JFYWNoKGxpbmUgPT4ge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZSA9IG5ldyBGaWxlQ2xhc3NBdHRyaWJ1dGUobGluZSk7XG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMucHVzaChhdHRyaWJ1dGUpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gYXR0cmlidXRlcztcbiAgICAgICAgICAgIHRoaXMuZXJyb3JzID0gZXJyb3JzO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgKGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyB1cGRhdGVBdHRyaWJ1dGUobmV3VHlwZTogc3RyaW5nLCBuZXdPcHRpb25zOiBzdHJpbmdbXSwgbmV3TmFtZTogc3RyaW5nLCBhdHRyPzogRmlsZUNsYXNzQXR0cmlidXRlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldENsYXNzRmlsZSgpO1xuICAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LnJlYWQoZmlsZSlcbiAgICAgICAgaWYgKGF0dHIpIHtcbiAgICAgICAgICAgIGxldCBuZXdDb250ZW50OiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICAgICAgcmVzdWx0LnNwbGl0KCdcXG4nKS5mb3JFYWNoKGxpbmUgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChsaW5lLnN0YXJ0c1dpdGgoYXR0ci5uYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobmV3VHlwZSA9PSBcImlucHV0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChuZXdOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzZXR0aW5nczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3NbXCJ0eXBlXCJdID0gbmV3VHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmdzW1wib3B0aW9uc1wiXSA9IG5ld09wdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2goYCR7bmV3TmFtZX06OiAke0pTT04uc3RyaW5naWZ5KHNldHRpbmdzKX1gKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChsaW5lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50LmpvaW4oJ1xcbicpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBzZXR0aW5nczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuICAgICAgICAgICAgc2V0dGluZ3NbXCJ0eXBlXCJdID0gbmV3VHlwZTtcbiAgICAgICAgICAgIHNldHRpbmdzW1wib3B0aW9uc1wiXSA9IG5ld09wdGlvbnM7XG4gICAgICAgICAgICByZXN1bHQgKz0gKGBcXG4ke25ld05hbWV9OjogJHtKU09OLnN0cmluZ2lmeShzZXR0aW5ncyl9YCk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgcmVtb3ZlQXR0cmlidXRlKGF0dHI6IEZpbGVDbGFzc0F0dHJpYnV0ZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRDbGFzc0ZpbGUoKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LnJlYWQoZmlsZSlcbiAgICAgICAgbGV0IG5ld0NvbnRlbnQ6IHN0cmluZ1tdID0gW107XG4gICAgICAgIHJlc3VsdC5zcGxpdCgnXFxuJykuZm9yRWFjaChsaW5lID0+IHtcbiAgICAgICAgICAgIGlmICghbGluZS5zdGFydHNXaXRoKGF0dHIubmFtZSkpIHtcbiAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2gobGluZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3Q29udGVudC5qb2luKCdcXG4nKSk7XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVGaWxlQ2xhc3MocGx1Z2luOiBNZXRhZGF0YU1lbnUsIG5hbWU6IHN0cmluZyk6IFByb21pc2U8RmlsZUNsYXNzPiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gbmV3IEZpbGVDbGFzcyhwbHVnaW4sIG5hbWUpO1xuICAgICAgICBmaWxlQ2xhc3MuZ2V0QXR0cmlidXRlcygpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgcmVzb2x2ZShmaWxlQ2xhc3MpO1xuICAgICAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0pXG4gICAgfSlcbn1cblxuZXhwb3J0IHsgY3JlYXRlRmlsZUNsYXNzLCBGaWxlQ2xhc3MgfTsiLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvRmllbGRcIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UHJvcGVydHlTZXR0aW5ncyhwbHVnaW46IE1ldGFkYXRhTWVudSwgcHJvcGVydHlOYW1lOiBzdHJpbmcsIGZpbGVDbGFzcz86IEZpbGVDbGFzcyk6IEZpZWxkIHwgdW5kZWZpbmVkIHtcbiAgICBjb25zdCBtYXRjaGluZ1NldHRpbmdzID0gcGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkcy5maWx0ZXIocCA9PiBwLm5hbWUgPT0gcHJvcGVydHlOYW1lKTtcbiAgICBpZiAoZmlsZUNsYXNzKSB7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc0F0dHJpYnV0ZXNXaXRoTmFtZSA9IGZpbGVDbGFzcy5hdHRyaWJ1dGVzLmZpbHRlcihhdHRyID0+IGF0dHIubmFtZSA9PSBwcm9wZXJ0eU5hbWUpO1xuICAgICAgICBpZiAoZmlsZUNsYXNzQXR0cmlidXRlc1dpdGhOYW1lLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0F0dHJpYnV0ZSA9IGZpbGVDbGFzc0F0dHJpYnV0ZXNXaXRoTmFtZVswXTtcbiAgICAgICAgICAgIGlmIChmaWxlQ2xhc3NBdHRyaWJ1dGUudHlwZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmaWxlQ2xhc3NBdHRyaWJ1dGUuZ2V0RmllbGQoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobWF0Y2hpbmdTZXR0aW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoaW5nU2V0dGluZ3NbMF07XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmIChtYXRjaGluZ1NldHRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIG1hdGNoaW5nU2V0dGluZ3NbMF07XG4gICAgfTtcbn07IiwgImltcG9ydCB7IEFwcCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIlxuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiXG5pbXBvcnQgeyBnZXRWYWx1ZXMgfSBmcm9tIFwiLi9jb21tYW5kcy9nZXRWYWx1ZXNcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwiLi9jb21tYW5kcy9yZXBsYWNlVmFsdWVzXCI7XG5pbXBvcnQgeyBmaWVsZE1vZGlmaWVyIH0gZnJvbSBcIi4vY29tbWFuZHMvZmllbGRNb2RpZmllclwiO1xuXG5cbmV4cG9ydCBpbnRlcmZhY2UgSU1ldGFkYXRhTWVudUFwaSB7XG4gICAgZ2V0VmFsdWVzOiAoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBhdHRyaWJ1dGU6IHN0cmluZykgPT4gUHJvbWlzZTxzdHJpbmdbXT47XG4gICAgcmVwbGFjZVZhbHVlczogKGFwcDogQXBwLCBmaWxlOiBURmlsZSwgYXR0cmlidXRlOiBzdHJpbmcsIGlucHV0OiBzdHJpbmcpID0+IFByb21pc2U8dm9pZD47XG4gICAgZmllbGRNb2RpZmllcjogKGR2OiBhbnksIHA6IGFueSwgZmllbGROYW1lOiBzdHJpbmcsIGF0dHJzPzogeyBjbHM6IHN0cmluZywgYXR0cjogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9KSA9PiBQcm9taXNlPEhUTUxFbGVtZW50Pjtcbn1cblxuZXhwb3J0IGNsYXNzIE1ldGFkYXRhTWVudUFwaSB7XG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSkge1xuICAgIH1cblxuICAgIHB1YmxpYyBtYWtlKCk6IElNZXRhZGF0YU1lbnVBcGkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0VmFsdWVzOiB0aGlzLmdldFZhbHVlcygpLFxuICAgICAgICAgICAgcmVwbGFjZVZhbHVlczogdGhpcy5yZXBsYWNlVmFsdWVzKCksXG4gICAgICAgICAgICBmaWVsZE1vZGlmaWVyOiB0aGlzLmZpZWxkTW9kaWZpZXIoKVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0VmFsdWVzKCk6IChhcHA6IEFwcCwgZmlsZTogVEZpbGUsIGF0dHJpYnV0ZTogc3RyaW5nKSA9PiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgICAgIHJldHVybiBhc3luYyAoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBhdHRyaWJ1dGU6IHN0cmluZykgPT4gZ2V0VmFsdWVzKGFwcCwgZmlsZSwgYXR0cmlidXRlKVxuICAgIH1cblxuICAgIHByaXZhdGUgcmVwbGFjZVZhbHVlcygpOiAoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBhdHRyaWJ1dGU6IHN0cmluZywgaW5wdXQ6IHN0cmluZykgPT4gUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHJldHVybiBhc3luYyAoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBhdHRyaWJ1dGU6IHN0cmluZywgaW5wdXQ6IHN0cmluZykgPT4gcmVwbGFjZVZhbHVlcyhhcHAsIGZpbGUsIGF0dHJpYnV0ZSwgaW5wdXQpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBmaWVsZE1vZGlmaWVyKCk6IChkdjogYW55LCBwOiBhbnksIGZpZWxkTmFtZTogc3RyaW5nLCBhdHRycz86IHsgY2xzOiBzdHJpbmcsIGF0dHI6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfSkgPT4gUHJvbWlzZTxIVE1MRWxlbWVudD4ge1xuICAgICAgICByZXR1cm4gKGR2OiBhbnksIHA6IGFueSwgZmllbGROYW1lOiBzdHJpbmcsIGF0dHJzPzogeyBjbHM6IHN0cmluZywgYXR0cjogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9KSA9PiBmaWVsZE1vZGlmaWVyKHRoaXMucGx1Z2luLCBkdiwgcCwgZmllbGROYW1lLCBhdHRycylcbiAgICB9XG59IiwgImltcG9ydCB7IFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgT3B0aW9uc0xpc3QgZnJvbSBcInNyYy9vcHRpb25zL09wdGlvbnNMaXN0XCI7XG5pbXBvcnQgRmlsZUNsYXNzQXR0cmlidXRlU2VsZWN0TW9kYWwgZnJvbSBcInNyYy9maWxlQ2xhc3MvRmlsZUNsYXNzQXR0cmlidXRlU2VsZWN0TW9kYWxcIjtcbmltcG9ydCBOb3RlRmllbGRzQ29tbWFuZHNNb2RhbCBmcm9tIFwiLi9Ob3RlRmllbGRzQ29tbWFuZHNNb2RhbFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBsaW5rQ29udGV4dE1lbnUge1xuXHRwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51O1xuXHRwcml2YXRlIGZpbGU6IFRGaWxlO1xuXHRwcml2YXRlIG9wdGlvbnNMaXN0OiBPcHRpb25zTGlzdDtcblxuXHRjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSkge1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHRcdHRoaXMuY3JlYXRlQ29udGV4dE1lbnUoKTtcblx0fTtcblxuXHRwcml2YXRlIGNyZWF0ZUNvbnRleHRNZW51KCk6IHZvaWQge1xuXHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQoXG5cdFx0XHR0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKCdmaWxlLW1lbnUnLCAobWVudSwgYWJzdHJhY3RGaWxlLCBzb3VyY2UpID0+IHtcblxuXHRcdFx0XHRjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChhYnN0cmFjdEZpbGUucGF0aCk7XG5cblx0XHRcdFx0aWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xuXHRcdFx0XHRcdHRoaXMuZmlsZSA9IGZpbGU7XG5cblx0XHRcdFx0XHQvL0lmIGZpbGVDbGFzc1xuXHRcdFx0XHRcdGlmIChmaWxlLnBhcmVudC5wYXRoICsgXCIvXCIgPT0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGgpIHtcblx0XHRcdFx0XHRcdG1lbnUuYWRkU2VwYXJhdG9yKCk7XG5cdFx0XHRcdFx0XHRtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0XHRcdFx0aXRlbS5zZXRJY29uKFwiZ2VhclwiKTtcblx0XHRcdFx0XHRcdFx0aXRlbS5zZXRUaXRsZShgTWFuYWdlIDwke2ZpbGUuYmFzZW5hbWV9PiBmaWVsZHNgKTtcblx0XHRcdFx0XHRcdFx0aXRlbS5vbkNsaWNrKChldnQpID0+IHtcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbCA9IG5ldyBGaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSk7XG5cdFx0XHRcdFx0XHRcdFx0ZmlsZUNsYXNzQXR0cmlidXRlU2VsZWN0TW9kYWwub3BlbigpO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHQvL0lmIGRpc3BsYXlGaWVsZHNJbkNvbnRleHRNZW51IHRydWUsIHNob3cgYWxsIGZpZWxkcyBpbiBub3RlXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGlzcGxheUZpZWxkc0luQ29udGV4dE1lbnUpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5vcHRpb25zTGlzdCA9IG5ldyBPcHRpb25zTGlzdCh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCBtZW51KTtcblx0XHRcdFx0XHRcdFx0dGhpcy5vcHRpb25zTGlzdC5jcmVhdGVFeHRyYU9wdGlvbkxpc3QoKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0XHRcdFx0Ly9OZXcgRmllbGRcblx0XHRcdFx0XHRcdFx0dGhpcy5vcHRpb25zTGlzdCA9IG5ldyBPcHRpb25zTGlzdCh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCBtZW51KTtcblxuXHRcdFx0XHRcdFx0XHQvL0ZpZWxkIE9wdGlvbnNcblx0XHRcdFx0XHRcdFx0bWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XG5cdFx0XHRcdFx0XHRcdFx0aXRlbS5zZXRJY29uKFwiYnVsbGV0LWxpc3RcIiksXG5cdFx0XHRcdFx0XHRcdFx0XHRpdGVtLnNldFRpdGxlKGBGaWVsZCBPcHRpb25zYCksXG5cdFx0XHRcdFx0XHRcdFx0XHRpdGVtLm9uQ2xpY2soKGV2dCkgPT4ge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRjb25zdCBmaWVsZE9wdGlvbnMgPSBuZXcgTm90ZUZpZWxkc0NvbW1hbmRzTW9kYWwoYXBwLCB0aGlzLnBsdWdpbiwgZmlsZSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGZpZWxkT3B0aW9ucy5vcGVuKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHRcdFx0XHRcdGl0ZW0uc2V0U2VjdGlvbihcInRhcmdldC1tZXRhZGF0YVwiKTtcblx0XHRcdFx0XHRcdFx0fSlcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9O1xuXHRcdFx0fSlcblx0XHQpO1xuXHR9O1xufTsiLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgVG9nZ2xlQ29tcG9uZW50LCBURmlsZSwgQnV0dG9uQ29tcG9uZW50LCBFeHRyYUJ1dHRvbkNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvRmllbGRcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCBGaWVsZFNldHRpbmcgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgdmFsdWVNdWx0aVNlbGVjdE1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgcHJpdmF0ZSBmaWxlOiBURmlsZTtcbiAgICBwcml2YXRlIG5hbWU6IHN0cmluZztcbiAgICBwcml2YXRlIHNldHRpbmdzOiBGaWVsZDtcbiAgICBwcml2YXRlIHZhbHVlczogQXJyYXk8c3RyaW5nPjtcbiAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlcjtcbiAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSB0b3A6IGJvb2xlYW47XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgZmlsZTogVEZpbGUsIG5hbWU6IHN0cmluZywgaW5pdGlhbFZhbHVlczogc3RyaW5nLCBzZXR0aW5nczogRmllbGQsIGxpbmVOdW1iZXI6IG51bWJlciA9IC0xLCBpbkZyb250TWF0dGVyOiBib29sZWFuID0gZmFsc2UsIHRvcDogYm9vbGVhbiA9IGZhbHNlKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLmZpbGUgPSBmaWxlO1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XG4gICAgICAgIGlmIChpbml0aWFsVmFsdWVzKSB7XG4gICAgICAgICAgICBpZiAoaW5pdGlhbFZhbHVlcy50b1N0cmluZygpLnN0YXJ0c1dpdGgoXCJbW1wiKSkge1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVzID0gaW5pdGlhbFZhbHVlcy5zcGxpdChcIixcIikubWFwKGl0ZW0gPT4gaXRlbS50cmltKCkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlcyA9IGluaXRpYWxWYWx1ZXMudG9TdHJpbmcoKS5yZXBsYWNlKC9eXFxbKC4qKVxcXSQvLCBcIiQxXCIpLnNwbGl0KFwiLFwiKS5tYXAoaXRlbSA9PiBpdGVtLnRyaW0oKSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSBbXTtcbiAgICAgICAgfTtcbiAgICAgICAgLy90aGlzLnZhbHVlcyA9IGluaXRpYWxWYWx1ZXMgPyBpbml0aWFsVmFsdWVzLnRvU3RyaW5nKCkucmVwbGFjZSgvXlxcWyguKilcXF0kLywgXCIkMVwiKS5zcGxpdChcIixcIikubWFwKGl0ZW0gPT4gaXRlbS50cmltKCkpIDogW11cbiAgICAgICAgdGhpcy5saW5lTnVtYmVyID0gbGluZU51bWJlcjtcbiAgICAgICAgdGhpcy5pbkZyb250bWF0dGVyID0gaW5Gcm9udE1hdHRlcjtcbiAgICAgICAgdGhpcy50b3AgPSB0b3A7XG4gICAgfTtcblxuICAgIGFzeW5jIG9uT3BlbigpIHtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIik7XG5cbiAgICAgICAgY29uc3QgdmFsdWVHcmlkID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHtcbiAgICAgICAgICAgIGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLWdyaWRcIlxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgbGlzdE5vdGVWYWx1ZXMgPSBhd2FpdCBGaWVsZFNldHRpbmcuZ2V0VmFsdWVzTGlzdEZyb21Ob3RlKHRoaXMuc2V0dGluZ3MudmFsdWVzTGlzdE5vdGVQYXRoLCB0aGlzLmFwcClcbiAgICAgICAgYXdhaXQgdGhpcy5wb3B1bGF0ZVZhbHVlc0dyaWQodmFsdWVHcmlkLCBsaXN0Tm90ZVZhbHVlcyk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgYXN5bmMgcG9wdWxhdGVWYWx1ZXNHcmlkKHZhbHVlR3JpZDogSFRNTERpdkVsZW1lbnQsIGxpc3ROb3RlVmFsdWVzOiBzdHJpbmdbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAobGlzdE5vdGVWYWx1ZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLnNldHRpbmdzLnZhbHVlcykuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHByZXNldFZhbHVlID0gdGhpcy5zZXR0aW5ncy52YWx1ZXNba2V5XTtcbiAgICAgICAgICAgICAgICB0aGlzLmJ1aWxkVmFsdWVUb2dnbGVyKHZhbHVlR3JpZCwgcHJlc2V0VmFsdWUpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgbGlzdE5vdGVWYWx1ZXMuZm9yRWFjaCh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmJ1aWxkVmFsdWVUb2dnbGVyKHZhbHVlR3JpZCwgdmFsdWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgZm9vdGVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtZ3JpZC1mb290ZXJcIiB9KTtcbiAgICAgICAgY29uc3Qgc2F2ZUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoZm9vdGVyKTtcbiAgICAgICAgc2F2ZUJ1dHRvbi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpO1xuICAgICAgICBzYXZlQnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgICAgIHJlcGxhY2VWYWx1ZXModGhpcy5hcHAsIHRoaXMuZmlsZSwgdGhpcy5uYW1lLCB0aGlzLnZhbHVlcy5qb2luKFwiLFwiKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQodGhpcy5maWxlKVxuICAgICAgICAgICAgICAgIGxldCBuZXdDb250ZW50OiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlbmRlcmVkVmFsdWVzID0gIXRoaXMuaW5Gcm9udG1hdHRlciA/IHRoaXMudmFsdWVzLmpvaW4oXCIsXCIpIDogdGhpcy52YWx1ZXMubGVuZ3RoID4gMSA/IGBbJHt0aGlzLnZhbHVlcy5qb2luKFwiLFwiKX1dYCA6IHRoaXMudmFsdWVzXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudG9wKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChgJHt0aGlzLm5hbWV9JHt0aGlzLmluRnJvbnRtYXR0ZXIgPyBcIjpcIiA6IFwiOjpcIn0gJHtyZW5kZXJlZFZhbHVlc31gKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnNwbGl0KFwiXFxuXCIpLmZvckVhY2goKGxpbmUsIF9saW5lTnVtYmVyKSA9PiBuZXdDb250ZW50LnB1c2gobGluZSkpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5zcGxpdChcIlxcblwiKS5mb3JFYWNoKChsaW5lLCBfbGluZU51bWJlcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKGxpbmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9saW5lTnVtYmVyID09IHRoaXMubGluZU51bWJlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChgJHt0aGlzLm5hbWV9JHt0aGlzLmluRnJvbnRtYXR0ZXIgPyBcIjpcIiA6IFwiOjpcIn0gJHtyZW5kZXJlZFZhbHVlc31gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB0aGlzLmFwcC52YXVsdC5tb2RpZnkodGhpcy5maWxlLCBuZXdDb250ZW50LmpvaW4oJ1xcbicpKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBuZXcgRXh0cmFCdXR0b25Db21wb25lbnQoZm9vdGVyKTtcbiAgICAgICAgY2FuY2VsQnV0dG9uLnNldEljb24oXCJjcm9zc1wiKTtcbiAgICAgICAgY2FuY2VsQnV0dG9uLm9uQ2xpY2soKCkgPT4gdGhpcy5jbG9zZSgpKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBidWlsZFZhbHVlVG9nZ2xlcih2YWx1ZUdyaWQ6IEhUTUxEaXZFbGVtZW50LCBwcmVzZXRWYWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlU2VsZWN0b3JDb250YWluZXIgPSB2YWx1ZUdyaWQuY3JlYXRlRGl2KHtcbiAgICAgICAgICAgIGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLXNlbGVjdG9yLWNvbnRhaW5lclwiXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCB2YWx1ZVRvZ2dsZXJDb250YWluZXIgPSB2YWx1ZVNlbGVjdG9yQ29udGFpbmVyLmNyZWF0ZURpdih7XG4gICAgICAgICAgICBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1zZWxlY3Rvci10b2dnbGVyXCJcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHZhbHVlVG9nZ2xlciA9IG5ldyBUb2dnbGVDb21wb25lbnQodmFsdWVUb2dnbGVyQ29udGFpbmVyKTtcbiAgICAgICAgdGhpcy52YWx1ZXMuZm9yRWFjaCh2YWx1ZSA9PiB7XG4gICAgICAgICAgICBpZiAodmFsdWUgPT0gcHJlc2V0VmFsdWUpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZVRvZ2dsZXIuc2V0VmFsdWUodHJ1ZSlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgICB2YWx1ZVRvZ2dsZXIub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgaWYgKHZhbHVlICYmICF0aGlzLnZhbHVlcy5pbmNsdWRlcyhwcmVzZXRWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlcy5wdXNoKHByZXNldFZhbHVlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZXMucmVtb3ZlKHByZXNldFZhbHVlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCB2YWx1ZUxhYmVsID0gdmFsdWVTZWxlY3RvckNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1zZWxlY3Rvci1sYWJlbFwiIH0pO1xuICAgICAgICB2YWx1ZUxhYmVsLnNldFRleHQocHJlc2V0VmFsdWUpO1xuICAgIH07XG59OyIsICJpbXBvcnQgeyBBcHAsIE1vZGFsLCBUZXh0Q29tcG9uZW50LCBURmlsZSwgVG9nZ2xlQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9yZXBsYWNlVmFsdWVzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIHZhbHVlVGV4dElucHV0TW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cbiAgICBwcml2YXRlIGZpbGU6IFRGaWxlO1xuICAgIHByaXZhdGUgbmFtZTogc3RyaW5nO1xuICAgIHByaXZhdGUgdmFsdWU6IHN0cmluZztcbiAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlcjtcbiAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSB0b3A6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSBwYXJzZURhdGU6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBmaWxlOiBURmlsZSwgbmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBsaW5lTnVtYmVyOiBudW1iZXIgPSAtMSwgaW5Gcm9udE1hdHRlcjogYm9vbGVhbiA9IGZhbHNlLCB0b3A6IGJvb2xlYW4gPSBmYWxzZSkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy5maWxlID0gZmlsZTtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLmxpbmVOdW1iZXIgPSBsaW5lTnVtYmVyO1xuICAgICAgICB0aGlzLmluRnJvbnRtYXR0ZXIgPSBpbkZyb250TWF0dGVyO1xuICAgICAgICB0aGlzLnRvcCA9IHRvcDtcbiAgICB9O1xuXG4gICAgb25PcGVuKCkge1xuICAgICAgICBjb25zdCBpbnB1dERpdiA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LW1vZGFsLXZhbHVlXCIgfSk7XG4gICAgICAgIHRoaXMuYnVpbGRJbnB1dEVsKGlucHV0RGl2KTtcbiAgICB9O1xuXG4gICAgYnVpbGREYXRlUGFyc2VUb2dnbGVyKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgIGlmIChhcHAucGx1Z2lucy5wbHVnaW5zLmhhc093blByb3BlcnR5KCdubGRhdGVzLW9ic2lkaWFuJykpIHtcbiAgICAgICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICAgICAgY29uc3QgbmxkYXRlcyA9IGFwcC5wbHVnaW5zLnBsdWdpbnNbJ25sZGF0ZXMtb2JzaWRpYW4nXTtcbiAgICAgICAgICAgIGNvbnN0IGRhdGVQYXJzZXJMYWJlbCA9IGNvbnRhaW5lci5jcmVhdGVEaXYoe1xuICAgICAgICAgICAgICAgIGNsczogXCJtZXRhZGF0YS1tZW51LWRhdGUtcGFyc2VyLWxhYmVsXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZGF0ZVBhcnNlckxhYmVsLnNldFRleHQoXCJcdUQ4M0RcdURDQzZcIik7XG4gICAgICAgICAgICBjb25zdCBkYXRlUGFyc2VyVG9nZ2xlciA9IG5ldyBUb2dnbGVDb21wb25lbnQoY29udGFpbmVyKTtcbiAgICAgICAgICAgIGRhdGVQYXJzZXJUb2dnbGVyLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcnNlRGF0ZSA9IHZhbHVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkYXRlUGFyc2VyTGFiZWwub25jbGljayA9ICgpID0+IGRhdGVQYXJzZXJUb2dnbGVyLnNldFZhbHVlKCF0aGlzLnBhcnNlRGF0ZSk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHByaXZhdGUgYnVpbGRJbnB1dEVsKGlucHV0RGl2OiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICB0aGlzLmJ1aWxkRGF0ZVBhcnNlVG9nZ2xlcihpbnB1dERpdik7XG4gICAgICAgIGNvbnN0IGZvcm0gPSBpbnB1dERpdi5jcmVhdGVFbChcImZvcm1cIik7XG4gICAgICAgIGZvcm0udHlwZSA9IFwic3VibWl0XCI7XG5cbiAgICAgICAgY29uc3QgaW5wdXRFbCA9IG5ldyBUZXh0Q29tcG9uZW50KGZvcm0pO1xuICAgICAgICBpbnB1dEVsLmlucHV0RWwuZm9jdXMoKTtcbiAgICAgICAgaW5wdXRFbC5zZXRWYWx1ZSh0aGlzLnZhbHVlKTtcbiAgICAgICAgaW5wdXRFbC5pbnB1dEVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS1wcm9tcHQtaW5wdXRcIik7XG5cbiAgICAgICAgZm9ybS5vbnN1Ym1pdCA9IGFzeW5jIChlOiBFdmVudCkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgbGV0IGlucHV0VmFsdWUgPSBpbnB1dEVsLmdldFZhbHVlKCk7XG4gICAgICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgICAgIGlmIChhcHAucGx1Z2lucy5wbHVnaW5zLmhhc093blByb3BlcnR5KCdubGRhdGVzLW9ic2lkaWFuJykgJiYgdGhpcy5wYXJzZURhdGUpIHtcbiAgICAgICAgICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICBjb25zdCBubGRhdGVzID0gYXBwLnBsdWdpbnMucGx1Z2luc1snbmxkYXRlcy1vYnNpZGlhbiddO1xuICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdCA9IG5sZGF0ZXMuc2V0dGluZ3MuZm9ybWF0O1xuICAgICAgICAgICAgICAgIGxldCB0ZXh0U3RhcnQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGxldCB0ZXh0RW5kID0gXCJcIjtcbiAgICAgICAgICAgICAgICBsZXQgZGF0ZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uU3RhcnQgPSBpbnB1dEVsLmlucHV0RWwuc2VsZWN0aW9uU3RhcnQ7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uRW5kID0gaW5wdXRFbC5pbnB1dEVsLnNlbGVjdGlvbkVuZDtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0aW9uRW5kID09IHNlbGVjdGlvblN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGUgPSBubGRhdGVzLnBhcnNlRGF0ZShpbnB1dEVsLmdldFZhbHVlKCkpLm1vbWVudC5mb3JtYXQoZm9ybWF0KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0U3RhcnQgPSBpbnB1dEVsLmdldFZhbHVlKCkuc2xpY2UoMCwgc2VsZWN0aW9uU3RhcnQhKTtcbiAgICAgICAgICAgICAgICAgICAgZGF0ZSA9IG5sZGF0ZXMucGFyc2VEYXRlKGlucHV0RWwuZ2V0VmFsdWUoKS5zbGljZShzZWxlY3Rpb25TdGFydCEsIHNlbGVjdGlvbkVuZCEpKS5tb21lbnQuZm9ybWF0KGZvcm1hdCk7XG4gICAgICAgICAgICAgICAgICAgIHRleHRFbmQgPSBpbnB1dEVsLmdldFZhbHVlKCkuc2xpY2Uoc2VsZWN0aW9uRW5kISk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpbnB1dFZhbHVlID0gdGV4dFN0YXJ0ICsgXCJbW1wiICsgZGF0ZSArIFwiXV1cIiArIHRleHRFbmQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5saW5lTnVtYmVyID09IC0xKSB7XG4gICAgICAgICAgICAgICAgcmVwbGFjZVZhbHVlcyh0aGlzLmFwcCwgdGhpcy5maWxlLCB0aGlzLm5hbWUsIGlucHV0VmFsdWUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKHRoaXMuZmlsZSlcbiAgICAgICAgICAgICAgICBsZXQgbmV3Q29udGVudDogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50b3ApIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKGAke3RoaXMubmFtZX0ke3RoaXMuaW5Gcm9udG1hdHRlciA/IFwiOlwiIDogXCI6OlwifSAke2lucHV0VmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5zcGxpdChcIlxcblwiKS5mb3JFYWNoKChsaW5lLCBfbGluZU51bWJlcikgPT4gbmV3Q29udGVudC5wdXNoKGxpbmUpKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQuc3BsaXQoXCJcXG5cIikuZm9yRWFjaCgobGluZSwgX2xpbmVOdW1iZXIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChsaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfbGluZU51bWJlciA9PSB0aGlzLmxpbmVOdW1iZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2goYCR7dGhpcy5uYW1lfSR7dGhpcy5pbkZyb250bWF0dGVyID8gXCI6XCIgOiBcIjo6XCJ9ICR7aW5wdXRWYWx1ZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy5hcHAudmF1bHQubW9kaWZ5KHRoaXMuZmlsZSwgbmV3Q29udGVudC5qb2luKCdcXG4nKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfTtcblxuICAgIH07XG59OyIsICJpbXBvcnQgeyBBcHAsIE1vZGFsLCBEcm9wZG93bkNvbXBvbmVudCwgVEZpbGUsIEJ1dHRvbkNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvRmllbGRcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCBGaWVsZFNldHRpbmcgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgdmFsdWVTZWxlY3RNb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuICAgIHByaXZhdGUgZmlsZTogVEZpbGU7XG4gICAgcHJpdmF0ZSBuYW1lOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSB2YWx1ZTogc3RyaW5nO1xuICAgIHByaXZhdGUgc2V0dGluZ3M6IEZpZWxkO1xuICAgIHByaXZhdGUgbmV3VmFsdWU6IHN0cmluZyB8IG51bGw7XG4gICAgcHJpdmF0ZSBsaW5lTnVtYmVyOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuO1xuICAgIHByaXZhdGUgdG9wOiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIHNldHRpbmdzOiBGaWVsZCwgbGluZU51bWJlcjogbnVtYmVyID0gLTEsIGluRnJvbnRNYXR0ZXI6IGJvb2xlYW4gPSBmYWxzZSwgdG9wOiBib29sZWFuID0gZmFsc2UpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMuZmlsZSA9IGZpbGU7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgICAgICB0aGlzLm5ld1ZhbHVlID0gbnVsbDtcbiAgICAgICAgdGhpcy5saW5lTnVtYmVyID0gbGluZU51bWJlcjtcbiAgICAgICAgdGhpcy5pbkZyb250bWF0dGVyID0gaW5Gcm9udE1hdHRlcjtcbiAgICAgICAgdGhpcy50b3AgPSB0b3A7XG4gICAgfTtcblxuICAgIGFzeW5jIG9uT3BlbigpIHtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIik7XG4gICAgICAgIGNvbnN0IGlucHV0RGl2ID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtbW9kYWwtdmFsdWVcIiB9KTtcbiAgICAgICAgYXdhaXQgdGhpcy5idWlsZElucHV0RWwoaW5wdXREaXYpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGFzeW5jIGJ1aWxkSW5wdXRFbChpbnB1dERpdjogSFRNTERpdkVsZW1lbnQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3Qgc2VsZWN0RWwgPSBuZXcgRHJvcGRvd25Db21wb25lbnQoaW5wdXREaXYpO1xuICAgICAgICBzZWxlY3RFbC5zZWxlY3RFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtc2VsZWN0XCIpO1xuXG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IHRoaXMuc2V0dGluZ3MudmFsdWVzO1xuICAgICAgICBzZWxlY3RFbC5hZGRPcHRpb24oXCJcIiwgXCItLUVtcHR5LS1cIik7XG4gICAgICAgIGNvbnN0IGxpc3ROb3RlVmFsdWVzID0gYXdhaXQgRmllbGRTZXR0aW5nLmdldFZhbHVlc0xpc3RGcm9tTm90ZSh0aGlzLnNldHRpbmdzLnZhbHVlc0xpc3ROb3RlUGF0aCwgdGhpcy5hcHApXG4gICAgICAgIGxpc3ROb3RlVmFsdWVzLmZvckVhY2godmFsdWUgPT4gc2VsZWN0RWwuYWRkT3B0aW9uKHZhbHVlLCB2YWx1ZSkpO1xuICAgICAgICBpZiAobGlzdE5vdGVWYWx1ZXMuaW5jbHVkZXModGhpcy52YWx1ZSkpIHtcbiAgICAgICAgICAgIHNlbGVjdEVsLnNldFZhbHVlKHRoaXMudmFsdWUpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAobGlzdE5vdGVWYWx1ZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyh2YWx1ZXMpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICAgICAgICBzZWxlY3RFbC5hZGRPcHRpb24odmFsdWVzW2tleV0sIHZhbHVlc1trZXldKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKE9iamVjdC52YWx1ZXModmFsdWVzKS5pbmNsdWRlcyh0aGlzLnZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHNlbGVjdEVsLnNldFZhbHVlKHRoaXMudmFsdWUpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBzZWxlY3RFbC5vbkNoYW5nZSh2YWx1ZSA9PiB0aGlzLm5ld1ZhbHVlID0gdmFsdWUgIT0gXCItLUVtcHR5LS1cIiA/IHZhbHVlIDogXCJcIik7XG4gICAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoaW5wdXREaXYpO1xuICAgICAgICBzdWJtaXRCdXR0b24uc2V0VG9vbHRpcChcIlNhdmVcIilcbiAgICAgICAgICAgIC5zZXRJY29uKFwiY2hlY2ttYXJrXCIpXG4gICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5uZXdWYWx1ZSB8fCB0aGlzLm5ld1ZhbHVlID09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VWYWx1ZXModGhpcy5hcHAsIHRoaXMuZmlsZSwgdGhpcy5uYW1lLCB0aGlzLm5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKHRoaXMuZmlsZSlcbiAgICAgICAgICAgICAgICAgICAgbGV0IG5ld0NvbnRlbnQ6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnRvcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKGAke3RoaXMubmFtZX0ke3RoaXMuaW5Gcm9udG1hdHRlciA/IFwiOlwiIDogXCI6OlwifSAke3NlbGVjdEVsLmdldFZhbHVlKCl9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuc3BsaXQoXCJcXG5cIikuZm9yRWFjaCgobGluZSwgX2xpbmVOdW1iZXIpID0+IG5ld0NvbnRlbnQucHVzaChsaW5lKSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuc3BsaXQoXCJcXG5cIikuZm9yRWFjaCgobGluZSwgX2xpbmVOdW1iZXIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2gobGluZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9saW5lTnVtYmVyID09IHRoaXMubGluZU51bWJlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2goYCR7dGhpcy5uYW1lfSR7dGhpcy5pbkZyb250bWF0dGVyID8gXCI6XCIgOiBcIjo6XCJ9ICR7c2VsZWN0RWwuZ2V0VmFsdWUoKX1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm1vZGlmeSh0aGlzLmZpbGUsIG5ld0NvbnRlbnQuam9pbignXFxuJykpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICB9O1xufTsiLCAiaW1wb3J0IHsgTW9kYWwsIERyb3Bkb3duQ29tcG9uZW50LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IGZpZWxkU2VsZWN0TW9kYWwgZnJvbSBcIi4vZmllbGRTZWxlY3RNb2RhbFwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgRmlsZUNsYXNzIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGNob29zZVNlY3Rpb25Nb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnU7XG4gICAgcHJpdmF0ZSBmaWxlOiBURmlsZTtcbiAgICBwcml2YXRlIGZpbGVDbGFzcz86IEZpbGVDbGFzc1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpbGU6IFRGaWxlLCBmaWxlQ2xhc3M/OiBGaWxlQ2xhc3MpIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMuZmlsZSA9IGZpbGU7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLmZpbGVDbGFzcyA9IGZpbGVDbGFzc1xuICAgIH07XG5cbiAgICBhc3luYyBvbk9wZW4oKSB7XG4gICAgICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KFwiQWRkIGEgZmllbGQgaW4gdGhpcyBub3RlIGFmdGVyOlwiKTtcbiAgICAgICAgY29uc3QgaW5wdXREaXYgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1tb2RhbC12YWx1ZVwiIH0pO1xuXG4gICAgICAgIGNvbnN0IHNlbGVjdEVsID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KGlucHV0RGl2KTtcbiAgICAgICAgc2VsZWN0RWwuc2VsZWN0RWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXNlbGVjdFwiKTtcbiAgICAgICAgc2VsZWN0RWwuYWRkT3B0aW9uKFwiXCIsIFwiU2VsZWN0IGxpbmVcIik7XG4gICAgICAgIHNlbGVjdEVsLmFkZE9wdGlvbihcInRvcF8wXCIsIFwidG9wXCIpO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKHRoaXMuZmlsZSlcbiAgICAgICAgbGV0IGZvcmVIZWFkVGV4dCA9IGZhbHNlO1xuICAgICAgICBsZXQgZnJvbnRtYXR0ZXJTdGFydCA9IGZhbHNlO1xuICAgICAgICBsZXQgZnJvbnRtYXR0ZXJFbmQgPSBmYWxzZTtcbiAgICAgICAgbGV0IGluRnJvbnRtYXR0ZXIgPSBmYWxzZTtcbiAgICAgICAgcmVzdWx0LnNwbGl0KFwiXFxuXCIpLmZvckVhY2goKGxpbmUsIGxpbmVOdW1iZXIpID0+IHtcbiAgICAgICAgICAgIGlmIChsaW5lICE9IFwiLS0tXCIgJiYgIWZvcmVIZWFkVGV4dCAmJiAhZnJvbnRtYXR0ZXJTdGFydCkge1xuICAgICAgICAgICAgICAgIGZvcmVIZWFkVGV4dCA9IHRydWU7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKGxpbmUgPT0gXCItLS1cIiAmJiAhZm9yZUhlYWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgaWYgKCFmcm9udG1hdHRlclN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgIGZyb250bWF0dGVyU3RhcnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBpbkZyb250bWF0dGVyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFmcm9udG1hdHRlckVuZCkge1xuICAgICAgICAgICAgICAgICAgICBmcm9udG1hdHRlckVuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGluRnJvbnRtYXR0ZXIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGluRnJvbnRtYXR0ZXIpIHtcbiAgICAgICAgICAgICAgICBzZWxlY3RFbC5hZGRPcHRpb24oYGZyb250bWF0dGVyXyR7bGluZU51bWJlcn1gLCBgJHtsaW5lLnN1YnN0cmluZygwLCAzMCl9JHtsaW5lLmxlbmd0aCA+IDMwID8gXCIuLi5cIiA6IFwiXCJ9YCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNlbGVjdEVsLmFkZE9wdGlvbihgYm9keV8ke2xpbmVOdW1iZXJ9YCwgYCR7bGluZS5zdWJzdHJpbmcoMCwgMzApfSR7bGluZS5sZW5ndGggPiAzMCA/IFwiLi4uXCIgOiBcIlwifWApO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIHNlbGVjdEVsLm9uQ2hhbmdlKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlQXJyYXkgPSBzZWxlY3RFbC5nZXRWYWx1ZSgpLm1hdGNoKC8oXFx3KylfKFxcZCspLyk7XG4gICAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9IHZhbHVlQXJyYXkgJiYgdmFsdWVBcnJheS5sZW5ndGggPiAwID8gdmFsdWVBcnJheVsxXSA6IDA7XG4gICAgICAgICAgICBjb25zdCBsaW5lTnVtYmVyID0gTnVtYmVyKHZhbHVlQXJyYXkgJiYgdmFsdWVBcnJheS5sZW5ndGggPiAxID8gdmFsdWVBcnJheVsyXSA6IDApO1xuICAgICAgICAgICAgY29uc3QgaW5Gcm9udG1hdHRlciA9IHBvc2l0aW9uID09IFwiZnJvbnRtYXR0ZXJcIiA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGNvbnN0IHRvcCA9IHBvc2l0aW9uID09IFwidG9wXCIgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBmaWVsZFNlbGVjdE1vZGFsKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIGxpbmVOdW1iZXIsIHJlc3VsdC5zcGxpdCgnXFxuJylbbGluZU51bWJlcl0sIGluRnJvbnRtYXR0ZXIsIHRvcCwgdGhpcy5maWxlQ2xhc3MpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgbW9kYWwub3BlbigpO1xuICAgICAgICB9KTtcbiAgICB9O1xufTsiLCAiaW1wb3J0IHsgTW9kYWwsIERyb3Bkb3duQ29tcG9uZW50LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IGFkZE5ld0ZpZWxkTW9kYWwgZnJvbSBcIi4vYWRkTmV3RmllbGRNb2RhbFwiO1xuaW1wb3J0IHZhbHVlVGV4dElucHV0TW9kYWwgZnJvbSBcIi4vdmFsdWVUZXh0SW5wdXRNb2RhbFwiO1xuaW1wb3J0IHZhbHVlU2VsZWN0TW9kYWwgZnJvbSBcIi4vdmFsdWVTZWxlY3RNb2RhbFwiO1xuaW1wb3J0IHZhbHVlVG9nZ2xlTW9kYWwgZnJvbSBcIi4vdmFsdWVUb2dnbGVNb2RhbFwiO1xuaW1wb3J0IHZhbHVlTXVsdGlTZWxlY3RNb2RhbCBmcm9tIFwiLi92YWx1ZU11bHRpU2VsZWN0TW9kYWxcIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvRmllbGRcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZmllbGRTZWxlY3RNb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuICAgIHByaXZhdGUgbGluZU51bWJlcjogbnVtYmVyO1xuICAgIHByaXZhdGUgbGluZTogc3RyaW5nO1xuICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnU7XG4gICAgcHJpdmF0ZSBmaWxlOiBURmlsZTtcbiAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSB0b3A6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSBmaWxlQ2xhc3M/OiBGaWxlQ2xhc3NcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWxlOiBURmlsZSwgbGluZU51bWJlcjogbnVtYmVyLCBsaW5lOiBzdHJpbmcsIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4sIHRvcDogYm9vbGVhbiwgZmlsZUNsYXNzPzogRmlsZUNsYXNzKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLmxpbmUgPSBsaW5lO1xuICAgICAgICB0aGlzLmxpbmVOdW1iZXIgPSBsaW5lTnVtYmVyO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5maWxlID0gZmlsZTtcbiAgICAgICAgdGhpcy5pbkZyb250bWF0dGVyID0gaW5Gcm9udG1hdHRlcjtcbiAgICAgICAgdGhpcy50b3AgPSB0b3A7XG4gICAgICAgIHRoaXMuZmlsZUNsYXNzID0gZmlsZUNsYXNzXG4gICAgfTtcblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQoYEluc2VydCBmaWVsZCBhZnRlciA+ICR7dGhpcy5saW5lLnN1YnN0cmluZygwLCAyMCl9JHt0aGlzLmxpbmUubGVuZ3RoID4gMjAgPyBcIi4uLlwiIDogXCJcIn1gKTtcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtZmllbGQtc2VsZWN0XCIgfSk7XG5cbiAgICAgICAgY29uc3Qgc2V0dGluZ3NEcm9wZG93bkNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgY29uc3Qgc2V0dGluZ3NTZWxlY3RvciA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChzZXR0aW5nc0Ryb3Bkb3duQ29udGFpbmVyKTtcbiAgICAgICAgc2V0dGluZ3NTZWxlY3Rvci5hZGRPcHRpb24oXCItLS1cIiwgXCJDaG9vc2UgRmllbGRcIik7XG4gICAgICAgIHNldHRpbmdzU2VsZWN0b3IuYWRkT3B0aW9uKFwiKytOZXdcIiwgXCJOZXdcIik7XG4gICAgICAgIGlmICh0aGlzLmZpbGVDbGFzcykge1xuICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3MuYXR0cmlidXRlcy5mb3JFYWNoKGF0dHIgPT4ge1xuICAgICAgICAgICAgICAgIHNldHRpbmdzU2VsZWN0b3IuYWRkT3B0aW9uKGF0dHIubmFtZSwgYXR0ci5uYW1lKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcmVzZXRGaWVsZHMuZm9yRWFjaChzZXR0aW5nID0+IHtcbiAgICAgICAgICAgICAgICBzZXR0aW5nc1NlbGVjdG9yLmFkZE9wdGlvbihzZXR0aW5nLm5hbWUsIHNldHRpbmcubmFtZSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuXG4gICAgICAgIHNldHRpbmdzU2VsZWN0b3Iub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgaWYgKHZhbHVlID09IFwiKytOZXdcIikge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0ZpZWxkTW9kYWwgPSBuZXcgYWRkTmV3RmllbGRNb2RhbCh0aGlzLnBsdWdpbiwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmZpbGUsIHRoaXMuaW5Gcm9udG1hdHRlciwgdGhpcy50b3ApO1xuICAgICAgICAgICAgICAgIG5ld0ZpZWxkTW9kYWwub3BlbigpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5maWxlQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGVzV2l0aE5hbWUgPSB0aGlzLmZpbGVDbGFzcy5hdHRyaWJ1dGVzLmZpbHRlcihhdHRyID0+IGF0dHIubmFtZSA9PSB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgbGV0IGZpZWxkOiBGaWVsZCB8IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIGxldCB0eXBlOiBzdHJpbmcgfCB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICBpZiAoZmlsZUNsYXNzQXR0cmlidXRlc1dpdGhOYW1lLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzQXR0cmlidXRlID0gZmlsZUNsYXNzQXR0cmlidXRlc1dpdGhOYW1lWzBdO1xuICAgICAgICAgICAgICAgICAgICBmaWVsZCA9IGZpbGVDbGFzc0F0dHJpYnV0ZS5nZXRGaWVsZCgpO1xuICAgICAgICAgICAgICAgICAgICB0eXBlID0gZmlsZUNsYXNzQXR0cmlidXRlLnR5cGVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImN5Y2xlXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2ZhbGwtdGhyb3VnaFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInNlbGVjdFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyB2YWx1ZVNlbGVjdE1vZGFsKHRoaXMuYXBwLCB0aGlzLmZpbGUsIGZpZWxkLm5hbWUsIFwiXCIsIGZpZWxkLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuaW5Gcm9udG1hdHRlciwgdGhpcy50b3ApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBTZWxlY3QgdmFsdWUgZm9yICR7dmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRNb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwibXVsdGlcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTW9kYWwgPSBuZXcgdmFsdWVNdWx0aVNlbGVjdE1vZGFsKHRoaXMuYXBwLCB0aGlzLmZpbGUsIGZpZWxkLm5hbWUsIFwiXCIsIGZpZWxkLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuaW5Gcm9udG1hdHRlciwgdGhpcy50b3ApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBTZWxlY3QgdmFsdWVzIGZvciAke3ZhbHVlfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImJvb2xlYW5cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTW9kYWwgPSBuZXcgdmFsdWVUb2dnbGVNb2RhbCh0aGlzLmFwcCwgdGhpcy5maWxlLCBmaWVsZC5uYW1lLCBmYWxzZSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMudG9wKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBTZXQgdmFsdWUgZm9yICR7dmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRNb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyB2YWx1ZVRleHRJbnB1dE1vZGFsKHRoaXMuYXBwLCB0aGlzLmZpbGUsIHZhbHVlLCBcIlwiLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuaW5Gcm9udG1hdHRlciwgdGhpcy50b3ApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBFbnRlciB2YWx1ZSBmb3IgJHt2YWx1ZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZE1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImJyZWFrXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJlc2V0RmllbGRzLmZpbHRlcihfZmllbGQgPT4gX2ZpZWxkLm5hbWUgPT0gdmFsdWUpWzBdO1xuICAgICAgICAgICAgICAgIGlmIChmaWVsZC52YWx1ZXNMaXN0Tm90ZVBhdGggfHwgKGZpZWxkLnZhbHVlcyAmJiBPYmplY3Qua2V5cyhmaWVsZC52YWx1ZXMpLmxlbmd0aCA+IDApKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWVsZC5pc011bHRpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZE1vZGFsID0gbmV3IHZhbHVlTXVsdGlTZWxlY3RNb2RhbCh0aGlzLmFwcCwgdGhpcy5maWxlLCBmaWVsZC5uYW1lLCBcIlwiLCBmaWVsZCwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMudG9wKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBTZWxlY3QgdmFsdWVzIGZvciAke3ZhbHVlfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRNb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZE1vZGFsID0gbmV3IHZhbHVlU2VsZWN0TW9kYWwodGhpcy5hcHAsIHRoaXMuZmlsZSwgZmllbGQubmFtZSwgXCJcIiwgZmllbGQsIHRoaXMubGluZU51bWJlciwgdGhpcy5pbkZyb250bWF0dGVyLCB0aGlzLnRvcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZE1vZGFsLnRpdGxlRWwuc2V0VGV4dChgU2VsZWN0IHZhbHVlIGZvciAke3ZhbHVlfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRNb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmaWVsZC5pc0Jvb2xlYW4pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyB2YWx1ZVRvZ2dsZU1vZGFsKHRoaXMuYXBwLCB0aGlzLmZpbGUsIGZpZWxkLm5hbWUsIGZhbHNlLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuaW5Gcm9udG1hdHRlciwgdGhpcy50b3ApXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBTZXQgdmFsdWUgZm9yICR7dmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTW9kYWwgPSBuZXcgdmFsdWVUZXh0SW5wdXRNb2RhbCh0aGlzLmFwcCwgdGhpcy5maWxlLCB2YWx1ZSwgXCJcIiwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMudG9wKTtcbiAgICAgICAgICAgICAgICAgICAgZmllbGRNb2RhbC50aXRsZUVsLnNldFRleHQoYEVudGVyIHZhbHVlIGZvciAke3ZhbHVlfWApO1xuICAgICAgICAgICAgICAgICAgICBmaWVsZE1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgIH07XG59OyIsICJpbXBvcnQgeyBNb2RhbCwgVGV4dENvbXBvbmVudCwgQnV0dG9uQ29tcG9uZW50LCBFeHRyYUJ1dHRvbkNvbXBvbmVudCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgYWRkTmV3RmllbGRNb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuICAgIHByaXZhdGUgbGluZU51bWJlcjogbnVtYmVyO1xuICAgIHByaXZhdGUgZmlsZTogVEZpbGU7XG4gICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuO1xuICAgIHByaXZhdGUgdG9wOiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxpbmVOdW1iZXI6IG51bWJlciwgZmlsZTogVEZpbGUsIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4sIHRvcDogYm9vbGVhbikge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgdGhpcy5saW5lTnVtYmVyID0gbGluZU51bWJlcjtcbiAgICAgICAgdGhpcy5pbkZyb250bWF0dGVyID0gaW5Gcm9udG1hdHRlcjtcbiAgICAgICAgdGhpcy5maWxlID0gZmlsZTtcbiAgICAgICAgdGhpcy50b3AgPSB0b3A7XG4gICAgfVxuXG4gICAgb25PcGVuKCkge1xuICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChcIkluc2VydCBuZXcgZmllbGRcIik7XG4gICAgICAgIGNvbnN0IGFkZE5ld0ZpZWxkQ29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnN0IG5hbWVJbnB1dENvbnRhaW5lciA9IGFkZE5ld0ZpZWxkQ29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBuYW1lSW5wdXRDb250YWluZXIuc2V0VGV4dChcIkZpZWxkIE5hbWU6IFwiKTtcbiAgICAgICAgY29uc3QgbmFtZUlucHV0RWwgPSBuZXcgVGV4dENvbXBvbmVudChuYW1lSW5wdXRDb250YWluZXIpO1xuICAgICAgICBuYW1lSW5wdXRFbC5zZXRQbGFjZWhvbGRlcihcIkZpZWxkIG5hbWVcIik7XG4gICAgICAgIGNvbnN0IHZhbHVlSW5wdXRDb250YWluZXIgPSBhZGROZXdGaWVsZENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgdmFsdWVJbnB1dENvbnRhaW5lci5zZXRUZXh0KFwiRmllbGQgdmFsdWU6IFwiKTtcbiAgICAgICAgY29uc3QgdmFsdWVJbnB1dEVsID0gbmV3IFRleHRDb21wb25lbnQodmFsdWVJbnB1dENvbnRhaW5lcik7XG4gICAgICAgIHZhbHVlSW5wdXRFbC5zZXRQbGFjZWhvbGRlcihcIkZpZWxkIHZhbHVlXCIpO1xuICAgICAgICBjb25zdCBmb290ZXJCdXR0b25zID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHtcbiAgICAgICAgICAgIGNsczogJ21ldGFkYXRhLW1lbnUtdGV4dGFyZWEtYnV0dG9ucydcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHNhdmVCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGZvb3RlckJ1dHRvbnMpO1xuICAgICAgICBzYXZlQnV0dG9uLnNldEljb24oXCJjaGVja21hcmtcIik7XG4gICAgICAgIHNhdmVCdXR0b24ub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKHRoaXMuZmlsZSlcbiAgICAgICAgICAgIGxldCBuZXdDb250ZW50OiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICAgICAgaWYgKHRoaXMudG9wKSB7XG4gICAgICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKGAke25hbWVJbnB1dEVsLmdldFZhbHVlKCl9JHt0aGlzLmluRnJvbnRtYXR0ZXIgPyBcIjpcIiA6IFwiOjpcIn0gJHt2YWx1ZUlucHV0RWwuZ2V0VmFsdWUoKX1gKTtcbiAgICAgICAgICAgICAgICByZXN1bHQuc3BsaXQoXCJcXG5cIikuZm9yRWFjaCgobGluZSwgX2xpbmVOdW1iZXIpID0+IG5ld0NvbnRlbnQucHVzaChsaW5lKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5zcGxpdChcIlxcblwiKS5mb3JFYWNoKChsaW5lLCBfbGluZU51bWJlcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2gobGluZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfbGluZU51bWJlciA9PSB0aGlzLmxpbmVOdW1iZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChgJHtuYW1lSW5wdXRFbC5nZXRWYWx1ZSgpfSR7dGhpcy5pbkZyb250bWF0dGVyID8gXCI6XCIgOiBcIjo6XCJ9ICR7dmFsdWVJbnB1dEVsLmdldFZhbHVlKCl9YCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm1vZGlmeSh0aGlzLmZpbGUsIG5ld0NvbnRlbnQuam9pbignXFxuJykpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gbmV3IEV4dHJhQnV0dG9uQ29tcG9uZW50KGZvb3RlckJ1dHRvbnMpO1xuICAgICAgICBjYW5jZWxCdXR0b24uc2V0SWNvbihcImNyb3NzXCIpO1xuICAgICAgICBjYW5jZWxCdXR0b24ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuXG5cbiAgICB9O1xufTsiLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgVG9nZ2xlQ29tcG9uZW50LCBURmlsZSwgQnV0dG9uQ29tcG9uZW50LCBFeHRyYUJ1dHRvbkNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyB2YWx1ZVRvZ2dsZU1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgcHJpdmF0ZSBmaWxlOiBURmlsZTtcbiAgICBwcml2YXRlIG5hbWU6IHN0cmluZztcbiAgICBwcml2YXRlIHZhbHVlOiBib29sZWFuO1xuICAgIHByaXZhdGUgbGluZU51bWJlcjogbnVtYmVyO1xuICAgIHByaXZhdGUgaW5Gcm9udG1hdHRlcjogYm9vbGVhbjtcbiAgICBwcml2YXRlIHRvcDogYm9vbGVhbjtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBmaWxlOiBURmlsZSwgbmFtZTogc3RyaW5nLCB2YWx1ZTogYm9vbGVhbiwgbGluZU51bWJlcjogbnVtYmVyID0gLTEsIGluRnJvbnRNYXR0ZXI6IGJvb2xlYW4gPSBmYWxzZSwgdG9wOiBib29sZWFuID0gZmFsc2UpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMuZmlsZSA9IGZpbGU7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5saW5lTnVtYmVyID0gbGluZU51bWJlcjtcbiAgICAgICAgdGhpcy5pbkZyb250bWF0dGVyID0gaW5Gcm9udE1hdHRlcjtcbiAgICAgICAgdGhpcy50b3AgPSB0b3A7XG4gICAgfTtcblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgY29uc3QgaW5wdXREaXYgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoe1xuICAgICAgICAgICAgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdG9nZ2xlclwiXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmJ1aWxkVG9nZ2xlRWwoaW5wdXREaXYpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGJ1aWxkVG9nZ2xlRWwoaW5wdXREaXY6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHRvZ2dsZUVsID0gbmV3IFRvZ2dsZUNvbXBvbmVudChpbnB1dERpdik7XG4gICAgICAgIHRvZ2dsZUVsLnNldFZhbHVlKHRoaXMudmFsdWUpO1xuICAgICAgICB0b2dnbGVFbC5vbkNoYW5nZSh2YWx1ZSA9PiB7IHRoaXMudmFsdWUgPSB2YWx1ZSB9KVxuICAgICAgICBjb25zdCBmb290ZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1ncmlkLWZvb3RlclwiIH0pO1xuICAgICAgICBjb25zdCBzYXZlQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChmb290ZXIpO1xuICAgICAgICBzYXZlQnV0dG9uLnNldEljb24oXCJjaGVja21hcmtcIik7XG4gICAgICAgIHNhdmVCdXR0b24ub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMudmFsdWUudG9TdHJpbmcoKVxuICAgICAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgICAgIHJlcGxhY2VWYWx1ZXModGhpcy5hcHAsIHRoaXMuZmlsZSwgdGhpcy5uYW1lLCB2YWx1ZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQodGhpcy5maWxlKVxuICAgICAgICAgICAgICAgIGxldCBuZXdDb250ZW50OiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnRvcCkge1xuICAgICAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2goYCR7dGhpcy5uYW1lfSR7dGhpcy5pbkZyb250bWF0dGVyID8gXCI6XCIgOiBcIjo6XCJ9ICR7dmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5zcGxpdChcIlxcblwiKS5mb3JFYWNoKChsaW5lLCBfbGluZU51bWJlcikgPT4gbmV3Q29udGVudC5wdXNoKGxpbmUpKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQuc3BsaXQoXCJcXG5cIikuZm9yRWFjaCgobGluZSwgX2xpbmVOdW1iZXIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChsaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfbGluZU51bWJlciA9PSB0aGlzLmxpbmVOdW1iZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2goYCR7dGhpcy5uYW1lfSR7dGhpcy5pbkZyb250bWF0dGVyID8gXCI6XCIgOiBcIjo6XCJ9ICR7dmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdGhpcy5hcHAudmF1bHQubW9kaWZ5KHRoaXMuZmlsZSwgbmV3Q29udGVudC5qb2luKCdcXG4nKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn07IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IERyb3Bkb3duQ29tcG9uZW50LCBNb2RhbCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IGNyZWF0ZUZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IHsgRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuICAgIHBsdWdpbjogTWV0YWRhdGFNZW51O1xuICAgIGZpbGU6IFRGaWxlO1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpbGU6IFRGaWxlKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLmZpbGUgPSBmaWxlO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBhc3luYyBvbk9wZW4oKSB7XG4gICAgICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KGBTZWxlY3QgdGhlIGZpZWxkIHRvIHVwZGF0ZWApO1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSBhd2FpdCBjcmVhdGVGaWxlQ2xhc3ModGhpcy5wbHVnaW4sIHRoaXMuZmlsZS5iYXNlbmFtZSlcbiAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQoYFNlbGVjdCB0aGUgZmllbGQgdG8gdXBkYXRlIGluICR7ZmlsZUNsYXNzLm5hbWV9YCk7XG4gICAgICAgIGNvbnN0IHNlbGVjdENvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdigpO1xuICAgICAgICBjb25zdCBzZWxlY3QgPSBuZXcgRHJvcGRvd25Db21wb25lbnQoc2VsZWN0Q29udGFpbmVyKTtcbiAgICAgICAgc2VsZWN0LmFkZE9wdGlvbihcInNlbGVjdCBhbiBhdHRyaWJ1dGVcIiwgXCItLXNlbGVjdCBhbiBhdHRyaWJ1dGUtLVwiKTtcbiAgICAgICAgZmlsZUNsYXNzLmF0dHJpYnV0ZXMuZm9yRWFjaChhdHRyID0+IHtcbiAgICAgICAgICAgIHNlbGVjdC5hZGRPcHRpb24oYXR0ci5uYW1lLCBhdHRyLm5hbWUpO1xuICAgICAgICB9KVxuXG4gICAgICAgIHNlbGVjdC5hZGRPcHRpb24oXCIrK25ld0F0dHIrK1wiLCBcIisrQWRkIGEgbmV3IGF0dHJpYnV0ZSsrXCIpO1xuICAgICAgICBzZWxlY3Qub25DaGFuZ2UoKGF0dHJOYW1lKSA9PiB7XG4gICAgICAgICAgICBpZiAoYXR0ck5hbWUgPT0gXCIrK25ld0F0dHJcIikge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlQ2xhc3MpO1xuICAgICAgICAgICAgICAgIG1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlQ2xhc3MsIGZpbGVDbGFzcy5hdHRyaWJ1dGVzLmZpbHRlcihhdHRyID0+IGF0dHIubmFtZSA9PSBhdHRyTmFtZSlbMF0pO1xuICAgICAgICAgICAgICAgIG1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxufSIsICJpbXBvcnQgeyBEcm9wZG93bkNvbXBvbmVudCwgTW9kYWwsIFRleHRDb21wb25lbnQsIEJ1dHRvbkNvbXBvbmVudCwgRXh0cmFCdXR0b25Db21wb25lbnQsIFRleHRBcmVhQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NBdHRyaWJ1dGUsIHR5cGVzIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzQXR0cmlidXRlXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3MgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NcIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcblxuXG5pbnRlcmZhY2UgRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwge1xuICAgIGF0dHI/OiBGaWxlQ2xhc3NBdHRyaWJ1dGU7XG4gICAgZmlsZUNsYXNzOiBGaWxlQ2xhc3M7XG4gICAgdHlwZTogc3RyaW5nO1xuICAgIG9wdGlvbnM6IHN0cmluZ1tdO1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBwbHVnaW46IE1ldGFkYXRhTWVudVxufVxuXG5jbGFzcyBGaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWxlQ2xhc3M6IEZpbGVDbGFzcywgYXR0cj86IEZpbGVDbGFzc0F0dHJpYnV0ZSkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cbiAgICAgICAgdGhpcy5hdHRyID0gYXR0cjtcbiAgICAgICAgdGhpcy5maWxlQ2xhc3MgPSBmaWxlQ2xhc3M7XG4gICAgICAgIGlmICh0aGlzLmF0dHIpIHtcbiAgICAgICAgICAgIHRoaXMudHlwZSA9IHRoaXMuYXR0ci50eXBlIHx8IFwiaW5wdXRcIjtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9IHRoaXMuYXR0ci5vcHRpb25zO1xuICAgICAgICAgICAgdGhpcy5uYW1lID0gdGhpcy5hdHRyLm5hbWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIC8vdGl0bGVcbiAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQodGhpcy5hdHRyID8gYE1hbmFnZSAke3RoaXMuYXR0ci5uYW1lfWAgOiBgQ3JlYXRlIGEgbmV3IGF0dHJpYnV0ZSBmb3IgJHt0aGlzLmZpbGVDbGFzcy5uYW1lfWApO1xuXG4gICAgICAgIC8vbmFtZSBpbnB1dFxuICAgICAgICBjb25zdCBuYW1lSW5wdXRDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoKTtcbiAgICAgICAgbmFtZUlucHV0Q29udGFpbmVyLnNldFRleHQoXCJuYW1lXCIpO1xuICAgICAgICBjb25zdCBuYW1lSW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudChuYW1lSW5wdXRDb250YWluZXIpO1xuICAgICAgICB0aGlzLmF0dHIgPyBuYW1lSW5wdXQuc2V0VmFsdWUodGhpcy5hdHRyLm5hbWUpIDogbmFtZUlucHV0LnNldFBsYWNlaG9sZGVyKFwiVHlwZSBhIG5hbWUgZm9yIHRoaXMgYXR0cmlidXRlXCIpO1xuXG4gICAgICAgIC8vaGVhZGVyIGZvciBzZWxlY3RcbiAgICAgICAgY29uc3QgdHlwZVNlbGVjdEhlYWRlciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdigpO1xuICAgICAgICBjb25zdCBhdHRyTGluZSA9IHR5cGVTZWxlY3RIZWFkZXIuY3JlYXRlRWwoXCJkaXZcIik7XG4gICAgICAgIGNvbnN0IGF0dHJOYW1lID0gYXR0ckxpbmUuY3JlYXRlRWwoXCJzdHJvbmdcIik7XG4gICAgICAgIGF0dHJOYW1lLnNldFRleHQoYDwke3RoaXMubmFtZX0+YCk7XG4gICAgICAgIGF0dHJMaW5lLmFwcGVuZChcIiBmaWVsZHMgaW4gZmlsZXMgd2l0aDpcIik7XG4gICAgICAgIFN0cmluZyhgLS0tXFxuJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhc306ICR7dGhpcy5maWxlQ2xhc3MubmFtZX1cXG4uLi5cXG4tLS1gKS5zcGxpdCgnXFxuJykuZm9yRWFjaChsaW5lID0+IHtcbiAgICAgICAgICAgIHR5cGVTZWxlY3RIZWFkZXIuY3JlYXRlRWwoXCJkaXZcIiwgXCJ5YW1sLW1ldGFkYXRhLW1lbnUtcmVkXCIpLnNldFRleHQobGluZSk7XG4gICAgICAgIH0pXG5cbiAgICAgICAgLy8gdHlwZSBzZWxlY3RcbiAgICAgICAgY29uc3QgdHlwZVNlbGVjdENvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogJ21ldGFkYXRhLW1lbnUtdmFsdWUtc2VsZWN0b3ItY29udGFpbmVyJyB9KTtcbiAgICAgICAgY29uc3QgdHlwZVNlbGVjdExhYmVsID0gdHlwZVNlbGVjdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXZhbHVlLXNlbGVjdG9yLWlubGluZS1sYWJlbCcgfSk7XG4gICAgICAgIHR5cGVTZWxlY3RMYWJlbC5zZXRUZXh0KFwid2lsbDogXCIpO1xuICAgICAgICBjb25zdCB0eXBlU2VsZWN0RHJvcERvd24gPSB0eXBlU2VsZWN0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ21ldGFkYXRhLW1lbnUtdmFsdWUtc2VsZWN0b3ItdG9nZ2xlcicgfSk7XG4gICAgICAgIGNvbnN0IHR5cGVTZWxlY3QgPSBuZXcgRHJvcGRvd25Db21wb25lbnQodHlwZVNlbGVjdERyb3BEb3duKTtcbiAgICAgICAgT2JqZWN0LmtleXModHlwZXMpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICAgIHR5cGVTZWxlY3QuYWRkT3B0aW9uKGtleSwgdHlwZXNba2V5XSk7XG4gICAgICAgIH0pXG4gICAgICAgIGlmICh0aGlzLmF0dHIpIHtcbiAgICAgICAgICAgIHR5cGVTZWxlY3Quc2V0VmFsdWUodGhpcy50eXBlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIG9wdGlvbnMgaW5wdXRcbiAgICAgICAgY29uc3Qgb3B0aW9uc0lucHV0Q29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiAnbWV0YWRhdGEtbWVudS12YWx1ZS1zZWxlY3Rvci1jb250YWluZXInIH0pO1xuICAgICAgICBjb25zdCBvcHRpb25zSW5wdXRMYWJlbCA9IG9wdGlvbnNJbnB1dENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXZhbHVlLXNlbGVjdG9yLWlubGluZS1sYWJlbC10b3AnIH0pO1xuICAgICAgICBvcHRpb25zSW5wdXRMYWJlbC5zZXRUZXh0KFwiVmFsdWVzXCIpO1xuICAgICAgICBjb25zdCBvcHRpb25zSW5wdXQgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQob3B0aW9uc0lucHV0Q29udGFpbmVyKTtcbiAgICAgICAgb3B0aW9uc0lucHV0LmlucHV0RWwucm93cyA9IDM7XG4gICAgICAgIG9wdGlvbnNJbnB1dC5pbnB1dEVsLmNvbHMgPSAyNjtcbiAgICAgICAgdGhpcy5hdHRyID8gb3B0aW9uc0lucHV0LnNldFZhbHVlKHRoaXMudHlwZSA9PSBcImlucHV0XCIgfHwgdGhpcy50eXBlID09IFwiYm9vbGVhblwiID8gXCJcIiA6IHRoaXMub3B0aW9ucy5qb2luKFwiLCBcIikpIDogb3B0aW9uc0lucHV0LnNldFBsYWNlaG9sZGVyKFwiaW5zZXJ0IHZhbHVlcywgY29tbWEgc2VwYXJhdGVkXCIpO1xuICAgICAgICAhdGhpcy5hdHRyIHx8IHRoaXMudHlwZSA9PSBcImlucHV0XCIgfHwgdGhpcy50eXBlID09IFwiYm9vbGVhblwiID8gb3B0aW9uc0lucHV0Q29udGFpbmVyLmhpZGUoKSA6IG9wdGlvbnNJbnB1dENvbnRhaW5lci5zaG93KCk7XG5cbiAgICAgICAgLy8gZXZlbnQgaGFuZGxlcnNcbiAgICAgICAgdHlwZVNlbGVjdC5vbkNoYW5nZSh0eXBlID0+IHtcbiAgICAgICAgICAgIHR5cGUgPT0gXCJpbnB1dFwiIHx8IHR5cGUgPT0gXCJib29sZWFuXCIgPyBvcHRpb25zSW5wdXRDb250YWluZXIuaGlkZSgpIDogb3B0aW9uc0lucHV0Q29udGFpbmVyLnNob3coKTtcbiAgICAgICAgICAgIHRoaXMudHlwZSA9IHR5cGU7XG4gICAgICAgIH0pXG4gICAgICAgIG9wdGlvbnNJbnB1dC5vbkNoYW5nZSh2YWx1ZSA9PiB0aGlzLm9wdGlvbnMgPSB2YWx1ZS5zcGxpdChcIixcIikubWFwKGl0ZW0gPT4gaXRlbS50cmltKCkpKTtcbiAgICAgICAgbmFtZUlucHV0Lm9uQ2hhbmdlKHZhbHVlID0+IHsgdGhpcy5uYW1lID0gdmFsdWU7IGF0dHJOYW1lLnNldFRleHQoYDwke3ZhbHVlfT5gKSB9KTtcblxuICAgICAgICAvLyBmb290ZXIgYnV0dG9uc1xuICAgICAgICBjb25zdCBmb290ZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1ncmlkLWZvb3RlclwiIH0pO1xuICAgICAgICBjb25zdCBzYXZlQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChmb290ZXIpO1xuICAgICAgICBzYXZlQnV0dG9uLnNldEljb24oXCJjaGVja21hcmtcIik7XG4gICAgICAgIHNhdmVCdXR0b24ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpbGVDbGFzcy51cGRhdGVBdHRyaWJ1dGUodGhpcy50eXBlLCB0aGlzLm9wdGlvbnMsIHRoaXMubmFtZSwgdGhpcy5hdHRyKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICAgICAgaWYgKHRoaXMuYXR0cikge1xuICAgICAgICAgICAgY29uc3QgcmVtb3ZlQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChmb290ZXIpO1xuICAgICAgICAgICAgcmVtb3ZlQnV0dG9uLnNldEljb24oXCJ0cmFzaFwiKTtcbiAgICAgICAgICAgIHJlbW92ZUJ1dHRvbi5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb25maXJtTW9kYWwgPSBuZXcgTW9kYWwodGhpcy5wbHVnaW4uYXBwKTtcbiAgICAgICAgICAgICAgICBjb25maXJtTW9kYWwudGl0bGVFbC5zZXRUZXh0KFwiUGxlYXNlIGNvbmZpcm1cIik7XG4gICAgICAgICAgICAgICAgY29uZmlybU1vZGFsLmNvbnRlbnRFbC5jcmVhdGVEaXYoKS5zZXRUZXh0KGBEbyB5b3UgcmVhbGx5IHdhbnQgdG8gcmVtb3ZlICR7dGhpcy5hdHRyPy5uYW1lfSBhdHRyaWJ1dGUgZnJvbSAke3RoaXMuZmlsZUNsYXNzLm5hbWV9P2ApO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbmZpcm1Gb290ZXIgPSBjb25maXJtTW9kYWwuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLWdyaWQtZm9vdGVyXCIgfSk7XG4gICAgICAgICAgICAgICAgY29uc3QgY29uZmlybUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoY29uZmlybUZvb3Rlcik7XG4gICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvbi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpO1xuICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b24ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmF0dHIpIHRoaXMuZmlsZUNsYXNzLnJlbW92ZUF0dHJpYnV0ZSh0aGlzLmF0dHIpO1xuICAgICAgICAgICAgICAgICAgICBjb25maXJtTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgY29uc3QgZGlzbWlzc0J1dHRvbiA9IG5ldyBFeHRyYUJ1dHRvbkNvbXBvbmVudChjb25maXJtRm9vdGVyKTtcbiAgICAgICAgICAgICAgICBkaXNtaXNzQnV0dG9uLnNldEljb24oXCJjcm9zc1wiKTtcbiAgICAgICAgICAgICAgICBkaXNtaXNzQnV0dG9uLm9uQ2xpY2soKCkgPT4gdGhpcy5jbG9zZSgpKTtcbiAgICAgICAgICAgICAgICBjb25maXJtTW9kYWwub3BlbigpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBuZXcgRXh0cmFCdXR0b25Db21wb25lbnQoZm9vdGVyKTtcbiAgICAgICAgY2FuY2VsQnV0dG9uLnNldEljb24oXCJjcm9zc1wiKTtcbiAgICAgICAgY2FuY2VsQnV0dG9uLm9uQ2xpY2soKCkgPT4gdGhpcy5jbG9zZSgpKTtcbiAgICB9XG59XG5cbmV4cG9ydCB7IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsIH0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgQXBwLCBURmlsZSwgTWVudSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHZhbHVlTXVsdGlTZWxlY3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbk1vZGFscy92YWx1ZU11bHRpU2VsZWN0TW9kYWxcIjtcbmltcG9ydCB2YWx1ZVRleHRJbnB1dE1vZGFsIGZyb20gXCJzcmMvb3B0aW9uTW9kYWxzL3ZhbHVlVGV4dElucHV0TW9kYWxcIjtcbmltcG9ydCB2YWx1ZVNlbGVjdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9uTW9kYWxzL3ZhbHVlU2VsZWN0TW9kYWxcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL0ZpZWxkXCI7XG5pbXBvcnQgY2hvb3NlU2VjdGlvbk1vZGFsIGZyb20gXCIuLi9vcHRpb25Nb2RhbHMvY2hvb3NlU2VjdGlvbk1vZGFsXCI7XG5pbXBvcnQgU2VsZWN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25Nb2RhbHMvU2VsZWN0TW9kYWxcIjtcbmltcG9ydCB7IGNyZWF0ZUZpbGVDbGFzcywgRmlsZUNsYXNzIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzXCI7XG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcIi4uL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCB7IGdldFByb3BlcnR5U2V0dGluZ3MgfSBmcm9tIFwic3JjL2NvbW1hbmRzL2dldFByb3BlcnR5U2V0dGluZ3NcIjtcbmltcG9ydCBGaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbCBmcm9tIFwic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbFwiO1xuaW1wb3J0IHsgZ2VuZXJpY0ZpZWxkUmVnZXggfSBmcm9tIFwiLi4vdXRpbHMvcGFyc2VyXCI7XG5cbmZ1bmN0aW9uIGlzTWVudShjYXRlZ29yeTogTWVudSB8IFNlbGVjdE1vZGFsKTogY2F0ZWdvcnkgaXMgTWVudSB7XG5cdHJldHVybiAoY2F0ZWdvcnkgYXMgTWVudSkuYWRkSXRlbSAhPT0gdW5kZWZpbmVkO1xufTtcblxuZnVuY3Rpb24gaXNTZWxlY3QoY2F0ZWdvcnk6IE1lbnUgfCBTZWxlY3RNb2RhbCk6IGNhdGVnb3J5IGlzIFNlbGVjdE1vZGFsIHtcblx0cmV0dXJuIChjYXRlZ29yeSBhcyBTZWxlY3RNb2RhbCkubW9kYWxzICE9PSB1bmRlZmluZWQ7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBPcHRpb25zTGlzdCB7XG5cdGFwcDogQXBwO1xuXHRmaWxlOiBURmlsZTtcblx0cGx1Z2luOiBNZXRhZGF0YU1lbnU7XG5cdHBhdGg6IHN0cmluZztcblx0Y2F0ZWdvcnk6IE1lbnUgfCBTZWxlY3RNb2RhbDtcblx0ZmlsZUNsYXNzOiBGaWxlQ2xhc3M7XG5cblx0Y29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpbGU6IFRGaWxlLCBjYXRlZ29yeTogTWVudSB8IFNlbGVjdE1vZGFsKSB7XG5cdFx0dGhpcy5maWxlID0gZmlsZTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLmNhdGVnb3J5ID0gY2F0ZWdvcnk7XG5cdH07XG5cblx0cHVibGljIGFzeW5jIGNyZWF0ZUV4dHJhT3B0aW9uTGlzdCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBmcm9udG1hdHRlciA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldENhY2hlKHRoaXMuZmlsZS5wYXRoKT8uZnJvbnRtYXR0ZXI7XG5cdFx0aWYgKGZyb250bWF0dGVyKSB7XG5cdFx0XHRjb25zdCB7IHBvc2l0aW9uLCAuLi5hdHRyaWJ1dGVzIH0gPSBmcm9udG1hdHRlcjtcblx0XHRcdE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmZvckVhY2goa2V5ID0+IHtcblx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbGx5SWdub3JlZEZpZWxkcy5pbmNsdWRlcyhrZXkpKSB7XG5cdFx0XHRcdFx0ZGVsZXRlIGF0dHJpYnV0ZXNba2V5XTtcblx0XHRcdFx0fTtcblx0XHRcdH0pO1xuXHRcdFx0aWYgKGlzTWVudSh0aGlzLmNhdGVnb3J5KSkgeyB0aGlzLmNhdGVnb3J5LmFkZFNlcGFyYXRvcigpOyB9O1xuXHRcdFx0bGV0IGZpbGVDbGFzc0ZvckZpZWxkcyA9IGZhbHNlO1xuXHRcdFx0bGV0IGZpbGVDbGFzc0ZpZWxkczogc3RyaW5nW10gPSBbXTtcblx0XHRcdGNvbnN0IGZpbGVDbGFzc0FsaWFzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXM7XG5cdFx0XHRpZiAoT2JqZWN0LmtleXMoYXR0cmlidXRlcykuaW5jbHVkZXMoZmlsZUNsYXNzQWxpYXMpKSB7XG5cdFx0XHRcdGNvbnN0IGZpbGVDbGFzcyA9IGF0dHJpYnV0ZXNbZmlsZUNsYXNzQWxpYXNdO1xuXHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdGNvbnN0IF9maWxlQ2xhc3MgPSBhd2FpdCBjcmVhdGVGaWxlQ2xhc3ModGhpcy5wbHVnaW4sIGZpbGVDbGFzcylcblx0XHRcdFx0XHR0aGlzLmZpbGVDbGFzcyA9IF9maWxlQ2xhc3M7XG5cdFx0XHRcdFx0ZmlsZUNsYXNzRmllbGRzID0gX2ZpbGVDbGFzcy5hdHRyaWJ1dGVzLm1hcChhdHRyID0+IGF0dHIubmFtZSk7XG5cdFx0XHRcdFx0ZmlsZUNsYXNzRm9yRmllbGRzID0gdHJ1ZTtcblx0XHRcdFx0XHRPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5mb3JFYWNoKGtleSA9PiB7XG5cdFx0XHRcdFx0XHRpZiAoIWZpbGVDbGFzc0ZpZWxkcy5pbmNsdWRlcyhrZXkpICYmIGtleSAhPSBmaWxlQ2xhc3NBbGlhcykge1xuXHRcdFx0XHRcdFx0XHRkZWxldGUgYXR0cmlidXRlc1trZXldO1xuXHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbCA9IG5ldyBGaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbCh0aGlzLnBsdWdpbiwgdGhpcy5maWxlQ2xhc3MuZ2V0Q2xhc3NGaWxlKCkpO1xuXHRcdFx0XHRcdGlmIChpc01lbnUodGhpcy5jYXRlZ29yeSkpIHtcblx0XHRcdFx0XHRcdHRoaXMuY2F0ZWdvcnkuYWRkU2VwYXJhdG9yKCk7XG5cdFx0XHRcdFx0XHR0aGlzLmNhdGVnb3J5LmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0XHRcdFx0aXRlbS5zZXRJY29uKFwiZ2VhclwiKTtcblx0XHRcdFx0XHRcdFx0aXRlbS5zZXRUaXRsZShgTWFuYWdlIDwke3RoaXMuZmlsZUNsYXNzLm5hbWV9PiBmaWVsZHNgKTtcblx0XHRcdFx0XHRcdFx0aXRlbS5vbkNsaWNrKChldnQpID0+IHtcblx0XHRcdFx0XHRcdFx0XHRmaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbC5vcGVuKCk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHRoaXMuY2F0ZWdvcnkuYWRkT3B0aW9uKFwibWFuYWdlX2ZpbGVDbGFzc19hdHRyaWJ1dGVzXCIsIGBNYW5hZ2UgPCR7dGhpcy5maWxlQ2xhc3MubmFtZX0+IGZpZWxkc2ApO1xuXHRcdFx0XHRcdFx0dGhpcy5jYXRlZ29yeS5tb2RhbHNbXCJtYW5hZ2VfZmlsZUNsYXNzX2F0dHJpYnV0ZXNcIl0gPSAoKSA9PiBmaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbC5vcGVuKCk7XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdGF3YWl0IHRoaXMuY3JlYXRlRXh0cmFPcHRpb25zTGlzdEZvckZyb250bWF0dGVyKGF0dHJpYnV0ZXMsKVxuXHRcdFx0XHRcdGF3YWl0IHRoaXMuY3JlYXRlRXh0cmFPcHRpb25zTGlzdEZvcklubGluZUZpZWxkcyh0aGlzLmZpbGUsIGZpbGVDbGFzc0ZvckZpZWxkcywgZmlsZUNsYXNzRmllbGRzKVxuXHRcdFx0XHRcdGlmIChpc01lbnUodGhpcy5jYXRlZ29yeSkpIHsgdGhpcy5jYXRlZ29yeS5hZGRTZXBhcmF0b3IoKSB9O1xuXHRcdFx0XHRcdHRoaXMuYWRkU2VjdGlvblNlbGVjdE1vZGFsT3B0aW9uKCk7XG5cdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5jcmVhdGVFeHRyYU9wdGlvbnNMaXN0Rm9yRnJvbnRtYXR0ZXIoYXR0cmlidXRlcylcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmNyZWF0ZUV4dHJhT3B0aW9uc0xpc3RGb3JJbmxpbmVGaWVsZHModGhpcy5maWxlKVxuXHRcdFx0XHRcdGlmIChpc01lbnUodGhpcy5jYXRlZ29yeSkpIHsgdGhpcy5jYXRlZ29yeS5hZGRTZXBhcmF0b3IoKTsgfTtcblx0XHRcdFx0XHR0aGlzLmFkZFNlY3Rpb25TZWxlY3RNb2RhbE9wdGlvbigpO1xuXHRcdFx0XHR9O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5jcmVhdGVFeHRyYU9wdGlvbnNMaXN0Rm9yRnJvbnRtYXR0ZXIoYXR0cmlidXRlcylcblx0XHRcdFx0YXdhaXQgdGhpcy5jcmVhdGVFeHRyYU9wdGlvbnNMaXN0Rm9ySW5saW5lRmllbGRzKHRoaXMuZmlsZSlcblx0XHRcdFx0aWYgKGlzTWVudSh0aGlzLmNhdGVnb3J5KSkgeyB0aGlzLmNhdGVnb3J5LmFkZFNlcGFyYXRvcigpOyB9O1xuXHRcdFx0XHR0aGlzLmFkZFNlY3Rpb25TZWxlY3RNb2RhbE9wdGlvbigpO1xuXHRcdFx0fTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0YXdhaXQgdGhpcy5jcmVhdGVFeHRyYU9wdGlvbnNMaXN0Rm9ySW5saW5lRmllbGRzKHRoaXMuZmlsZSlcblx0XHRcdGlmIChpc01lbnUodGhpcy5jYXRlZ29yeSkpIHsgdGhpcy5jYXRlZ29yeS5hZGRTZXBhcmF0b3IoKTsgfTtcblx0XHRcdHRoaXMuYWRkU2VjdGlvblNlbGVjdE1vZGFsT3B0aW9uKCk7XG5cdFx0fTtcblx0fTtcblxuXHRwcml2YXRlIGFzeW5jIGNyZWF0ZUV4dHJhT3B0aW9uc0xpc3RGb3JJbmxpbmVGaWVsZHMoZmlsZTogVEZpbGUsIGZpbGVDbGFzc0ZvckZpZWxkczogYm9vbGVhbiA9IGZhbHNlLCBmaWxlQ2xhc3NGaWVsZHM6IHN0cmluZ1tdID0gW10pOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRsZXQgYXR0cmlidXRlczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9O1xuXHRcdGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgXiR7Z2VuZXJpY0ZpZWxkUmVnZXh9OjpcXHMqKD88dmFsdWVzPi4rKT9gLCBcInVcIik7XG5cdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LnJlYWQoZmlsZSlcblx0XHRyZXN1bHQuc3BsaXQoJ1xcbicpLm1hcChsaW5lID0+IHtcblx0XHRcdGNvbnN0IHJlZ2V4UmVzdWx0ID0gbGluZS5tYXRjaChyZWdleCk7XG5cdFx0XHRjb25zdCB7IGF0dHJpYnV0ZSwgdmFsdWVzIH0gPSByZWdleFJlc3VsdD8uZ3JvdXBzIHx8IHt9XG5cdFx0XHRpZiAoYXR0cmlidXRlICYmICF0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxseUlnbm9yZWRGaWVsZHMuaW5jbHVkZXMoYXR0cmlidXRlLnRyaW0oKSkpIHtcblx0XHRcdFx0aWYgKGZpbGVDbGFzc0ZvckZpZWxkcykge1xuXHRcdFx0XHRcdGlmIChmaWxlQ2xhc3NGaWVsZHMuaW5jbHVkZXMoYXR0cmlidXRlLnRyaW0oKSkpIHtcblx0XHRcdFx0XHRcdGF0dHJpYnV0ZXNbYXR0cmlidXRlLnRyaW0oKV0gPSB2YWx1ZXMgPyB2YWx1ZXMudHJpbSgpIDogXCJcIjtcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGF0dHJpYnV0ZXNbYXR0cmlidXRlLnRyaW0oKV0gPSB2YWx1ZXMgPyB2YWx1ZXMudHJpbSgpIDogXCJcIjtcblx0XHRcdFx0fTtcblx0XHRcdH07XG5cdFx0fSk7XG5cdFx0aWYgKE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmxlbmd0aCA+IDApIHtcblx0XHRcdGlmIChpc01lbnUodGhpcy5jYXRlZ29yeSkpIHsgdGhpcy5jYXRlZ29yeS5hZGRTZXBhcmF0b3IoKTsgfTtcblx0XHRcdHRoaXMuYnVpbGRFeHRyYU9wdGlvbnNMaXN0KGF0dHJpYnV0ZXMpO1xuXHRcdH07XG5cdH07XG5cblx0cHJpdmF0ZSBhc3luYyBjcmVhdGVFeHRyYU9wdGlvbnNMaXN0Rm9yRnJvbnRtYXR0ZXIoYXR0cmlidXRlczogUmVjb3JkPHN0cmluZywgc3RyaW5nPikge1xuXHRcdHRoaXMuYnVpbGRFeHRyYU9wdGlvbnNMaXN0KGF0dHJpYnV0ZXMsKTtcblx0fTtcblxuXHRidWlsZEV4dHJhT3B0aW9uc0xpc3QoYXR0cmlidXRlczogUmVjb3JkPHN0cmluZywgc3RyaW5nPikge1xuXHRcdE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmZvckVhY2goKGtleTogc3RyaW5nKSA9PiB7XG5cdFx0XHRjb25zdCB2YWx1ZSA9IGF0dHJpYnV0ZXNba2V5XTtcblx0XHRcdGNvbnN0IHByb3BlcnR5U2V0dGluZ3MgPSBnZXRQcm9wZXJ0eVNldHRpbmdzKHRoaXMucGx1Z2luLCBrZXksIHRoaXMuZmlsZUNsYXNzKTtcblx0XHRcdGlmIChwcm9wZXJ0eVNldHRpbmdzPy52YWx1ZXMgJiYgIXByb3BlcnR5U2V0dGluZ3M/LmlzQm9vbGVhbikge1xuXHRcdFx0XHRpZiAocHJvcGVydHlTZXR0aW5ncy5pc0N5Y2xlKSB7XG5cdFx0XHRcdFx0dGhpcy5hZGRDeWNsZU1lbnVPcHRpb24oa2V5LCB2YWx1ZSwgcHJvcGVydHlTZXR0aW5ncyk7XG5cdFx0XHRcdH0gZWxzZSBpZiAocHJvcGVydHlTZXR0aW5ncy5pc011bHRpKSB7XG5cdFx0XHRcdFx0dGhpcy5hZGRNdWx0aU1lbnVPcHRpb24oa2V5LCB2YWx1ZSwgcHJvcGVydHlTZXR0aW5ncyk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dGhpcy5hZGRTZWxlY3RNZW51T3B0aW9uKGtleSwgdmFsdWUsIHByb3BlcnR5U2V0dGluZ3MpO1xuXHRcdFx0XHR9O1xuXHRcdFx0fSBlbHNlIGlmIChwcm9wZXJ0eVNldHRpbmdzPy5pc0Jvb2xlYW4pIHtcblx0XHRcdFx0bGV0IHRvQm9vbGVhblZhbHVlOiBib29sZWFuID0gZmFsc2U7XG5cdFx0XHRcdGlmIChpc0Jvb2xlYW4odmFsdWUpKSB7XG5cdFx0XHRcdFx0dG9Cb29sZWFuVmFsdWUgPSB2YWx1ZTtcblx0XHRcdFx0fSBlbHNlIGlmICgvdHJ1ZS9pLnRlc3QodmFsdWUpKSB7XG5cdFx0XHRcdFx0dG9Cb29sZWFuVmFsdWUgPSB0cnVlO1xuXHRcdFx0XHR9IGVsc2UgaWYgKC9mYWxzZS9pLnRlc3QodmFsdWUpKSB7XG5cdFx0XHRcdFx0dG9Cb29sZWFuVmFsdWUgPSBmYWxzZTtcblx0XHRcdFx0fTtcblx0XHRcdFx0dGhpcy5hZGRUb2dnbGVNZW51T3B0aW9uKGtleSwgdG9Cb29sZWFuVmFsdWUpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5hZGRUZXh0SW5wdXRNZW51T3B0aW9uKGtleSwgdmFsdWUgPyB2YWx1ZS50b1N0cmluZygpIDogXCJcIik7XG5cdFx0XHR9O1xuXHRcdH0pO1xuXHR9O1xuXG5cdHByaXZhdGUgYWRkU2VjdGlvblNlbGVjdE1vZGFsT3B0aW9uKCk6IHZvaWQge1xuXHRcdGNvbnN0IG1vZGFsID0gbmV3IGNob29zZVNlY3Rpb25Nb2RhbCh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB0aGlzLmZpbGVDbGFzcyk7XG5cdFx0aWYgKGlzTWVudSh0aGlzLmNhdGVnb3J5KSkge1xuXHRcdFx0dGhpcy5jYXRlZ29yeS5hZGRJdGVtKChpdGVtKSA9PiB7XG5cdFx0XHRcdGl0ZW0uc2V0SWNvbihcInBlbmNpbFwiKTtcblx0XHRcdFx0aXRlbS5zZXRUaXRsZShcIkFkZCBmaWVsZCBhdCBzZWN0aW9uLi4uXCIpO1xuXHRcdFx0XHRpdGVtLm9uQ2xpY2soKGV2dDogTW91c2VFdmVudCkgPT4ge1xuXHRcdFx0XHRcdG1vZGFsLm9wZW4oKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdGl0ZW0uc2V0U2VjdGlvbihcInRhcmdldC1tZXRhZGF0YVwiKTtcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSBpZiAoaXNTZWxlY3QodGhpcy5jYXRlZ29yeSkpIHtcblx0XHRcdHRoaXMuY2F0ZWdvcnkuYWRkT3B0aW9uKFwiYWRkX2ZpZWxkX2F0X3NlY3Rpb25cIiwgXCJBZGQgZmllbGQgYXQgc2VjdGlvbi4uLlwiKTtcblx0XHRcdHRoaXMuY2F0ZWdvcnkubW9kYWxzW1wiYWRkX2ZpZWxkX2F0X3NlY3Rpb25cIl0gPSAoKSA9PiBtb2RhbC5vcGVuKCk7XG5cdFx0fTtcblx0fTtcblxuXHRwcml2YXRlIGFkZEN5Y2xlTWVudU9wdGlvbihuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIHByb3BlcnR5U2V0dGluZ3M6IEZpZWxkKTogdm9pZCB7XG5cdFx0Y29uc3QgdmFsdWVzID0gcHJvcGVydHlTZXR0aW5ncy52YWx1ZXM7XG5cdFx0Y29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHZhbHVlcyk7XG5cdFx0Y29uc3Qga2V5Rm9yVmFsdWUgPSBrZXlzLmZpbmQoa2V5ID0+IHZhbHVlc1trZXldID09PSB2YWx1ZSk7XG5cdFx0bGV0IG5leHRWYWx1ZTogc3RyaW5nO1xuXHRcdGlmIChrZXlGb3JWYWx1ZSkge1xuXHRcdFx0Y29uc3QgbmV4dEtleSA9IGtleXNbKGtleXMuaW5kZXhPZihrZXlGb3JWYWx1ZSkgKyAxKSAlIGtleXMubGVuZ3RoXTtcblx0XHRcdG5leHRWYWx1ZSA9IHZhbHVlc1tuZXh0S2V5XTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0bmV4dFZhbHVlID0gdmFsdWVzW09iamVjdC5rZXlzKHZhbHVlcylbMF1dO1xuXHRcdH07XG5cdFx0aWYgKGlzTWVudSh0aGlzLmNhdGVnb3J5KSkge1xuXHRcdFx0dGhpcy5jYXRlZ29yeS5hZGRJdGVtKChpdGVtKSA9PiB7XG5cdFx0XHRcdGl0ZW0uc2V0VGl0bGUoYCR7bmFtZX0gOiAke3ZhbHVlfSBcdTI1QjcgJHtuZXh0VmFsdWV9YCk7XG5cdFx0XHRcdGl0ZW0uc2V0SWNvbignc3dpdGNoJyk7XG5cdFx0XHRcdGl0ZW0ub25DbGljaygoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0cmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbi5hcHAsIHRoaXMuZmlsZSwgbmFtZSwgbmV4dFZhbHVlKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdGl0ZW0uc2V0U2VjdGlvbihcInRhcmdldC1tZXRhZGF0YVwiKTtcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSBpZiAoaXNTZWxlY3QodGhpcy5jYXRlZ29yeSkpIHtcblx0XHRcdHRoaXMuY2F0ZWdvcnkuYWRkT3B0aW9uKGAke25hbWV9XyR7dmFsdWV9XyR7bmV4dFZhbHVlfWAsIGAke25hbWV9IDogJHt2YWx1ZX0gXHUyNUI3ICR7bmV4dFZhbHVlfWApO1xuXHRcdFx0dGhpcy5jYXRlZ29yeS5tb2RhbHNbYCR7bmFtZX1fJHt2YWx1ZX1fJHtuZXh0VmFsdWV9YF0gPSAoKSA9PlxuXHRcdFx0XHRyZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLmFwcCwgdGhpcy5maWxlLCBuYW1lLCBuZXh0VmFsdWUpO1xuXHRcdH07XG5cdH07XG5cblx0cHJpdmF0ZSBhZGRNdWx0aU1lbnVPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBwcm9wZXJ0eVNldHRpbmdzOiBGaWVsZCk6IHZvaWQge1xuXHRcdGNvbnN0IG1vZGFsID0gbmV3IHZhbHVlTXVsdGlTZWxlY3RNb2RhbCh0aGlzLnBsdWdpbi5hcHAsIHRoaXMuZmlsZSwgbmFtZSwgdmFsdWUsIHByb3BlcnR5U2V0dGluZ3MpO1xuXHRcdG1vZGFsLnRpdGxlRWwuc2V0VGV4dChcIlNlbGVjdCB2YWx1ZXNcIik7XG5cdFx0aWYgKGlzTWVudSh0aGlzLmNhdGVnb3J5KSkge1xuXHRcdFx0dGhpcy5jYXRlZ29yeS5hZGRJdGVtKChpdGVtKSA9PiB7XG5cdFx0XHRcdGl0ZW0uc2V0VGl0bGUoYFVwZGF0ZSA8JHtuYW1lfT5gKTtcblx0XHRcdFx0aXRlbS5zZXRJY29uKCdidWxsZXQtbGlzdCcpO1xuXHRcdFx0XHRpdGVtLm9uQ2xpY2soKGV2dDogTW91c2VFdmVudCkgPT4ge1xuXHRcdFx0XHRcdG1vZGFsLm9wZW4oKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdGl0ZW0uc2V0U2VjdGlvbihcInRhcmdldC1tZXRhZGF0YVwiKTtcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSBpZiAoaXNTZWxlY3QodGhpcy5jYXRlZ29yeSkpIHtcblx0XHRcdHRoaXMuY2F0ZWdvcnkuYWRkT3B0aW9uKGB1cGRhdGVfJHtuYW1lfWAsIGBVcGRhdGUgPCR7bmFtZX0+YCk7XG5cdFx0XHR0aGlzLmNhdGVnb3J5Lm1vZGFsc1tgdXBkYXRlXyR7bmFtZX1gXSA9ICgpID0+IG1vZGFsLm9wZW4oKTtcblx0XHR9O1xuXHR9O1xuXG5cdHByaXZhdGUgYWRkU2VsZWN0TWVudU9wdGlvbihuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIHByb3BlcnR5U2V0dGluZ3M6IEZpZWxkKTogdm9pZCB7XG5cdFx0Y29uc3QgbW9kYWwgPSBuZXcgdmFsdWVTZWxlY3RNb2RhbCh0aGlzLnBsdWdpbi5hcHAsIHRoaXMuZmlsZSwgbmFtZSwgdmFsdWUsIHByb3BlcnR5U2V0dGluZ3MpO1xuXHRcdG1vZGFsLnRpdGxlRWwuc2V0VGV4dChcIlNlbGVjdCB2YWx1ZVwiKTtcblx0XHRpZiAoaXNNZW51KHRoaXMuY2F0ZWdvcnkpKSB7XG5cdFx0XHR0aGlzLmNhdGVnb3J5LmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0aXRlbS5zZXRUaXRsZShgVXBkYXRlICR7bmFtZX1gKTtcblx0XHRcdFx0aXRlbS5zZXRJY29uKCdyaWdodC10cmlhbmdsZScpO1xuXHRcdFx0XHRpdGVtLm9uQ2xpY2soKGV2dDogTW91c2VFdmVudCkgPT4gbW9kYWwub3BlbigpKTtcblx0XHRcdFx0aXRlbS5zZXRTZWN0aW9uKFwidGFyZ2V0LW1ldGFkYXRhXCIpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIGlmIChpc1NlbGVjdCh0aGlzLmNhdGVnb3J5KSkge1xuXHRcdFx0dGhpcy5jYXRlZ29yeS5hZGRPcHRpb24oYHVwZGF0ZV8ke25hbWV9YCwgYFVwZGF0ZSA8JHtuYW1lfT5gKTtcblx0XHRcdHRoaXMuY2F0ZWdvcnkubW9kYWxzW2B1cGRhdGVfJHtuYW1lfWBdID0gKCkgPT4gbW9kYWwub3BlbigpO1xuXHRcdH07XG5cdH07XG5cblx0cHJpdmF0ZSBhZGRUb2dnbGVNZW51T3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IGJvb2xlYW4pOiB2b2lkIHtcblx0XHRpZiAoaXNNZW51KHRoaXMuY2F0ZWdvcnkpKSB7XG5cdFx0XHR0aGlzLmNhdGVnb3J5LmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0aXRlbS5zZXRUaXRsZShgPCR7bmFtZX0+ICR7dmFsdWUgPyBcIlx1MjcwNSBcdTI1QjcgXHUyNzRDXCIgOiBcIlx1Mjc0QyBcdTI1QjcgXHUyNzA1XCJ9YCk7XG5cdFx0XHRcdGl0ZW0uc2V0SWNvbignY2hlY2ttYXJrJyk7XG5cdFx0XHRcdGl0ZW0ub25DbGljaygoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4uYXBwLCB0aGlzLmZpbGUsIG5hbWUsICghdmFsdWUpLnRvU3RyaW5nKCkpOyB9KTtcblx0XHRcdFx0aXRlbS5zZXRTZWN0aW9uKFwidGFyZ2V0LW1ldGFkYXRhXCIpO1xuXHRcdFx0fSlcblx0XHR9IGVsc2UgaWYgKGlzU2VsZWN0KHRoaXMuY2F0ZWdvcnkpKSB7XG5cdFx0XHR0aGlzLmNhdGVnb3J5LmFkZE9wdGlvbihgdXBkYXRlXyR7bmFtZX1gLCBgPCR7bmFtZX0+ICR7dmFsdWUgPyBcIlx1MjcwNSBcdTI1QjcgXHUyNzRDXCIgOiBcIlx1Mjc0QyBcdTI1QjcgXHUyNzA1XCJ9YCk7XG5cdFx0XHR0aGlzLmNhdGVnb3J5Lm1vZGFsc1tgdXBkYXRlXyR7bmFtZX1gXSA9ICgpID0+IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4uYXBwLCB0aGlzLmZpbGUsIG5hbWUsICghdmFsdWUpLnRvU3RyaW5nKCkpOztcblx0XHR9O1xuXHR9O1xuXG5cdHByaXZhdGUgYWRkVGV4dElucHV0TWVudU9wdGlvbihuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb25zdCBtb2RhbCA9IG5ldyB2YWx1ZVRleHRJbnB1dE1vZGFsKHRoaXMucGx1Z2luLmFwcCwgdGhpcy5maWxlLCBuYW1lLCB2YWx1ZSk7XG5cdFx0bW9kYWwudGl0bGVFbC5zZXRUZXh0KGBDaGFuZ2UgVmFsdWUgZm9yIDwke25hbWV9PmApO1xuXHRcdGlmIChpc01lbnUodGhpcy5jYXRlZ29yeSkpIHtcblx0XHRcdHRoaXMuY2F0ZWdvcnkuYWRkSXRlbSgoaXRlbSkgPT4ge1xuXHRcdFx0XHRpdGVtLnNldFRpdGxlKGBVcGRhdGUgPCR7bmFtZX0+YCk7XG5cdFx0XHRcdGl0ZW0uc2V0SWNvbigncGVuY2lsJyk7XG5cdFx0XHRcdGl0ZW0ub25DbGljaygoZXZ0OiBNb3VzZUV2ZW50KSA9PiBtb2RhbC5vcGVuKCkpO1xuXHRcdFx0XHRpdGVtLnNldFNlY3Rpb24oXCJ0YXJnZXQtbWV0YWRhdGFcIik7XG5cdFx0XHR9KVxuXHRcdH0gZWxzZSBpZiAoaXNTZWxlY3QodGhpcy5jYXRlZ29yeSkpIHtcblx0XHRcdHRoaXMuY2F0ZWdvcnkuYWRkT3B0aW9uKGB1cGRhdGVfJHtuYW1lfWAsIGBVcGRhdGUgPCR7bmFtZX0+YCk7XG5cdFx0XHR0aGlzLmNhdGVnb3J5Lm1vZGFsc1tgdXBkYXRlXyR7bmFtZX1gXSA9ICgpID0+IG1vZGFsLm9wZW4oKTtcblx0XHR9O1xuXHR9O1xufTtcbiIsICJpbXBvcnQgeyBBcHAsIE1vZGFsLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IE9wdGlvbnNMaXN0IGZyb20gXCJzcmMvb3B0aW9ucy9PcHRpb25zTGlzdFwiO1xuaW1wb3J0IFNlbGVjdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9uTW9kYWxzL1NlbGVjdE1vZGFsXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE5vdGVGaWVsZHNDb21tYW5kc01vZGFsIGV4dGVuZHMgTW9kYWwge1xuICAgIHB1YmxpYyBhcHA6IEFwcDtcbiAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51O1xuICAgIHByaXZhdGUgZmlsZTogVEZpbGU7XG4gICAgcHJpdmF0ZSBzZWxlY3Q6IFNlbGVjdE1vZGFsO1xuICAgIHByaXZhdGUgb3B0aW9uc0xpc3Q6IE9wdGlvbnNMaXN0O1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWxlOiBURmlsZSkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIHRoaXMuZmlsZSA9IGZpbGU7XG4gICAgfTtcblxuICAgIGFzeW5jIG9uT3BlbigpIHtcbiAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQoYFNlbGVjdCB0aGUgZmllbGQgdG8gbWFuYWdlYCk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51XCIpO1xuICAgICAgICBjb25zdCBvcHRpb25zTGlzdENvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1vcHRpb25zXCJ9KTtcblxuICAgICAgICB0aGlzLnNlbGVjdCA9IG5ldyBTZWxlY3RNb2RhbChvcHRpb25zTGlzdENvbnRhaW5lcik7XG4gICAgICAgIHRoaXMuc2VsZWN0LmFkZE9wdGlvbihcIi0tLVwiLCBcIkNob29zZSBGaWVsZFwiKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMub3B0aW9uc0xpc3QgPSBuZXcgT3B0aW9uc0xpc3QodGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5zZWxlY3QpO1xuICAgICAgICBhd2FpdCB0aGlzLm9wdGlvbnNMaXN0LmNyZWF0ZUV4dHJhT3B0aW9uTGlzdCgpO1xuICAgICAgICB0aGlzLnNlbGVjdC5vbkNoYW5nZSgodmFsdWUpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0Lm1vZGFsc1t2YWx1ZV0oKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2VsZWN0LnNlbGVjdEVsLmZvY3VzKCk7XG4gICAgfTtcbn07IiwgImltcG9ydCB7IERyb3Bkb3duQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlbGVjdE1vZGFsIGV4dGVuZHMgRHJvcGRvd25Db21wb25lbnQge1xuICAgIHB1YmxpYyBtb2RhbHM6IFJlY29yZDxzdHJpbmcsIGFueT47XG5cbiAgICBjb25zdHJ1Y3Rvcihjb250YWluZXJFbDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgc3VwZXIoY29udGFpbmVyRWwpO1xuICAgICAgICB0aGlzLm1vZGFscyA9IHt9O1xuICAgIH07XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQge1xuICAgIEFwcCxcbiAgICBFZGl0b3IsXG4gICAgRWRpdG9yUG9zaXRpb24sXG4gICAgRWRpdG9yU3VnZ2VzdCxcbiAgICBFZGl0b3JTdWdnZXN0Q29udGV4dCxcbiAgICBFZGl0b3JTdWdnZXN0VHJpZ2dlckluZm8sXG4gICAgTWFya2Rvd25WaWV3LFxuICAgIFRGaWxlLFxuICAgIHBhcnNlWWFtbCxcbiAgICBOb3RpY2Vcbn0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBjcmVhdGVGaWxlQ2xhc3MsIEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IHsgZ2VuZXJpY0ZpZWxkUmVnZXggfSBmcm9tIFwiLi4vdXRpbHMvcGFyc2VyXCI7XG5cbmludGVyZmFjZSBJVmFsdWVDb21wbGV0aW9uIHtcbiAgICB2YWx1ZTogc3RyaW5nO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmFsdWVTdWdnZXN0IGV4dGVuZHMgRWRpdG9yU3VnZ2VzdDxJVmFsdWVDb21wbGV0aW9uPiB7XG4gICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudTtcbiAgICBwcml2YXRlIGFwcDogQXBwO1xuICAgIHByaXZhdGUgZmlsZUNsYXNzOiBGaWxlQ2xhc3M7XG4gICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBkaWRTZWxlY3Q6IGJvb2xlYW4gPSBmYWxzZVxuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogTWV0YWRhdGFNZW51KSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5zZXRJbnN0cnVjdGlvbnMoW3sgY29tbWFuZDogXCJTaGlmdFwiLCBwdXJwb3NlOiBcInB1dCBhIHNwYWNlIGFmdGVyOjpcIiB9XSk7XG5cbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICB0aGlzLnNjb3BlLnJlZ2lzdGVyKFtcIlNoaWZ0XCJdLCBcIkVudGVyXCIsIChldnQ6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIHRoaXMuc3VnZ2VzdGlvbnMudXNlU2VsZWN0ZWRJdGVtKGV2dCk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBvblRyaWdnZXIoXG4gICAgICAgIGN1cnNvcjogRWRpdG9yUG9zaXRpb24sXG4gICAgICAgIGVkaXRvcjogRWRpdG9yLFxuICAgICAgICBmaWxlOiBURmlsZVxuICAgICk6IEVkaXRvclN1Z2dlc3RUcmlnZ2VySW5mbyB8IG51bGwge1xuICAgICAgICBpZiAodGhpcy5kaWRTZWxlY3QpIHtcbiAgICAgICAgICAgIHRoaXMuZGlkU2VsZWN0ID0gZmFsc2VcbiAgICAgICAgICAgIHJldHVybiBudWxsXG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5pc0F1dG9zdWdnZXN0RW5hYmxlZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICBjb25zdCBmcm9udG1hdHRlciA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKS5mcm9udG1hdHRlcjtcblxuICAgICAgICB0aGlzLmluRnJvbnRtYXR0ZXIgPSBmcm9udG1hdHRlciAhPT0gdW5kZWZpbmVkICYmIGZyb250bWF0dGVyLnBvc2l0aW9uLnN0YXJ0LmxpbmUgPCBjdXJzb3IubGluZSAmJiBjdXJzb3IubGluZSA8IGZyb250bWF0dGVyLnBvc2l0aW9uLmVuZC5saW5lXG4gICAgICAgIGNvbnN0IHJlZ2V4ID0gdGhpcy5pbkZyb250bWF0dGVyID8gbmV3IFJlZ0V4cChgXiR7Z2VuZXJpY0ZpZWxkUmVnZXh9Oig/PHZhbHVlcz4uKilgLCBcInVcIikgOiBuZXcgUmVnRXhwKGBeJHtnZW5lcmljRmllbGRSZWdleH06Oig/PHZhbHVlcz4uKilgLCBcInVcIilcbiAgICAgICAgY29uc3QgZnVsbExpbmUgPSBlZGl0b3IuZ2V0TGluZShlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZSlcbiAgICAgICAgaWYgKCFyZWdleC50ZXN0KGZ1bGxMaW5lKSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3RhcnQ6IGN1cnNvcixcbiAgICAgICAgICAgIGVuZDogY3Vyc29yLFxuICAgICAgICAgICAgcXVlcnk6IGVkaXRvci5nZXRMaW5lKGN1cnNvci5saW5lKSxcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBmaWx0ZXJPcHRpb24gPSAoZmlyc3RWYWx1ZXM6IHN0cmluZ1tdIHwgdW5kZWZpbmVkLCBsYXN0VmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZCwgb3B0aW9uOiBzdHJpbmcpOiBib29sZWFuID0+IHtcbiAgICAgICAgcmV0dXJuICFmaXJzdFZhbHVlcyB8fCAhZmlyc3RWYWx1ZXM/LmNvbnRhaW5zKG9wdGlvbikgJiYgKCFsYXN0VmFsdWUgfHwgISFsYXN0VmFsdWUgJiYgb3B0aW9uLmNvbnRhaW5zKGxhc3RWYWx1ZSkpXG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0U3VnZ2VzdGlvbnMoY29udGV4dDogRWRpdG9yU3VnZ2VzdENvbnRleHQpOiBQcm9taXNlPElWYWx1ZUNvbXBsZXRpb25bXT4ge1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9ucyA9IGF3YWl0IHRoaXMuZ2V0VmFsdWVTdWdnZXN0aW9ucyhjb250ZXh0KTtcbiAgICAgICAgaWYgKHN1Z2dlc3Rpb25zLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9O1xuXG4gICAgYXN5bmMgZ2V0VmFsdWVTdWdnZXN0aW9ucyhjb250ZXh0OiBFZGl0b3JTdWdnZXN0Q29udGV4dCk6IFByb21pc2U8SVZhbHVlQ29tcGxldGlvbltdPiB7XG4gICAgICAgIGNvbnN0IGxpbmUgPSBjb250ZXh0LnN0YXJ0LmxpbmU7XG4gICAgICAgIGxldCByZWdleDtcbiAgICAgICAgaWYgKCF0aGlzLmluRnJvbnRtYXR0ZXIpIHtcbiAgICAgICAgICAgIHJlZ2V4ID0gbmV3IFJlZ0V4cChgXiR7Z2VuZXJpY0ZpZWxkUmVnZXh9OjooPzx2YWx1ZXM+LispP2AsIFwidVwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlZ2V4ID0gbmV3IFJlZ0V4cChgXiR7Z2VuZXJpY0ZpZWxkUmVnZXh9Oig/PHZhbHVlcz4uKyk/YCwgXCJ1XCIpO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCByZWdleFJlc3VsdCA9IGNvbnRleHQuZWRpdG9yLmdldFJhbmdlKHsgbGluZTogbGluZSwgY2g6IDAgfSwgY29udGV4dC5lbmQpLm1hdGNoKHJlZ2V4KTtcblxuICAgICAgICBpZiAocmVnZXhSZXN1bHQgJiYgcmVnZXhSZXN1bHQuZ3JvdXBzPy5hdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkTmFtZSA9IHJlZ2V4UmVzdWx0Lmdyb3Vwcy5hdHRyaWJ1dGU7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZXNMaXN0ID0gcmVnZXhSZXN1bHQuZ3JvdXBzLnZhbHVlcz8ucmVwbGFjZSgvXlxcW3xeXFxzXFxbLywgJycpLnJlcGxhY2UoL1xcXSQvLCAnJykuc3BsaXQoXCIsXCIpLm1hcChvID0+IG8udHJpbSgpKVxuICAgICAgICAgICAgY29uc3QgbGFzdFZhbHVlID0gdmFsdWVzTGlzdD8ubGFzdCgpXG4gICAgICAgICAgICBjb25zdCBmaXJzdFZhbHVlcyA9IHZhbHVlc0xpc3Q/LnNsaWNlKDAsIC0xKVxuICAgICAgICAgICAgLy90YWdzIHNwZWNpZmljIGNhc1xuICAgICAgICAgICAgaWYgKGZpZWxkTmFtZSA9PT0gXCJ0YWdzXCIgJiYgdGhpcy5pbkZyb250bWF0dGVyKSB7XG4gICAgICAgICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0VGFncygpKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKHQgPT4gbGFzdFZhbHVlID8gdC5jb250YWlucyhsYXN0VmFsdWUpIDogdClcbiAgICAgICAgICAgICAgICAgICAgLnNvcnQoKVxuICAgICAgICAgICAgICAgICAgICAubWFwKHRhZyA9PiBPYmplY3QoeyB2YWx1ZTogdGFnLnJlcGxhY2UoL14jLywgXCJcIikgfSkpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL2lmIHRoaXMgbm90ZSBoYXMgYSBmaWxlQ2xhc3MsIGNoZWNrIGlmIGZpZWxkIHZhbHVlcyBhcmUgZGVmaW5lZCBpbiB0aGUgRmlsZUNsYXNzXG4gICAgICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldENhY2hlKGNvbnRleHQuZmlsZS5wYXRoKTtcbiAgICAgICAgICAgIGxldCB0cnlXaXRoUHJlc2V0RmllbGQgPSAhY2FjaGU/LmZyb250bWF0dGVyO1xuICAgICAgICAgICAgaWYgKGNhY2hlPy5mcm9udG1hdHRlcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgcG9zaXRpb24sIC4uLmF0dHJpYnV0ZXMgfSA9IGNhY2hlLmZyb250bWF0dGVyO1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0FsaWFzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXM7XG4gICAgICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmNvbnRhaW5zKGZpbGVDbGFzc0FsaWFzKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NWYWx1ZSA9IGF0dHJpYnV0ZXNbZmlsZUNsYXNzQWxpYXNdO1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gYXdhaXQgY3JlYXRlRmlsZUNsYXNzKHRoaXMucGx1Z2luLCBmaWxlQ2xhc3NWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzcyA9IGZpbGVDbGFzcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0F0dHJpYnV0ZXMgPSB0aGlzLmZpbGVDbGFzcy5hdHRyaWJ1dGVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGVDbGFzc0F0dHJpYnV0ZXMubWFwKGF0dHIgPT4gYXR0ci5uYW1lKS5jb250YWlucyhmaWVsZE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3B0aW9ucyA9IGZpbGVDbGFzc0F0dHJpYnV0ZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihhdHRyID0+IGF0dHIubmFtZSA9PSBmaWVsZE5hbWUpWzBdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vcHRpb25zXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIob3B0aW9uID0+IHRoaXMuZmlsdGVyT3B0aW9uKGZpcnN0VmFsdWVzLCBsYXN0VmFsdWUsIG9wdGlvbikpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChvcHRpb24gPT4gT2JqZWN0KHsgdmFsdWU6IG9wdGlvbiB9KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnlXaXRoUHJlc2V0RmllbGQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeVdpdGhQcmVzZXRGaWVsZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAodHJ5V2l0aFByZXNldEZpZWxkKSB7XG4gICAgICAgICAgICAgICAgLy9lbHNlIGNoZWNrIGlmIHRoZXJlIGFyZSBnbG9iYWwgcHJlc2V0IHZhbHVlc1xuICAgICAgICAgICAgICAgIGNvbnN0IHByZXNldEZpZWxkTWF0Y2ggPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcmVzZXRGaWVsZHMuZmlsdGVyKGZpZWxkID0+IGZpZWxkLm5hbWUgPT0gZmllbGROYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAocHJlc2V0RmllbGRNYXRjaC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXNldEZpZWxkID0gcHJlc2V0RmllbGRNYXRjaFswXTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAocHJlc2V0RmllbGQudmFsdWVzTGlzdE5vdGVQYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL292ZXJyaWRlIHByZXNldFZhbHVlcyBpZiB0aGVyZSBpcyBhIHZhbHVlc0xpc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlc0ZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHByZXNldEZpZWxkLnZhbHVlc0xpc3ROb3RlUGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVzRmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIHZhbHVlc0ZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlczogeyB2YWx1ZTogc3RyaW5nIH1bXSA9IGF3YWl0IChhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQucmVhZCh2YWx1ZXNGaWxlKSkuc3BsaXQoXCJcXG5cIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihvcHRpb24gPT4gdGhpcy5maWx0ZXJPcHRpb24oZmlyc3RWYWx1ZXMsIGxhc3RWYWx1ZSwgb3B0aW9uKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChfdmFsdWUgPT4gT2JqZWN0KHsgdmFsdWU6IF92YWx1ZSB9KSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVzID0gT2JqZWN0LmVudHJpZXMocHJlc2V0RmllbGRNYXRjaFswXS52YWx1ZXMpLm1hcChvcHRpb24gPT4gb3B0aW9uWzFdKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihvcHRpb24gPT4gdGhpcy5maWx0ZXJPcHRpb24oZmlyc3RWYWx1ZXMsIGxhc3RWYWx1ZSwgb3B0aW9uKSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlc1xuICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChfdmFsdWUgPT4gT2JqZWN0KHsgdmFsdWU6IF92YWx1ZSB9KSlcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH07XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKHN1Z2dlc3Rpb246IElWYWx1ZUNvbXBsZXRpb24sIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBlbC5zZXRUZXh0KHN1Z2dlc3Rpb24udmFsdWUpO1xuICAgIH07XG5cbiAgICBzZWxlY3RTdWdnZXN0aW9uKHN1Z2dlc3Rpb246IElWYWx1ZUNvbXBsZXRpb24sIGV2ZW50OiBLZXlib2FyZEV2ZW50IHwgTW91c2VFdmVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgaWYgKCFhY3RpdmVWaWV3KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IGFjdGl2ZVZpZXcuZWRpdG9yO1xuICAgICAgICBjb25zdCBhY3RpdmVMaW5lID0gZWRpdG9yLmdldExpbmUodGhpcy5jb250ZXh0IS5zdGFydC5saW5lKTtcblxuICAgICAgICBpZiAodGhpcy5pbkZyb250bWF0dGVyKSB7XG4gICAgICAgICAgICAvL2Zvcm1hdCBsaXN0IGlmIGluIGZyb250bWF0dGVyXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGxldCBwYXJzZWRGaWVsZDogUmVjb3JkPHN0cmluZywgc3RyaW5nIHwgc3RyaW5nW10gfCBudWxsPiA9IHBhcnNlWWFtbChhY3RpdmVMaW5lKVxuICAgICAgICAgICAgICAgIGxldCBbYXR0ciwgcGFzdFZhbHVlc10gPSBPYmplY3QuZW50cmllcyhwYXJzZWRGaWVsZClbMF1cbiAgICAgICAgICAgICAgICBsZXQgbmV3RmllbGQ6IHN0cmluZ1xuICAgICAgICAgICAgICAgIGlmICghcGFzdFZhbHVlcykge1xuICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZCA9IGF0dHIgKyBcIjogXCIgKyBzdWdnZXN0aW9uLnZhbHVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHBhc3RWYWx1ZXMgPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwYXN0VmFsdWVzLmNvbnRhaW5zKFwiLFwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RmllbGQgPSBhdHRyICsgXCI6IFwiICsgc3VnZ2VzdGlvbi52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0ZpZWxkID0gYXR0ciArIFwiOiBbXCIgKyBwYXN0VmFsdWVzLnNwbGl0KFwiLFwiKS5tYXAobyA9PiBvLnRyaW0oKSkuc2xpY2UoMCwgLTEpLmpvaW4oJywgJykgKyBcIiwgXCIgKyBzdWdnZXN0aW9uLnZhbHVlICsgXCJdXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkocGFzdFZhbHVlcykpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2ZUxpbmUuZW5kc1dpdGgoXCIsXVwiKSB8fCBhY3RpdmVMaW5lLmVuZHNXaXRoKFwiLCBdXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3ZhbHVlIGNhbiBiZSBkaXJlY3RseSBhZGRlZCBzaW5jZSBwYXJzZVlhbWwgd29udCBjcmVhdGUgYW4gZW1wdHkgbGFzdCBpdGVtIGluIHBhc3RWYWx1ZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0ZpZWxkID0gYXR0ciArIFwiOiBbXCIgKyBbLi4ucGFzdFZhbHVlcywgc3VnZ2VzdGlvbi52YWx1ZV0uam9pbihcIiwgXCIpICsgXCJdXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3dlIGhhdmUgdHlwZWQgc29tZXRoaW5nIHRoYXQgd2UgYWh2ZSB0byByZW1vdmUgdG8gcmVwbGFjZSB3aXRoIHNlbGVjdGVkIHZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZCA9IGF0dHIgKyBcIjogW1wiICsgWy4uLnBhc3RWYWx1ZXMuc2xpY2UoMCwgLTEpLCBzdWdnZXN0aW9uLnZhbHVlXS5qb2luKFwiLCBcIikgKyBcIl1cIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3RmllbGQgPSBhdHRyICsgXCI6IFtcIiArIFsuLi5wYXN0VmFsdWVzXS5qb2luKFwiLCBcIikgKyBcIl1cIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdGaWVsZCwgeyBsaW5lOiB0aGlzLmNvbnRleHQhLnN0YXJ0LmxpbmUsIGNoOiAwIH0sIHsgbGluZTogdGhpcy5jb250ZXh0IS5zdGFydC5saW5lLCBjaDogYWN0aXZlTGluZS5sZW5ndGggfSk7XG4gICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocGFzdFZhbHVlcykgfHwgdHlwZW9mIHBhc3RWYWx1ZXMgPT09ICdzdHJpbmcnICYmIHBhc3RWYWx1ZXMuY29udGFpbnMoXCIsXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5zZXRDdXJzb3IoeyBsaW5lOiB0aGlzLmNvbnRleHQhLnN0YXJ0LmxpbmUsIGNoOiBuZXdGaWVsZC5sZW5ndGggLSAxIH0pXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IHRoaXMuY29udGV4dCEuc3RhcnQubGluZSwgY2g6IG5ld0ZpZWxkLmxlbmd0aCB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShcIkZyb250bWF0dGVyIHdyb25nbHkgZm9ybWF0dGVkXCIsIDIwMDApXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvL2NsZWFuIGxpbmUgYnkgcmVtb3ZpbmcgZXZlcnl0aGluZyBhZnRlciAsIG9yIDo6XG4gICAgICAgICAgICBsZXQgY2xlYW5lZExpbmUgPSBhY3RpdmVMaW5lXG4gICAgICAgICAgICB3aGlsZSAoIVsnLCcsICc6J10uY29udGFpbnMoY2xlYW5lZExpbmUuY2hhckF0KGNsZWFuZWRMaW5lLmxlbmd0aCAtIDEpKSkge1xuICAgICAgICAgICAgICAgIGNsZWFuZWRMaW5lID0gY2xlYW5lZExpbmUuc2xpY2UoMCwgLTEpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKGAke2NsZWFuZWRMaW5lfSR7ZXZlbnQuc2hpZnRLZXkgPyBcIiBcIiA6IFwiXCJ9YCArIHN1Z2dlc3Rpb24udmFsdWUsXG4gICAgICAgICAgICAgICAgeyBsaW5lOiB0aGlzLmNvbnRleHQhLnN0YXJ0LmxpbmUsIGNoOiAwIH0sIHRoaXMuY29udGV4dCEuZW5kKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRpZFNlbGVjdCA9IHRydWVcbiAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgfTtcbn07Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSx3QkFBcUM7OztBQ0FyQyx1QkFBd0Y7OztBQ0F4Rix1QkFBbUg7OztBQ1VuSCxJQUFNLFFBQU4sTUFBWTtBQUFBLEVBRVIsWUFBWSxPQUFlLElBQ3ZCLFNBQWlDLENBQUMsR0FDbEMsS0FBYSxJQUNiLFVBQW1CLE9BQ25CLFVBQW1CLE9BQ25CLGFBQXFCLE9BQ3JCLHFCQUE2QixJQUFJO0FBQ2pDLFNBQUssT0FBTztBQUNaLFNBQUssU0FBUztBQUNkLFNBQUssS0FBSztBQUNWLFNBQUssWUFBWTtBQUNqQixTQUFLLFVBQVU7QUFDZixTQUFLLFVBQVU7QUFDZixTQUFLLHFCQUFxQjtBQUMxQixTQUFLLGVBQWUsS0FBSyxJQUFJO0FBQUEsRUFDakM7QUFBQSxFQUVBLEFBQWEsZUFBZSxPQUFnQztBQUFBO0FBQ3hELFVBQUksU0FBUztBQUNiLGFBQU8sS0FBSyxLQUFLLE1BQU0sRUFBRSxRQUFRLFNBQU87QUFDcEMsWUFBSSxTQUFTLEdBQUcsS0FBSyxTQUFTLEdBQUcsS0FBSyxRQUFRO0FBQzFDLG1CQUFTLFNBQVMsR0FBRyxJQUFJO0FBQUEsUUFDN0I7QUFBQztBQUFBLE1BQ0wsQ0FBQztBQUNELFdBQUssT0FBTyxPQUFPLFNBQVMsS0FBSztBQUNqQyxhQUFPLE9BQU8s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
